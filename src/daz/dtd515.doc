=IGN
********************************************************************************
dtd515.doc: this file is part of the PPDaz system

Copyright (c) 2002 Lemma 1 Ltd.

See the file LICENSE for your rights to use and change this file.

Contact: Rob Arthan < rda@lemma-one.com >
********************************************************************************
%  dtd515.doc %Z% $Date: 2002/10/17 15:46:52 $ $Revision: 1.14 $ $RCSfile: dtd515.doc,v $
=TEX
% TQtemplate.tex
\documentstyle[hol1,11pt,TQ]{article}
\ftlinepenalty=9999
\def\Hide#1{}
\def\Bool{``$\it{:}bool\,$''}
\makeindex
\TPPproject{DAZ PROJECT}  %% Mandatory field
%\TPPvolume{}
%\TPPpart{}
\TPPtitle{Detailed Design: Compliance Tool Test Utilities}  %% Mandatory field
\TPPref{ISS/HAT/DAZ/DTD515}  %% Mandatory field
\def\SCCSversion{$Revision: 1.14 $%
}
\TPPissue{\SCCSversion}  %% Mandatory field
\TPPdate{\FormatDate{$Date: 2002/10/17 15:46:52 $%
}}
%\TPPstatus{Approved}
\TPPstatus{Draft}
\TPPtype{Specification}
%\TPPkeywords{HOL}
\TPPauthor{D.J.~King&WIN01}
\TPPauthorisation{R.D.~Arthan & HAT Team}
\TPPabstract{
This document contains the detailed design for the Compliance Tool Test Utilities.}
%\TPPabstractB{}
%\TPPabstractC{}
%\TPPabstractD{}
%\TPPabstractE{}
%\TPPabstractF{}
\TPPdistribution{\parbox[t]{4.0in}{%
	A.~Smith, DRA \\
	Library}}

%\TPPclass{CLASSIFICATION}
%\def\TPPheadlhs{}
%\def\TPPheadcentre{}
%def\TPPheadrhs{}
%\def\TPPfootlhs{}
%\def\TPPfootcentre{}
%\def\TPPfootrhs{}

\begin{document}
\TPPsetsizes
\makeTPPfrontpage

\vfill
\begin{centering}

\bf Copyright \copyright\ : Lemma 1 Ltd. \number\year

\end{centering}

\newpage
\section{DOCUMENT CONTROL}
\subsection{Contents List}
\tableofcontents
\subsection{Document Cross References}
\bibliographystyle{fmu}
\bibliography{fmu,daz}

\subsection{Changes History}  % to get section number `0.3'
\begin{description}
\item[Issue 1.1-1.3] Initial Drafts.
\item[Issue 1.4] Added $trace\_envs$ to the signature $CNTestUtilities$.
\item[Issue 1.5] Minor typographical corrections.
\item[Issue 1.6] Changed environment printing routines to formatting routines.
\item[Issue 1.7-1.8] Various minor changes.
\item[Issue 1.9] Updated distribution list and removed superfluous section header.
\item[Issue 1.10] Update for SML'97.
\item[Issue 1.11] Removed local declarations for Poly/ML port.
\item[Issue 1.12] Updates for new abstract syntax (R0006 changes).
\item[Issue 1.13] Copyright and banner updates for open source release.
\item[Issue 1.14] DAZ-specific updates to banner for open source release
\item[Issue 1.15] DAZ-specific updates to banner for open source release
\end{description}
\subsection{Changes Forecast}
None.
\section{GENERAL}
\subsection{Scope}
This document contains the detailed design for test utilities for supporting module testing of the compliance tool. It is written in response to \cite{ISS/HAT/DAZ/HLD503}.

\subsection{Introduction}

\subsubsection{Purpose and Background}

It is recognised that module testing of parts of the compliance tool require a common set of functions. The functions described in this document aim to meet those requirements.

%\subsubsection{Dependencies}
%\subsubsection{Possible Enhancements}
\subsubsection{Deficiencies}
None known.

\section{THE SIGNATURE}
=DOC
signature ÛCNTestUtilitiesÝ = sig
=DESCRIBE
This structure holds the test utilities required for module-testing the compliance tool.
=ENDDOC
=SML
include (* CNTypes1 CNBasicDeclsAndExprs *) CNTypes1;
=TEX
\section{CREATING ABSTRACT SYNTAX FROM STRINGS}
=DOC
val Ûcn_of_stringÝ : string -> WEB_CLAUSE;
val Ûcn_decl_of_stringÝ : string -> DECLARATION;
val Ûcn_si_basic_decl_of_stringÝ : string -> SI_BASIC_DECL;
val Ûcn_exp_of_stringÝ : string -> EXP;
val Ûcn_statement_of_stringÝ : string -> STATEMENT;
val Ûcn_specinfo_of_stringÝ : string ->
	Z_ID list * ZUserInterfaceSupport.Z_TM * ZUserInterfaceSupport.Z_TM;
=DESCRIBE
Each of these functions take a string and convert it into a compliance notation abstract syntax. The part of abstract syntax generated can be determined from the name and the type of the function. The syntax of the string corresponds to the concrete syntax of compliance notation.

The function $cn\_specinfo\_of\_string$ expects a specification statement and yields the frame and the pre- and post-condition as the result in the form of un-typechecked Z.
=ENDDOC

\section{A TEST ENVIRONMENT}
=DOC
val Ûinit_envÝ : unit -> unit;
val ÛenvÝ : CN_ENV;
val Ûextend_envÝ : CNTypes.ID -> TYPE -> ENV_INFO -> unit;
val Ûchange_envÝ : ID -> ENV_INFO -> unit;
=DESCRIBE
$init\_env$ initialises a test environment. $env$ gives access to the environment. It is updated using the functions $extend\_env$ and $change\_env$. Examples of the use of these functions can be found in ISS/HAT/DAZ/MDT505.
=ENDDOC

\section{INTRODUCING NEW CONSTANTS/VARIABLES}
=DOC
val Ûcn_declareÝ : string -> unit;
=DESCRIBE
This function takes a string corresponding to the concrete syntax for declarations (including procedure, function and variable declarations) and updates both the test environment and the theory database accordingly. This allows the tester to make declarations of constants and variables which can then properly appear in compliance notation expressions.
=ENDDOC
\section{PRINTING VOLUME I ENVIRONMENTS}
=DOC
val Ûdiag_string_listÝ : string list -> unit;
val Ûfmt_pack_envÝ : PACK_ENV ->  string list;
val Ûfmt_subunit_envÝ : SUBUNIT_ENV -> string list;
val Ûfmt_dec_envÝ : DEC_ENV -> string list;
val Ûfmt_spec_envÝ : SPEC_ENV -> string list;
val Ûfmt_blocksÝ : ENV -> string list;
val Ûfmt_repl_envÝ : REPL_ENV -> string list;
val Ûprint_envsÝ : unit -> unit;
val Ûtrace_envsÝ : unit -> unit;
val Ûprint_z_generator_stateÝ : Z_GENERATOR_STATE -> unit;
=DESCRIBE
These functions format the environments used in generating the Z document (see ISS/HAT/DAZ/DTD507). $print\_envs$ prints the various environments of the current running environment.
=ENDDOC

\section{EPILOGUE}
=SML
end (* signature CNTestUtilities *);
=TEX
\section{TEST POLICY}
There is no module test for these test utilities. Correctness of implementation is achieved by their use during the development and testing of the compliance tool where they are themselves used. 

\small
\twocolumn[\section{INDEX}]
\printindex

\end{document}



