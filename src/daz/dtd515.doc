%  dtd515.doc %Z% $Date$ $Revision$ $RCSfile$
=TEX
% TQtemplate.tex
\documentstyle[hol1,11pt,TQ]{article}
\ftlinepenalty=9999
\def\Hide#1{}
\def\Bool{``$\it{:}bool\,$''}
\makeindex
\TPPproject{DAZ PROJECT}  %% Mandatory field
%\TPPvolume{}
%\TPPpart{}
\TPPtitle{Detailed Design: Compliance Tool Test Utilities}  %% Mandatory field
\TPPref{ISS/HAT/DAZ/DTD515}  %% Mandatory field
\def\SCCSversion{$Revision$%
}
\TPPissue{\SCCSversion}  %% Mandatory field
\TPPdate{\FormatDate{$Date$%
}}
%\TPPstatus{Approved}
\TPPstatus{Draft}
\TPPtype{Specification}
%\TPPkeywords{HOL}
\TPPauthor{D.J.~King&WIN01}
\TPPauthorisation{R.D.~Arthan & HAT Team}
\TPPabstract{
This document contains the detailed design for the Compliance Tool Test Utilities.}
%\TPPabstractB{}
%\TPPabstractC{}
%\TPPabstractD{}
%\TPPabstractE{}
%\TPPabstractF{}
\TPPdistribution{\parbox[t]{4.0in}{%
	Library}}

%\TPPclass{CLASSIFICATION}
%\def\TPPheadlhs{}
%\def\TPPheadcentre{}
%def\TPPheadrhs{}
%\def\TPPfootlhs{}
%\def\TPPfootcentre{}
%\def\TPPfootrhs{}

\begin{document}
\TPPsetsizes
\makeTPPfrontpage

\vfill
\begin{centering}

\bf Copyright \copyright\ : International Computers Ltd \number\year

\end{centering}

\newpage
\section{DOCUMENT CONTROL}
\subsection{Contents List}
\tableofcontents
\subsection{Document Cross References}
\bibliographystyle{fmu}
\bibliography{fmu,daz}

\subsection{Changes History}  % to get section number `0.3'
\begin{description}
\item[Issue 1.1-1.3] Initial Drafts.
\item[Issue 1.4] Added $trace\_envs$ to the signature $CNTestUtilities$.
\item[Issue 1.5] Minor typographical corrections.

\end{description}
\subsection{Changes Forecast}
None.
\section{GENERAL}
\subsection{Scope}
This document contains the detailed design for test utilities for supporting module testing of the compliance tool. It is written in response to \cite{ISS/HAT/DAZ/HLD503}.

\subsection{Introduction}

\subsubsection{Purpose and Background}

It is recognised that module testing of parts of the compliance tool require a common set of functions. The functions described in this document aim to meet those requirements.

%\subsubsection{Dependencies}
%\subsubsection{Possible Enhancements}
\subsubsection{Deficiencies}
None known.

\section{DESIGN ISSUES}


\section{THE SIGNATURE}
=DOC
signature ÛCNTestUtilitiesÝ = sig
=DESCRIBE
This structure holds the test utilities required for module-testing the compliance tool.
=ENDDOC

\section{CREATING ABSTRACT SYNTAX FROM STRINGS}
=DOC
val Ûcn_of_stringÝ : string -> CNTypes.WEB_CLAUSE;
val Ûcn_decl_of_stringÝ : string -> CNTypes.DECLARATION;
val Ûcn_basic_decl_of_stringÝ : string -> CNTypes.BASIC_DECL;
val Ûcn_exp_of_stringÝ : string -> CNTypes.EXP;
val Ûcn_statement_of_stringÝ : string -> CNTypes.STATEMENT;
val Ûcn_specinfo_of_stringÝ : string -> CNTypes.Z_ID list *
	ZUserInterfaceSupport.Z_TM * ZUserInterfaceSupport.Z_TM;
=DESCRIBE
Each of these functions take a string and convert it into a compliance notation abstract syntax. The part of abstract syntax generated can be determined from the name and the type of the function. The syntax of the string corresponds to the concrete syntax of compliance notation.

The function $cn\_specinfo\_of\_string$ expects a specification statement and yields the frame and the pre- and post-condition as the result in the form of un-typechecked Z.
=ENDDOC

\section{A TEST ENVIRONMENT}
=DOC
val Ûinit_envÝ : unit -> unit;
val ÛenvÝ : CNBasicDeclsAndExprs.CN_ENV;
val Ûextend_envÝ :
    CNTypes.ID -> TYPE -> CNBasicDeclsAndExprs.ENV_INFO -> unit;
val Ûchange_envÝ : CNTypes.ID -> CNBasicDeclsAndExprs.ENV_INFO -> unit;
=DESCRIBE
$init\_env$ initialises a test environment. $env$ gives access to the environment. It is updated using the functions $extend\_env$ and $change\_env$. Examples of the use of these functions can be found in ISS/HAT/DAZ/MDT505.
=ENDDOC

\section{INTRODUCING NEW CONSTANTS/VARIABLES}
=DOC
val Ûcn_declareÝ : string -> unit;
=DESCRIBE
This function takes a string corresponding to the concrete syntax for declarations (including procedure, function and variable declarations) and updates both the test environment and the theory database accordingly. This allows the tester to make declarations of constants and variables which can then properly appear in compliance notation expressions.
=ENDDOC
\section{PRINTING VOLUME I ENVIRONMENTS}
=DOC
val Ûprint_pack_envÝ : CNZGenerator.PACK_ENV ->  unit;
val Ûprint_subunit_envÝ : CNZGenerator.SUBUNIT_ENV -> unit;
val Ûprint_dec_envÝ : CNZGenerator.DEC_ENV -> unit;
val Ûprint_spec_envÝ : CNZGenerator.SPEC_ENV -> unit;
val Ûprint_blocksÝ : CNZGenerator.ENV -> unit;
val Ûprint_repl_envÝ : CNZGenerator.REPL_ENV -> unit;
val Ûprint_envsÝ : unit -> unit;
val Ûtrace_envsÝ : unit -> unit;
=DESCRIBE
These functions format the environments used in generating the Z document (see ISS/HAT/DAZ/DTD507). $print\_envs$ prints the various environments of the current running environment.
=ENDDOC

\section{EPILOGUE}
=SML
end; (* signature CNTestUtilities *)
=TEX
\section{TEST POLICY}
There is no module test for these test utilities. Correctness of implementation is achieved by their use during the development and testing of the compliance tool where they are themselves used. 

\small
\twocolumn[\section{INDEX}]
\printindex

\end{document}



