%  dtd509.doc %Z% $Date$ $Revision$ $RCSfile$
=TEX
% TQtemplate.tex
\documentstyle[hol1,11pt,TQ]{article}
\ftlinepenalty=9999
\def\Hide#1{}
\def\Bool{``$\it{:}bool\,$''}
\makeindex
\TPPproject{DAZ PROJECT}  %% Mandatory field
%\TPPvolume{}
%\TPPpart{}
\TPPtitle{Detailed Design: Z Toolkit Extensions}  %% Mandatory field
\TPPref{ISS/HAT/DAZ/DTD509}  %% Mandatory field
\def\SCCSversion{$Revision$%
}
\TPPissue{\SCCSversion}  %% Mandatory field
\TPPdate{\FormatDate{$Date$%
}}
%\TPPstatus{Approved}
\TPPstatus{Draft}
\TPPtype{Specification}
%\TPPkeywords{SPARK}
\TPPauthor{D.J.~King&WIN01}
\TPPauthorisation{R.D.~Arthan & DAZ Team}
\TPPabstract{
This document contains the toolkit extension required for the DAZ Compliance Tool.}
%\TPPabstractB{}
%\TPPabstractC{}
%\TPPabstractD{}
%\TPPabstractE{}
%\TPPabstractF{}
\TPPdistribution{\parbox[t]{4.0in}{%
	C.~O'Halloran, DRA \\
	Library}}
%\TPPclass{CLASSIFICATION}
%\def\TPPheadlhs{}
%\def\TPPheadcentre{}
%def\TPPheadrhs{}
\newfont{\icllogo}{icllogo50}
\def\TPPheadlhs{$\vcenter{\halign{##\cr\icllogo ICL\cr}}$}
%\def\TPPfootlhs{}
%\def\TPPfootcentre{}
%\def\TPPfootrhs{}

\begin{document}
\TPPsetsizes
\makeTPPfrontpage

\vfill
\begin{centering}

\bf Copyright \copyright\ : International Computers Ltd \number\year

\end{centering}

\newpage
\section{DOCUMENT CONTROL}
\subsection{Contents List}
\tableofcontents
\subsection{Document Cross References}
\bibliographystyle{fmu}
\bibliography{daz,fmu}

\subsection{Changes History}  % to get section number `0.3'
\begin{description}
\item[Issue 1.1-1.6] Initial Drafts.
\item[Issue 1.7] Carried out rework according to desk check report 011.

\end{description}
\subsection{Changes Forecast}
None.
\section{GENERAL}
\subsection{Scope}
This document responds to a requirement for a design of toolkit extensions in Z in \cite{ISS/HAT/DAZ/HLD503}. The specification of the toolkit extensions is provided in \cite{DRA/CIS/CSE3/SWI/WP/6/2}.

\subsection{Introduction}

\subsubsection{Purpose and Background}

This document implements the Z toolkit extensions required for the Compliance Tool and specified in \cite{DRA/CIS/CSE3/SWI/WP/6/2}.


\subsection{Compliance}

The function $abs$ specified in \cite{DRA/CIS/CSE3/SWI/WP/6/2} is implemented here by the function $Abs$. This is because $abs$ is a name already in use in {\Product-Z}.

The Z name for an attribute in \cite{DRA/CIS/CSE3/SWI/WP/6/2} is denoted by a pair of underscore characters. {\Product-Z}'s lexical rules does not permit this. A lowercase ``v'' is used to denote an attribute instead.

\subsubsection{Dependencies}
None.
%\subsubsection{Possible Enhancements}

\section{DESIGN ISSUES}

The theory created by this document is called ``cn''. When the compliance tool is invoked, the current theory should be ``cn''.

\section{PREAMBLE}

The following preamble creates the theory ``cn'' as a descendant of ``z\_library''.

=SMLZ
open_theory"z_library";
push_pc "z_library";
delete_theory"cn" handle Fail _ => ();
val _ = set_flag ("z_type_check_only", false);
val _ = set_flag ("z_use_axioms", true);
new_theory"cn";
=TEX

\section {DEFINITION OF FIXITY}

The following fixity definitions are required by {\Product} and determine the lexicographic fixity of the functions defined by the toolkit extensions.

¹Z
fun  not _
°

¹Z
fun 0 _ and _, _ or _, _ xor _
°
¹Z
fun 1 _ mem _, _ notmem _, _ eq _, _ noteq _
°

¹Z
fun 2 _ less _, _ less_eq _, _ greater _, _ greater_eq _
°

¹Z
fun 4 _ intdiv _, _ rem _
°

¹Z
fun 5 _ ** _
°

¹Z
fun  Abs _
°

=TEX

\section{TOOLKIT EXTENSIONS}

\subsection{Booleans}

¹Z
ÛFALSEİ ¦ 0
°

¹Z
ÛTRUEİ ¦ 1
°

¹Z
ÛBOOLEANİ ¦ FALSE..TRUE
°

¹Z
ÛBOOLEANvFIRSTİ ¦ FALSE
°

¹Z
ÛBOOLEANvLASTİ ¦ TRUE
°

¹Z
ÛBOOLEANvSUCCİ ¦ (BOOLEAN \ {BOOLEANvLAST}) ò succ
°

¹Z
ÛBOOLEANvPREDİ ¦ BOOLEANvSUCCç~ê
°

¹Z
ÛBOOLEANvPOSİ ¦ id BOOLEAN
°

¹Z
ÛBOOLEANvVALİ ¦ BOOLEANvPOSç~ê
°

\subsection{Boolean Operators}

¹ZAX
Ü Ûnotİ _ : BOOLEAN ­ BOOLEAN;
Ü _ Ûandİ _, _ Ûorİ _, _ Ûxorİ _ : (BOOLEAN ¸ BOOLEAN) ­ BOOLEAN
÷üüüüüüüüüüüüüüüüüüüüü
Ü µ b : BOOLEAN ·
Ü	not FALSE = TRUE ± not TRUE = FALSE ±
Ü	(b and FALSE = FALSE ± b and TRUE = b) ±
Ü	(b or FALSE = b ± b or TRUE = TRUE) ±
Ü	(b xor FALSE = b ± b xor TRUE = not b)
°



\subsection{Relational Operators returning Booleans}

[X]œœœœœœœœœœœœœœœœ
Ü _ Ûmemİ _, _ Ûnotmemİ _ : (X ¸ ğ X) ­ BOOLEAN;
Ü _ Ûeqİ _, _ Ûnoteqİ _ : (X ¸ X) ­ BOOLEAN
÷üüüüüüüüüüüüüüüüüü
Ü µ x, y : X; S : ğ X; b : BOOLEAN ·
Ü	(b = x mem S ¤ (b = TRUE ¤ x  S)) ±
Ü	(b = x notmem S ¤ (b = TRUE ¤ x  S)) ±
Ü	(b = x eq y ¤ (b = TRUE ¤ x = y)) ±
Ü	(b = x noteq y ¤ (b = TRUE ¤ x ½ y))
ˆüüüüüüüüüüüüüüüüüüüü


¹ZAX
Ü _ Ûlessİ _, _ Ûless_eqİ _, _ Ûgreaterİ _,
Ü _ Ûgreater_eqİ _ : (ú ¸ ú) ­ BOOLEAN
÷üüüüüüüüüüüüüüüüüüüüü
Ü µ x, y : ú; b : BOOLEAN ·
Ü	(b = x less y ¤ (b = TRUE ¤ x < y)) ±
Ü	(b = x less_eq y ¤ (b = TRUE ¤ x ¼ y)) ±
Ü	(b = x greater y ¤ (b = TRUE ¤ x > y)) ±
Ü	(b = x greater_eq y ¤ (b = TRUE ¤ x ¾ y))
°

\subsection{Numeric Operators}

¹ZAX
Ü _ Ûintdivİ _, _ Ûremİ _ : (ú ¸ ú \ {0}) ­ ú
÷üüüüüüüüüüüüüüüüüüüüü
Ü µ x, y : ú | y ½ 0 ·
Ü	(x * y ¾ 0 ² x mod y = 0 ´ x intdiv y = x div y) ±
Ü	(x * y < 0 ± x mod y ½ 0 ´ x intdiv y = x div y + 1) ±
Ü	x intdiv y * y + x rem y = x
°

¹ZAX
Ü _ Û**İ _ : (ú ¸ î) ­ ú
÷üüüüüüüüüüüüüüüüüüüüü
Ü µ x : ú; y : î · x ** 0 = 1 ± x ** (y + 1) = x * x ** y
°

¹ZAX
Ü ÛAbsİ _ : ú ­ î
÷üüüüüüüüüüüüüüüüüüüüü
Ü µ x : ú · x ¾ 0 ´ Abs x = x ± x < 0 ´ Abs x = ~x
°

\subsection{Integers}

¹ZAX
Ü ÛINTEGERİ : ğ ú
°
¹ZAX
Ü ÛINTEGERvFIRSTİ, ÛINTEGERvLASTİ : ú
°

¹ZAX
Ü ÛINTEGERvSUCCİ, ÛINTEGERvPREDİ, ÛINTEGERvPOSİ,
Ü ÛINTEGERvVALİ : ú ß ú
°

\section{HANDLING INFORMALITY}

The relation $Informal$ permits a message indicating that a web clause could only be handled informally to appear in the Z document.

¹Z
rel	DummyVC _
°

¹ZAX
Ü	ÛDummyVCİ _ : ğ (seq CHAR)
°

\section{START OF STRUCTURE}

=DOC
signature ÛCNToolkitExtensionsİ = sig
=DESCRIBE
This is the signature for the toolkit extensions required by the Compliance Tool. It is specified in DRA/CIS/CSE3/SWI/WP/6/2.
=ENDDOC
=THDOC
req_name Û"cn"İ (Value "z_library");
req_language "Z";
set_flag("tc_thms_only",true);
=DESCRIBE
The theory $cn$ contains definitions specified in DRA/CIS/CSE3/SWI/WP/6/2.
It is created in structure $CNToolkitExtensions$.
The specification of the theory name, and the language of the theory is defined using $req\_name$ and $req\_language$. This conforms to the technique used in the rest of the {\Product} design documentation for specifying the requirement for theories.
=ENDDOC

\section{EPILOGUE}
=SML
end (* end of signature CNToolkitExtensions *);
=TEX
=SML
reset_flag ("z_type_check_only");
reset_flag ("z_use_axioms");
=TEX


=TEX
\section{TEST POLICY}

The toolkit extensions are all contained in a theory called ``cn''. There are no appropriate module tests for the extensions. The presence of all the definitions in the toolkit will be tested by the module tests for the VC generator and the system integration tests.

\small
\twocolumn[\section{INDEX}]
\printindex

\end{document}



