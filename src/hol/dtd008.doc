=TEX
\documentstyle[hol,11pt,TQ]{article}
\ftlinepenalty=9999
\makeindex
\TPPproject{FST PROJECT}  %% Mandatory field
\TPPtitle{Release 1 ICL HOL: Detailed Design for Nets}  %% Mandatory field
\def\TPPheadtitle{Release 1 ICL HOL \cr Detailed Design for Nets}
\TPPref{DS/FMU/IED/DTD008}  %% Mandatory field
\def\SCCSversion{$Revision$
}
\TPPissue{\SCCSversion}  %% Mandatory field
\TPPdate{\FormatDate{$Date$ %
}}  %% Mandatory field
\TPPstatus{Draft}			%% Mandatory field
\TPPtype{SML Literate Script}
\TPPkeywords{}
\TPPauthor{K.~Blackburn & WIN01}  %% Mandatory field
%\TPPauthors{Name 1&location 1\\Name 2&location 2\\Name 3&location 3}
\TPPauthorisation{R.D.Arthan & FST Team Leader}
\TPPabstract{This document gives a detailed design for the net tools in ICL HOL.
These allow the rapid selection of a subset of values, based
on a term's form.}
\TPPdistribution{\parbox[t]{4.0in}{%
	    Project Library
}}
%\TPPclass{CLASSIFICATION}
%\def\TPPheadlhs{}
%\def\TPPheadcentre{}
%def\TPPheadrhs{}
%\def\TPPfootlhs{}
%\def\TPPfootcentre{}
%\def\TPPfootrhs{}
\begin{document}
\makeTPPfrontpage
\vfill
\begin{centering}
\bf Copyright \copyright\ : International Computers Ltd \number\year
\end{centering}
\pagebreak
\section{Document control}
\subsection{Contents list}
\tableofcontents
\subsection{Document cross references}
\bibliographystyle{fmu}
\bibliography{fmu}

\subsection{Changes history}
\begin{description}
\item [Issue 1.1]
First version.
\end{description}
\subsection{Changes forecast}
None.
\section{GENERAL}
\subsection{Scope}
This document contains a detailed design for the 
net tools.
These will support the implementation of the rewriting tools.
This is called for in section ??? of ???.
The high-level specification for the code is
given in ???.
The design is
implemented in \cite{DS/FMU/IED/IMP008}.
\subsection{Introduction}
\subsubsection{Purpose and Background}
This document contains a detailed design for the 
net tools in Release 001 of ICL HOL.
These tools are concerned with the rapid choice of 
a subset of a set of values based on a term's structure.
They will be used in implementing efficient rewriting utilities,
by selecting various rewriting conversions, based on
the term to which the conversion will be applied.
They will also be applicable anywhere else we want an efficient choice of values based on term forms.

The tools have been derived from the
Cambridge HOL code by reverse engineering. The reference
given there for the algorithm is the book `Artificial Intelligence
Programming' by Charniak, Riesbeck and McDermott.

\subsubsection{Dependencies}
Loading this document is dependent on those
files indicated as preceding it in the ICL HOL release 001 makefile.

\subsubsection{Deficiencies}

\subsubsection{Possible Enhancements}
\section{THE NET TOOLS}
=DOC
signature âNetToolsá = sig
=DESCRIBE
This provides the net tools that will be used to maintain and use
a database of values indexed by term form.
=FAILURE
8001	DESIGN_ERROR : get_edge given invalid net
8002	DESIGN_ERROR : update given invalid net
=FAILUREC
These design error messages are for functions not visible in this
document, and will be given the ``area'' $NetTools$.
=ENDDOC
=DOC
type 'a âNETá;
=DESCRIBE
This is the type of a net, its type parameter being the type of values
that are handled by the net.
=ENDDOC
=DOC
val âemptyá : 'a NET;
=DESCRIBE
This is the starting net, that returns an empty list of values,
regardless of term form.
=ENDDOC
=DOC
val âenterá : (TERM * 'a) -> ('a NET) -> ('a NET);
=DESCRIBE
This enters a value and its indexing term into a net, returning the
resulting net.
=ENDDOC
=DOC
val âlookupá : ('a NET) -> TERM -> ('a list);
=DESCRIBE
$lookup$ $net$ $term$ will return a list of {\bf at least} all the values entered into $net$, 
that were indexed by terms that can be term matched 
(by $term\_match$, q.v.) to $term$.
I.e. $term$ can be produced by type and term variable instantiation
from the indexing term.

The initial purpose of $lookup$ is to make the process of
rewriting a term using a list of equations more efficient
by quickly filtering out equations which are not applicable.
Consequently speed is more important than accuracy:
to use the wrong metaphor,
it is not important if some inapplicable equations
``slip through the net'' provided all the applicable
ones do as well.

The net actually returns all values whose indexing terms have the same
structure as the term matched, ignoring types and variables. Thus only the pattern
of constant names, combinations and abstractions will be considered, with variables in the indexing term being presumed to match any term form, regardless of type.
Thus it is a loose selection procedure, though quick to check.

If $lookup$ returns more than one value, then the only
ordering on the resulting values we specify is that if two entries are made into the net with the same index term, then if the $lookup$ term matches the index term then the second entered value will be returned before the first in the list of matches.
=ENDDOC
\section{END OF THE SIGNATURE}
=SML
end; (* signature of NetTools *)
=TEX
\section{TEST POLICY}
The functions in this document should be tested as described in
\cite{DS/FMU/IED/PLN008}.

=TEX
\twocolumn[\section{INDEX}]
\small
\printindex
\end{document}
