=TEX
% TQtemplate.tex
\documentstyle[hol,11pt,TQ]{article}
\ftlinepenalty=9999
\def\Hide#1{}
\def\Bool{``$\it{:}bool\,$''}
\makeindex
\TPPproject{FST PROJECT}  %% Mandatory field
%\TPPvolume{}
%\TPPpart{}
\TPPtitle{Detailed Design for Theory Lister}  %% Mandatory field
\TPPref{DS/FMU/IED/DTD033}  %% Mandatory field
\def\SCCSversion{$Revision$%
}
\TPPissue{\SCCSversion}  %% Mandatory field
%\TPPdate{}  %% Mandatory field (with sensible default)
\TPPstatus{Draft}			%% Mandatory field
\TPPtype{Specification}
\TPPkeywords{HOL}
\TPPauthor{R.D.~Arthan & WIN01}  %% Mandatory field
%\TPPauthors{Name 1&location 1\\Name 2&location 2\\Name 3&location 3}
\TPPauthorisation{R.D.~Arthan & FST Team Leader}
\TPPabstract{
This document contains the detailed design for the
theory lister module for ICL HOL.}
%\TPPabstractB{}
%\TPPabstractC{}
%\TPPabstractD{}
%\TPPabstractE{}
%\TPPabstractF{}
\TPPdistribution{\parbox[t]{4.0in}{%
	Library}}

%\TPPclass{CLASSIFICATION}
%\def\TPPheadlhs{}
%\def\TPPheadcentre{}
%def\TPPheadrhs{}
%\def\TPPfootlhs{}
%\def\TPPfootcentre{}
%\def\TPPfootrhs{}

\begin{document}
\TPPsetsizes
\makeTPPfrontpage

\vfill
\begin{centering}

\bf Copyright \copyright\ : International Computers Ltd \number\year

\end{centering}

\newpage
\section{DOCUMENT CONTROL}
\subsection{Contents list}
\tableofcontents
\subsection{Document cross references}
\bibliographystyle{fmu}
\bibliography{fmu}

\subsection{Changes history}  % to get section number `0.3'
\begin{description}
\item [Issue \SCCSversion (\FormatDate{$Date$%
})] First draft for comment.
\end{description}
\subsection{Changes forecast}
\pagebreak
\section{GENERAL}
\subsection{Scope}
This document contains the detailed design for the theory lister module for ICL HOL.
The high level design for this material is given in \cite{DS/FMU/IED/HLD008}.

\subsection{Introduction}
\subsubsection{Purpose and Background}
As identified in the high-level design document,
\cite{DS/FMU/IED/HLD008}, the user of the HOL system needs a means of listing out in a
readable format the contents of a theory and also means for cross
referencing definitions of objects against there uses in one or more
theories. It is the purpose of this document to meet these requirements.
\subsubsection{Dependencies}
This document is dependent on the pretty printer functions for HOL
defined in \cite{DS/FMU/IED/DTD033}.
\subsubsection{Possible Enhancements}
The theory lister is currently defined not to list out theory status, or anything
to do with theorem level numbers --- since the functional
interfaces of \cite{DS/FMU/IED/DTD012} allow this information to be
extracted when necessary and most users will not wish to see it as a matter
of course. This information could be optionally included under the control
of a system flag.
\subsubsection{Deficiencies}
\section{DISCUSSION}
\subsection{Theory Lister}
\subsubsection{Information to be Listed}
As described in \cite{DS/FMU/IED/DTD006} and \cite{DS/FMU/IED/DTD012},
an ICL HOL theory acts as a container for information of two sorts:
protected logical information and user-defined data. Withing
the ICL HOL system itself, the principal use of the user-defined
data is by the symbol table module, see \cite{DS/FMU/IED/DTD020},
which uses it to implement the various syntactic devices supported
by the ICL HOL concrete syntax. It is the purpose of the theory
lister to enable the user to see a readable representation of
the logical information and of the information managed by
the symbol table module.

It may be seen from \cite{DS/FMU/IED/DTD006} that the logical information
may be collected together under the various sorts of object which
are stored as follows:

\begin{tabular}{|l|p{3in}|}\hline
Object & Information to be listed \\ \hline
Parent & the name \\\hline
Child & the name \\\hline
Type Constructor & arity of the constructor\\\hline
Constant & type of the constant \\\hline
Definition & the defining theorem (as a sequent) \\\hline
Axiom & the axiom (as a sequent)\\\hline
Theorem & the theorem as a sequent \\\hline
\end{tabular}

From \cite{DS/FMU/IED/DTD020}, one sees that the symbol table information
is to cover the following sorts of object:

\begin{tabular}{|l|p{3in}|}\hline
Object & Information to be listed \\\hline
\begin{tabular}{l}
Binder \\\hline
Infix \\\hline
Nonfix \\\hline
Postfix \\\hline
Postfix \\\hline
Prefix \\\hline
\end{tabular}
	& the fact that the name is declared as such \\\hline
Type Abbreviation & the formal parameters and the type abbreviated \\\hline
Alias & the list of string-type pairs corresponding to the constants for which
the name is an alias \\\hline
\end{tabular}

In addition, we should list the language of the theory (at least if it is
not HOL).
\subsection{Listing Format}
Experience with earlier HOL systems suggests that use of a tabular layout
for things such as the listing of constants and their types would ease
readibility

A decision to be made with regard to the listing format is whether to list syntactic
status separately or to attempt to include it elsewhere. For example, we might
decorate a constant name in the list of constants and their types with 
underscores (and, for binders a `Ž') indicating where the operands of the
constant go (after the style of Z). Unfortunately we would still need a separate
listing for the names with special status which are not defined as types,
constants etc. Given this consideration a separate listing of the names
with special status would seem appropriate.

The easiest way to describe
the listing format is to have an example in view, such as the following
which contains a bit of everything:

\pagebreak
ó
+++ The Theory "lots" +++

+++ Parents +++

		More		Other		Again		Dull

+++ Children +++

		Fred		Jim		Jill		Jack
		John

+++ Constants +++

$+_real:	real ‹ real ‹ real
$-_real:	real ‹ real ‹ real
$*_real:	real ‹ real ‹ real
$/_real:	real ‹ real ‹ real

+++ Aliases +++

$+		$+_real : real ‹ real ‹ real
$-		$-_real : real ‹ real ‹ real
$*		$*_real : real ‹ real ‹ real
$/		$/_real : real ‹ real ‹ real

+++ Types +++

:†
:real
:('a)isos
:'a  'b

+++ Type Abbreviations +++

('a)auto	'a ‹ 'a
('a, 'b)dis_union
		'a + 'b
('a)seq		† ‹ 'a
real_seq	† ‹ real

+++ Fixity Declarations +++

Binder:		RiemannIntegral
			CauchyIntegral
Infix 100:	
Infix 200:	+		-
Infix 300:	*		/
Nonfix: 		,
Postfix 500:	!
Prefix 400:	~

+++ Terminator Declarations +++

		+		*		-		/

+++ Axioms +++

nasty_axiom1	… A horrid pack of lies

+++ Definitions +++

real		… The definition of the type of reals
+
-		… ƒ x y:realŽ A long and complicated definition of real addition
		and subtraction spreading over several lines
		containing perhaps ($+) ($-)
*		… ƒ x y:realŽ A short definition of real multiplication
/		… ƒ x y:realŽ A short definition of real division

+++ Theorems +++

+_comm_thm	… ƒ x y:realŽ x + y = y + x
+_*_distributive_thm
		… ƒ x y:realŽ a *(x + y) = a * x + a * y
long_and_boring_thm
		… A very long and uninteresting theorem with large numbers of
		horrors in it and spreading over, er?, well let's see, ah! yes!
		all of three lines.
asm_thm	This,
		Theorem has,
		Assumptions,
		Some of them being quite long so they wont't fit on one line
		… But its conclusion is quite short.

+++ End of listing of theory lots +++
æ
\pagebreak

Here 16 column fields
are being allowed for names. If a name would fill or overflow its slot
a new line is output after the name followed by an appropriate number of tabs
(to line up with the start of the field containing the list the name
is part of, or to line up with the information associated with the name if
the name is acting as a key).

Note that with a proportionately spaced font it is necessary to use tabs
rather than spaces. Moreover, the lister should, in principle, know
how wide each character is in order to compute how many tabs to use.

Each part of the above format which contains a list which happens
to be empty will be omitted.
 
The following message definitions are used to achieve the above format:

=FAILURE
33001	+++ The Theory "?0" +++
33002	+++ Parents +++
33003	+++ Children +++
33004	+++ Aliases +++
33005	+++ Types +++
33006	+++ Type Abbreviations +++
33007	+++ Fixity Declarations +++
33008	+++ Terminator Declarations +++
33009	+++ Axioms +++
33010	+++ Definitions +++
33011	+++ Thoerems +++
33020	Binder:
33021	Infix ?0:
33022	Nonfix:
33023	Postfix ?0:
33024	Prefix ?0:
=TEX
\subsubsection{Interface with \TeX}
To interface the lister with \TeX, the lister must be able to operate in
a mode where it can insert \TeX\ macro calls to achieve the columnar layout
desired (because the aspect ratios of the screen fonts may not be
the same as the \TeX\ fonts). To achieve this a string control is set
up to contain the character string to be output by the lister at a tab stop
in this mode.

\subsection{Theory Cross-referencer}
\section{PROLOGUE}
=DOC
signature Lister = sig
=DESCRIBE
This is the signature of the structure $Lister$ which contains functions
for listing theories.
=ENDDOC
\section{THEORY LISTER}
=DOC
val âprint_theoryá : string -> unit
=DESCRIBE
$print\_theory\,thy$ causes a listing of the theory $thy$to be written to
the standard output. The listing is in a format suited for display on 
the screen
=SEEALSO
$output\_theory$
=ENDDOC

=DOC
val âoutput_theoryá : {theory:string, outfile:string} -> unit
=DESCRIBE
$print\_theory\{theory=thy, outfile=file\}$ causes a listing of the theory
$thy$ to be output to the file $file$. The listing is in a format suited
for printing using the ICL HOL document preparation system.
=SEEALSO
$print\_theory$
=FAILURE
33101	i/o failure on file ?0 (?1)
33102	the theory ?0 does not exist
=ENDDOC

\section{THEORY CROSS-REFERENCER}

\section{EPILOGUE}
=SML
end; (* of signature TheoryLister *)
=TEX
\section{TEST POLICY}
The symbol table functions are to be tested according to the
general criteria laid down in the quality plan, \cite{DS/FMU/IED/PLN008}.
\small
\twocolumn[\section{INDEX}]
\printindex

\end{document}
