=TEX
\documentstyle[hol,11pt,TQ]{article}
\ftlinepenalty=9999
\makeindex
\TPPproject{IED 1563}  %% Mandatory field
%\TPPvolume{}
%\TPPpart{}
\TPPtitle{Module Tests for Types and Terms}  %% Mandatory field
\def\TPPheadtitle{Module Tests for Types and Terms}
\TPPref{DS/FMU/IED/MDT003}  %% Mandatory field
\def\SCCSversion{$Revision$ %
}
\TPPissue{\SCCSversion}  %% Mandatory field
\TPPdate{\FormatDate{$Date$ %
}}
\TPPstatus{Draft}			%% Mandatory field
\TPPtype{ML Literate Script}
\TPPkeywords{}
\TPPauthor{K.Blackburn & WIN01}  %% Mandatory field
%\TPPauthors{Name 1&location 1\\Name 2&location 2\\Name 3&location 3}
\TPPauthorisation{R.D.Arthan & Project Manager}
\TPPabstract{A set of module tests are given for the 
the types of HOL terms and types, namely $TERM$ and $TYPE$,
and then upon some utility functions about these.}
\TPPdistribution{\parbox[t]{4.0in}{%
	    Library
}}
\begin{document}
\makeTPPfrontpage
\vfill
\begin{centering}
\bf Copyright \copyright\ : International Computers Ltd \number\year
\end{centering}
\pagebreak
\section{Document control}
\subsection{Contents list}
\tableofcontents
\subsection{Document cross references}
\bibliographystyle{fmu}
\bibliography{fmu}

\subsection{Changes history} 
\begin{description}
\item [Issue 1.1]
First draft version.
\item [Issue 1.2]
Modified in line with version 1.5 of \cite{DS/FMU/IED/DTD003}.
\item [Issue 1.3]
Modified in line with version 1.8 of \cite{DS/FMU/IED/DTD003}.
Made all tests give ``printable results'', apart from assignment statements.
\item [Issue 1.4]
Modified in line with version 1.9 of \cite{DS/FMU/IED/DTD003}.
\item [Issue 1.5]
Addition of functions :$?\_†$, $?\_char$ and $?\_string$;
and the types $†$, $CHAR$ and $STRING$.
 imp006.doc dtd003.doc 
\item [Issue 1.6]
An additional rtest for $aconv$.
\item [Issue 1.7]
Changed to using test harness of \cite{DS/FMU/IED/DTD013}.
\item [Issue 1.8]
Reacted to issue 1.12 of \cite{DS/FMU/IED/DTD003}.
\item [Issue 1.9]
Reacted to issue 1.13 of \cite{DS/FMU/IED/DTD003}.
\item [Issue 1.10]
Corrected $term\_fail$ and $type\_fail$ tests.
\item [Issue 1.11]
Added $inst\_type$ tests.
Reacted to issue 1.15 of \cite{DS/FMU/IED/DTD003}.
\end{description}
%\subsection{Changes forecast}
\section{GENERAL}
\subsection{Scope}
This document contains the module testing of the types and terms of ICL HOL, and utilities to handle them, required by Release 1 ICL HOL Product Requirement Specification \cite{DS/FMU/IED/DEF004}.
The design is in \cite{DS/FMU/IED/DTD003}
and it is
implemented in \cite{DS/FMU/IED/IMP003}.

\subsection{Introduction}
\subsubsection{Purpose and Background}
This document contains the module testing of the material given a design in \cite{DS/FMU/IED/DTD003},
following the test policy given in that document and the general policy given in \cite{DS/FMU/IED/PLN008}.

\subsubsection{Dependencies}
This document is derived from the detailed design in \cite{DS/FMU/IED/DTD003},
and is further influenced by the implementation, in  \cite{DS/FMU/IED/IMP003}.
\subsubsection{Deficiencies}
The coverage of the tests, as called for by the test specification, may currently be incomplete.

\section{TEST HARNESS MATERIAL}
=SML
usefile "dtd013.sml";
usefile "imp013.sml";
init_mt_results ();
=TEX
\section{INFIX DECLARATIONS}
=SML
infix 6 cross;
infix 6 comma;
=TEX
\section{TEST DATA}
This section contains data used in the test, that
in themselves are not part of the tests.
However, they may fail if the functions tested are ill-formed.
=SML
val I = Combinators.I;
fun (t1 :TYPE) cross (t2: TYPE) : TYPE = mk_type("‰",[t1,t2]);
val BN = BOOL cross †;
val BtoN = mk_fun(BOOL, †);
val tv1 = mk_vartype "'tv1";
val tv2 = mk_vartype "'tv2";
val tv3 = mk_vartype "'tv3";
fun t1 comma t2 = mk_const(",", (mk_fun(t1,mk_fun(t2,(t1 cross t2)))));
val Comma = tv1 comma tv2;
val vtv1 = mk_var("vtv1",tv1);
val vtv2 = mk_var("vtv2",tv2);
val vtv3 = mk_var("vtv3",tv3);
val v1 = mk_var("v1",BOOL);
val av1 = mk_var("av1",BOOL);
val v2 = mk_var("v2",mk_type("triple",[tv1,tv2,tv3]));
val v3 = mk_var("v2",mk_type("triple",[tv3,BOOL,tv1]));
val iv1 = mk_var(" a b c = F",tv1);
val iv2 = mk_var(" a b c = T",BOOL);
val c1 = mk_const("c1",BOOL);
val c2 = mk_const("c2",mk_type("triple",[tv1,tv2,tv3]));
val c3 = mk_const("c3",mk_type("triple",[tv3,BOOL,tv1]));
val c4 = mk_const("c4",mk_fun(BOOL,mk_fun(tv2,tv3)));
val c5 = mk_const("c5",mk_fun(tv1,mk_fun(tv2,BOOL)));
val c6 = mk_const("c6",mk_fun(tv1,mk_fun(tv2,mk_fun(tv3,
	mk_type("triple",[tv1,tv2,tv3])))));
val c7 = mk_const(" starts with space",BOOL);
val cm1 = mk_comb(c6,vtv1);
val cm2 = mk_comb(cm1,vtv2);
val cm3 = mk_comb(cm2,vtv3);
val a1 = simple_mk_abs(v1, cm3);
val a2 = simple_mk_abs(v2,v2);
val a3 = simple_mk_abs(hd(mg_variables [tv1][]), c2);
val a4 = simple_mk_abs(iv1, c2);
val eq1 = mk_eq(c1,v1);
val BeqB = equality BOOL BOOL; 
val T = mk_const("T",BOOL);
val F = mk_const("F",BOOL);
val Š = mk_const("Š",mk_fun(BOOL,mk_fun(BOOL,BOOL)));
val N0 = mk_† 0;
val N2 = mk_† 2;
val cca = mk_char "a";
val ccc = mk_char "c";
val sc_abc = mk_string "abc";
fun replace_with_const l x = (
	let val (n,ty) = dest_var x
	in mk_const("rwc_" ^ n, ty) end);
=TEX
\section{THE TESTS}
\subsection{Tests on Types}
\subsubsection{dest\_type}
=SML
store_mt_results mt_run[("dest_type 1",
	dest_type,
	†,
	("†",[])),
	("dest_type 2",
	dest_type,
	†,
	("†",[])),
	("dest_type 3",
	dest_type,
	mk_fun(BOOL,†),
	("‹",[BOOL,†])),
	("dest_type 4",
	dest_type,
	BOOL cross †,
	("‰",[BOOL,†]))
	];

store_mt_results mt_run_fail[("dest_type 3001",
	dest_type,
	tv1,
	gen_fail_msg "dest_type" 3001 ["'tv1"])];
=TEX
\subsubsection{mk\_type}
=SML
store_mt_results mt_run [
	("mk_type 1",
	dest_type o mk_type,
	("UNIT",[]),
	("UNIT",[])),
	("mk_type 2",
	dest_type o mk_type,
	("THREE",[BOOL,†,BN]),
	("THREE",[BOOL,†,BN])),
	("mk_type 3",
	dest_type o mk_type,
	("",[BOOL,†,BN]),
	("",[BOOL,†,BN]))
	];
=TEX
\subsubsection{is\_type}
=SML
store_mt_results mt_run [
	("is_type 1",
	is_type,
	BN,
	true),
	("is_type 2",
	is_type,
	BtoN,
	true),
	("is_type 3",
	is_type,
	tv1,
	false)
	];
=TEX
\subsubsection{dest\_vartype}	
=SML
store_mt_results mt_run [
	("dest_vartype 1",
	dest_vartype,
	tv1,
	"'tv1"),
	("dest_vartype 2",
	dest_vartype,
	mk_vartype "",
	"")
	];

store_mt_results mt_run_fail [
	("dest_vartype 3019 a",
	dest_vartype,
	BOOL,
	gen_fail_msg "dest_vartype" 3019 []),
	("dest_vartype 3019 b",
	dest_vartype,
	BtoN,
	gen_fail_msg "dest_vartype" 3019 [])
	];
=TEX
\subsubsection{mk\_vartype}
=SML
store_mt_results mt_run[
	("mk_vartype 1",
	dest_vartype o mk_vartype,
	"'tv1",
	"'tv1"),
	("mk_vartype 2",
	dest_vartype o mk_vartype,
	"",
	""),
	("mk_vartype 3",
	dest_vartype o mk_vartype,
	"BOOL",
	"BOOL")
	];
=TEX
\subsubsection{is\_vartype}
=SML
store_mt_results mt_run [
	("is_vartype 1",
	is_vartype,
	BN,
	false),
	("is_vartype 2",
	is_vartype,
	BtoN,
	false),
	("is_vartype 3",
	is_vartype,
	tv1,
	true)
	];
=TEX
\subsubsection{dest\_funtype}
=SML
store_mt_results mt_run [
	("dest_funtype 1",
	dest_funtype o mk_fun,
	(BOOL,†),
	(BOOL,†)),
	("dest_funtype 2",
	dest_funtype o mk_fun,
	(BOOL,tv1),
	(BOOL,tv1))
	];

store_mt_results mt_run_fail [
	("dest_funtype",
	dest_funtype,
	tv1,
	gen_fail_msg "dest_funtype" 3022 []),
	("dest_funtype",
	dest_funtype,
	BN,
	gen_fail_msg "dest_funtype" 3022 [])
	];
=TEX
\subsubsection{mk\_fun}
=SML
store_mt_results mt_run [
	("mk_fun 1",
	mk_fun,
	(BOOL,†),
	mk_type("‹",[BOOL,†])),
	("mk_fun 2",
	mk_fun,
	(BOOL,tv1),
	mk_type("‹",[BOOL,tv1]))
	];
=TEX
\subsubsection{is\_funtype}
=SML
store_mt_results mt_run [
	("is_funtype 1",
	is_funtype,
	BN,
	false),
	("is_funtype 2",
	is_funtype,
	BtoN,
	true),
	("is_funtype 3",
	is_funtype,
	tv1,
	false)
	];
=TEX
\subsubsection{icl'inst\_type}
=SML
store_mt_results mt_run [
	("icl'inst_type 1",
	uncurry icl'inst_type,
	([(BOOL, "'tv1"),(BN,"'tv3")], mk_fun(tv1,BOOL)),
	mk_fun(BOOL,BOOL)),
	("icl'inst_type 2",
	uncurry icl'inst_type,
	([(BOOL, "'tv1"),(BN,"'tv3")], mk_fun(BOOL,tv2)),
	mk_fun(BOOL,tv2)),
	("icl'inst_type 3",
	uncurry icl'inst_type,
	([(BOOL, "'tv1"),(BN,"'tv3")], tv3 cross BOOL),
	BN cross BOOL),
	("icl'inst_type 4",
	uncurry icl'inst_type,
	([(BOOL, "'tv1"),(BN,"'tv1")], tv1),
	BOOL),
	("icl'inst_type 5",
	uncurry icl'inst_type,
	([(tv3, "'tv1"),(BN,"'tv3")], tv1),
	tv3),
	("icl'inst_type 6",
	uncurry icl'inst_type,
	([(BtoN, "'tv1"),(BN,"'tv3")], tv3 cross tv1),
	BN cross BtoN),
	("icl'inst_type 7",
	uncurry icl'inst_type,
	([(BtoN, "'tv1"),(BN,"'tv3")], tv2 cross tv1),
	tv2 cross BtoN)
	];
=TEX
\subsubsection{icl'inst\_type}
=SML
store_mt_results mt_run [
	("inst_type 1",
	uncurry inst_type,
	([(BOOL, tv1),(BN,tv3)], mk_fun(tv1,BOOL)),
	mk_fun(BOOL,BOOL)),
	("inst_type 2",
	uncurry inst_type,
	([(BOOL, tv1),(BN,tv3)], mk_fun(BOOL,tv2)),
	mk_fun(BOOL,tv2)),
	("inst_type 3",
	uncurry inst_type,
	([(BOOL, tv1),(BN,tv3)], tv3 cross BOOL),
	BN cross BOOL),
	("inst_type 4",
	uncurry inst_type,
	([(BOOL, tv1),(BN,tv1)], tv1),
	BOOL),
	("inst_type 5",
	uncurry inst_type,
	([(tv3, tv1),(BN,tv3)], tv1),
	tv3),
	("inst_type 6",
	uncurry inst_type,
	([(BtoN, tv1),(BN,tv3)], tv3 cross tv1),
	BN cross BtoN),
	("inst_type 7",
	uncurry inst_type,
	([(BtoN, tv1),(BN,tv3)], tv2 cross tv1),
	tv2 cross BtoN)
	];
store_mt_results mt_run_fail [
	("inst_type 3035",
	inst_type [(BOOL,BOOL)],
	tv1,
	gen_fail_msg "inst_type" 3035 [])
	];
=TEX
\subsubsection{type\_tycons}
Notice the ordering of test 4's results.
=SML
store_mt_results mt_run [
	("type_tycons 1",
	type_tycons,
	tv1,
	[]),
	("type_tycons 2",
	type_tycons,
	BOOL,
	[("BOOL",0)]),
	("type_tycons 3",
	type_tycons,
	BtoN,
	[("‹",2),("BOOL",0),("†",0)]),
	("type_tycons 4",
	type_tycons,
	BtoN cross (mk_fun(†,BOOL)),
	[("‰",2),("‹",2),("†",0),("BOOL",0)]),
	("type_tycons 5",
	type_tycons,
	tv1 cross BtoN,
	[("‰",2),("‹",2),("BOOL",0),("†",0)])
	];
=TEX
\subsubsection{type\_tyvars}
Notice the ordering of test 5's results.
=SML
store_mt_results mt_run [
	("type_tyvars 1",
	type_tyvars,
	tv1,
	["'tv1"]),
	("type_tyvars 2",
	type_tyvars,
	BOOL,
	[]),
	("type_tyvars 3",
	type_tyvars,
	BtoN,
	[]),
	("type_tyvars 4",
	type_tyvars,
	tv1 cross BtoN,
	["'tv1"]),
	("type_tyvars 5",
	type_tyvars,
	tv1 cross (tv2 cross tv1),
	["'tv2","'tv1"])
	];
=TEX
\subsubsection{type\_any}
=SML
store_mt_results mt_run [
	("type_any 1",
	type_any (fn x => is_vartype x andalso ord(dest_vartype x) = ord "T"),
	(tv1 cross tv2),
	false),
	("type_any 2",
	type_any (fn x => is_vartype x andalso ord(dest_vartype x) = ord "T"),
	(mk_vartype "TV1" cross tv2),
	true)
	];
=TEX
=TEX
\subsection{Tests on Terms}
\subsubsection{simple\_dest\_term}
=SML
store_mt_results mt_run [
	("simple_dest_term 1",
	simple_dest_term,
	vtv2,
	(Var("vtv2",tv2))),
	("simple_dest_term 2",
	simple_dest_term,
	c1,
	(Const("c1",BOOL))),
	("simple_dest_term 3",
	simple_dest_term,
	cm1,
	(Comb(c6,vtv1))),
	("simple_dest_term 4",
	simple_dest_term,
	a1,
	(Abs(v1,cm3)))
	];
=TEX
\subsubsection{simple\_mk\_term}
=SML
store_mt_results mt_run [
	("simple_mk_term 1",
	simple_mk_term,
	(Var("vtv2",tv2)),
	vtv2),
	("simple_mk_term 2",
	simple_mk_term,
	(Const("c1",BOOL)),
	c1),
	("simple_mk_term 3",
	simple_mk_term,
	(Comb(c6,vtv1)),
	cm1),
	("simple_mk_term 4",
	simple_mk_term,
	(Abs(v1,cm3)),
	a1)
	];

store_mt_results mt_run_fail [
	("simple_mk_term 3002",
	simple_mk_term,
	Comb(c6, c6),
	gen_fail_msg "simple_mk_term" 3002 []),
	("simple_mk_term 3003",
	simple_mk_term,
	Comb(c1, c1),
	gen_fail_msg "simple_mk_term" 3003 []),
	("simple_mk_term 3020 a",
	simple_mk_term,
	Abs(c1, c1),
	gen_fail_msg "simple_mk_term" 3020 []),
	("simple_mk_term 3020 b",
	simple_mk_term,
	Abs(cm1, c1),
	gen_fail_msg "simple_mk_term" 3020 []),
	("simple_mk_term 3020 c",
	simple_mk_term,
	Abs(a1, c1),
	gen_fail_msg "simple_mk_term" 3020 [])
	];


=SML
=TEX
\subsubsection{type\_of}
=SML
store_mt_results mt_run [
	("type_of 1",
	type_of,
	c1,
	BOOL),
	("type_of 2",
	type_of,
	vtv1,
	tv1),
	("type_of 3",
	type_of,
	cm3,
	mk_type("triple",[tv1,tv2,tv3])),
	("type_of 4",
	type_of,
	a1,
	mk_fun(BOOL,mk_type("triple",[tv1,tv2,tv3])))
	];
=TEX
\subsubsection{dest\_var}
=SML
store_mt_results mt_run [
	("dest_var 1",
	dest_var,
	vtv1,
	("vtv1",tv1)),
	("dest_var 2",
	dest_var,
	mk_var("",BOOL),
	("",BOOL))
	];

store_mt_results mt_run_fail [
	("dest_var 3008 a",
	dest_var,
	c1,
	gen_fail_msg "dest_var" 3008 []),
	("dest_var 3008 b",
	dest_var,
	a1,
	gen_fail_msg "dest_var" 3008 []),
	("dest_var 3008 c",
	dest_var,
	cm1,
	gen_fail_msg "dest_var" 3008 [])
	];
=TEX
\subsubsection{mk\_var}
=SML
store_mt_results mt_run [
	("mk_var 1",
	dest_var o mk_var,
	("vtv1",tv1),
	("vtv1",tv1)),
	("mk_var 2",
	dest_var o mk_var,
	(" vtv1",BOOL),
	(" vtv1",BOOL)),
	("mk_var 3",
	dest_var o mk_var,
	("",BtoN),
	("",BtoN))
	];
=TEX
\subsubsection{is\_var}
=SML
store_mt_results mt_run [
	("is_var 1",
	is_var,
	v1,
	true),
	("is_var 2",
	is_var,
	c1,
	false),
	("is_var 3",
	is_var,
	cm1,
	false),
	("is_var 4",
	is_var,
	a1,
	false)
	];
=TEX
\subsubsection{dest\_const}
=SML
store_mt_results mt_run [
	("dest_const 1",
	dest_const,
	c1,
	("c1",BOOL)),
	("dest_const 2",
	dest_const,
	mk_const("",BOOL),
	("",BOOL))
	];

store_mt_results mt_run_fail [
	("dest_const 3009 a",
	dest_const,
	v1,
	gen_fail_msg "dest_const" 3009 []),
	("dest_const 3009 b",
	dest_const,
	a1,
	gen_fail_msg "dest_const" 3009 []),
	("dest_const 3009 c",
	dest_const,
	cm1,
	gen_fail_msg "dest_const" 3009 [])
	];
=TEX
\subsubsection{mk\_const}
=SML
store_mt_results mt_run [
	("mk_const 1",
	dest_const o mk_const,
	("cn1",tv1),
	("cn1",tv1)),
	("mk_const 2",
	dest_const o mk_const,
	(" cn1",BOOL),
	(" cn1",BOOL)),
	("mk_const 3",
	dest_const o mk_const,
	("",BtoN),
	("",BtoN))
	];
=TEX
\subsubsection{is\_const}
=SML
store_mt_results mt_run [
	("is_const 1",
	is_const,
	v1,
	false),
	("is_const 2",
	is_const,
	c1,
	true),
	("is_const 3",
	is_const,
	cm1,
	false),
	("is_const 4",
	is_const,
	a1,
	false)
	];
=TEX
\subsubsection{dest\_comb}
=SML
store_mt_results mt_run [
	("dest_comb 1",
	dest_comb,
	cm1,
	(c6,vtv1)),
	("dest_comb 2",
	dest_comb,
	cm3,
	(cm2,vtv3))
	];

store_mt_results mt_run_fail [
	("dest_comb 3010 a",
	dest_comb,
	v1,
	gen_fail_msg "dest_comb" 3010 []),
	("dest_comb 3010 b",
	dest_comb,
	a1,
	gen_fail_msg "dest_comb" 3010 []),
	("dest_comb 3010 c",
	dest_comb,
	c1,
	gen_fail_msg "dest_comb" 3010 [])
	];
=TEX
\subsubsection{mk\_comb}
=SML
store_mt_results mt_run [
	("mk_comb 1",
	dest_comb o mk_comb,
	(c6,vtv1),
	(c6,vtv1)),
	("mk_comb 2",
	dest_comb o mk_comb,
	(cm2,vtv3),
	(cm2,vtv3))
	];

store_mt_results mt_run_fail [
	("mk_comb 3005",
	mk_comb,
	(c6,c6),
	gen_fail_msg "mk_comb" 3005 []),
	("mk_comb 3006",
	mk_comb,
	(c1,c1),
	gen_fail_msg "mk_comb" 3006 [])
	];

=TEX
\subsubsection{is\_comb}
=SML
store_mt_results mt_run [
	("is_comb 1",
	is_comb,
	v1,
	false),
	("is_comb 2",
	is_comb,
	c1,
	false),
	("is_comb 3",
	is_comb,
	cm1,
	true),
	("is_comb 4",
	is_comb,
	a1,
	false)
	];
=TEX
\subsubsection{list\_mk\_comb}
=SML
store_mt_results mt_run [
	("list_mk_comb 1",
	list_mk_comb,
	(c6, [vtv1, vtv2, vtv3]),
	cm3),
	("list_mk_comb 2",
	list_mk_comb,
	(c6, []),
	c6),
	("list_mk_comb 3",
	list_mk_comb,
	(c1, []),
	c1)
	];

store_mt_results mt_run_fail [
	("list_mk_comb 3005",
	list_mk_comb,
	(c6,[vtv1, c6,vtv3]),
	gen_fail_msg "mk_comb" 3005 []),
	("list_mk_comb 3006",
	list_mk_comb,
	(c6,[vtv1, vtv2, vtv3, c1]),
	gen_fail_msg "mk_comb" 3006 [])
	];
=TEX
\subsubsection{strip\_comb}
=SML
store_mt_results mt_run [
	("strip_comb 1",
	strip_comb,
	cm3,
	(c6, [vtv1, vtv2, vtv3])),
	("strip_comb 2",
	strip_comb,
	c1,
	(c1, []))
	];
=TEX
\subsubsection{simple\_dest\_abs}
=SML
store_mt_results mt_run [
	("simple_dest_abs 1",
	simple_dest_abs,
	a1,
	(v1,cm3)),
	("simple_dest_abs 2",
	simple_dest_abs,
	a4,
	(iv1,c2))
	];

store_mt_results mt_run_fail [
	("simple_dest_abs 3011 a",
	simple_dest_abs,
	v1,
	gen_fail_msg "simple_dest_abs" 3011 []),
	("simple_dest_abs 3011 b",
	simple_dest_abs,
	cm1,
	gen_fail_msg "simple_dest_abs" 3011 []),
	("simple_dest_abs 3011 c",
	simple_dest_abs,
	c1,
	gen_fail_msg "simple_dest_abs" 3011 [])
	];
=TEX
\subsubsection{simple\_mk\_abs}
=SML
store_mt_results mt_run [
	("simple_mk_abs 1",
	simple_dest_abs o simple_mk_abs,
	(v1, cm3),
	(v1, cm3)),
	("mk_abs 2",
	simple_dest_abs o simple_mk_abs,
	(iv1, c2),
	(iv1, c2))
	];

store_mt_results mt_run_fail [
	("simple_mk_abs 3007 a",
	simple_mk_abs,
	(c6,c6),
	gen_fail_msg "simple_mk_abs" 3007 []),
	("simple_mk_abs 3007 b",
	simple_mk_abs,
	(a1,c6),
	gen_fail_msg "simple_mk_abs" 3007 []),
	("simple_mk_abs 3007 c",
	simple_mk_abs,
	(cm1,c6),
	gen_fail_msg "simple_mk_abs" 3007 [])
	];

=TEX
\subsubsection{simple\_is\_abs}
=SML
store_mt_results mt_run [
	("simple_is_abs 1",
	simple_is_abs,
	v1,
	false),
	("simple_is_abs 2",
	simple_is_abs,
	c1,
	false),
	("simple_is_abs 3",
	simple_is_abs,
	cm1,
	false),
	("simple_is_abs 4",
	simple_is_abs,
	a1,
	true)
	];
=TEX
\subsubsection{simple\_list\_mk\_abs}
=SML
store_mt_results mt_run [
	("simple_list_mk_abs 1",
	simple_list_mk_abs,
	([vtv1, vtv2, vtv3], c6),
	simple_mk_abs(vtv1,simple_mk_abs(vtv2,simple_mk_abs(vtv3,c6)))),
	("simple_list_mk_abs 2",
	simple_list_mk_abs,
	([], c6),
	c6)
	];

store_mt_results mt_run_fail [
	("simple_list_mk_abs 3007",
	simple_list_mk_abs,
	([vtv1, c6,vtv3],c6),
	gen_fail_msg "simple_mk_abs" 3007 [])
	];
=TEX
\subsubsection{icl'frees}
=SML
store_mt_results mt_run [
	("icl'frees 1",
	map mk_var o icl'frees,
	cm3,
	[vtv3, vtv2, vtv1]),
	("icl'frees 2",
	map mk_var o icl'frees,
	simple_mk_abs(vtv2,cm3),
	[vtv3, vtv1]),
	("icl'frees 3",
	map mk_var o icl'frees,
	mk_eq(vtv1,vtv1),
	[vtv1])
	];
=TEX
\subsubsection{is\_free\_var\_in}
Test 2 fails for issue 1.7 of \cite{DS/FMU/IED/IMP003} due to a bug in the implementation,
but correct thereafter.
=SML
store_mt_results mt_run [
	("is_free_var_in 1",
	is_free_var_in (dest_var vtv2),
	cm3,
	true),
	("is_free_var_in 2",
	is_free_var_in (dest_var vtv2),
	simple_mk_abs(vtv2,cm3),
	false),
	("is_free_var_in 3",
	is_free_var_in (dest_var vtv2),
	mk_comb(simple_mk_abs(vtv2,cm3), vtv2),
	true),
	("is_free_var_in 3",
	is_free_var_in (dest_var vtv2),
	mk_eq(vtv2,vtv2),
	true)
	];
=TEX
We leave the testing of $mk\_bin\_op$, $equality$, $quantifier$ and their like to the testing
of the functions that use them in their implementation.
\subsubsection{Concerning Equality}
=SML
store_mt_results mt_run [
	("mk_eq 1",
	mk_eq,
	(c1,v1),
	list_mk_comb (BeqB, [c1,v1])),
	("mk_eq 2",
	mk_eq,
	(c1,c1),
	list_mk_comb (BeqB, [c1,c1]))
	];

store_mt_results mt_run_fail [
	("mk_eq 3013",
	mk_eq,
	(c1, c2),
	gen_fail_msg "mk_eq" 3013 [])
	];

store_mt_results mt_run [
	("dest_eq 1",
	dest_eq o mk_eq,
	(c1,v1),
	(c1,v1)),
	("dest_eq 2",
	dest_eq o mk_eq,
	(c1,c1),
	(c1,c1))
	];

store_mt_results mt_run_fail [
	("dest_eq 3014",
	dest_eq,
	c1,
	gen_fail_msg "dest_eq" 3014 [])
	];

store_mt_results mt_run [
	("is_eq 1",
	is_eq,
	eq1,
	true),
	("is_eq 1",
	is_eq,
	c1,
	false)
	];
=TEX
\subsubsection{Concerning Š}
=SML
store_mt_results mt_run [
	("mk_Š",
	mk_Š,
	(T,F),
	list_mk_comb(Š,[T,F]))
	];

store_mt_results mt_run_fail [
	("mk_Š 3015",
	mk_Š,
	(c2,c3),
	gen_fail_msg "mk_Š" 3015 [])
	];

store_mt_results mt_run [
	("dest_Š",
	dest_Š o mk_Š,
	(T,F),
	(T,F))
	];

store_mt_results mt_run_fail [
	("dest_Š 3016",
	dest_Š,
	c1,
	gen_fail_msg "dest_Š" 3016 [])
	];

store_mt_results mt_run [
	("is_Š 1",
	is_Š,
	mk_Š(T,F),
	true),
	("is_Š 2",
	is_Š,
	c1,
	false)
	];

store_mt_results mt_run [
	("list_mk_Š 1",
	list_mk_Š,
	[T],
	T),
	("list_mk_Š 2",
	list_mk_Š,
	[T,F],
	mk_Š(T,F)),
	("list_mk_Š 3",
	list_mk_Š,
	[T,F,c1],
	mk_Š(T,mk_Š(F,c1)))
	];

store_mt_results mt_run_fail [
	("list_mk_Š 3017",
	list_mk_Š,
	[],
	gen_fail_msg "list_mk_Š" 3017 []),
	("list_mk_Š 3018",
	list_mk_Š,
	[vtv1, vtv2],
	gen_fail_msg "list_mk_Š" 3018 [])
	];
=TEX
\subsubsection{Concerning ƒ}
=SML
store_mt_results mt_run [
	("simple_mk_ƒ",
	simple_mk_ƒ,
	(vtv1, c1),
	mk_comb(quantifier "ƒ" tv1 BOOL,
		simple_mk_abs(vtv1, c1)))
	];

store_mt_results mt_run_fail [
	("simple_mk_ƒ 3031 a",
	simple_mk_ƒ,
	(c1,c1),
	gen_fail_msg "simple_mk_ƒ" 3031 []),
	("simple_mk_ƒ 3031 b",
	simple_mk_ƒ,
	(v1,c2),
	gen_fail_msg "simple_mk_ƒ" 3031 [])
	];

store_mt_results mt_run [
	("simple_dest_ƒ",
	simple_dest_ƒ o simple_mk_ƒ,
	(vtv1, c1),
	(vtv1, c1))
	];

store_mt_results mt_run_fail [
	("simple_dest_ƒ 3032",
	simple_dest_ƒ,
	c1,
	gen_fail_msg "simple_dest_ƒ" 3032 [])
	];

store_mt_results mt_run [
	("simple_is_ƒ 1",
	simple_is_ƒ,
	simple_mk_ƒ (v1,F),
	true),
	("simple_is_ƒ 1",
	simple_is_ƒ,
	c1,
	false)
	];

store_mt_results mt_run [
	("simple_list_mk_ƒ 1",
	simple_list_mk_ƒ,
	([vtv1, vtv2], c1),
	simple_mk_ƒ(vtv1,simple_mk_ƒ(vtv2,c1))),
	("simple_list_mk_ƒ 2",
	simple_list_mk_ƒ,
	([], c1),
	c1)
	];

store_mt_results mt_run_fail [
	("simple_list_mk_ƒ 3031 a",
	simple_list_mk_ƒ,
	([v1,c1],c1),
	gen_fail_msg "simple_mk_ƒ" 3031 []),
	("simple_list_mk_ƒ 3031 b",
	simple_list_mk_ƒ,
	([v1],c2),
	gen_fail_msg "simple_mk_ƒ" 3031 [])
	];

=TEX
\subsubsection{Concerning „}
=SML
store_mt_results mt_run [
	("simple_mk_„",
	simple_mk_„,
	(vtv1, c1),
	mk_comb(quantifier "„" tv1 BOOL,
		simple_mk_abs(vtv1, c1)))
	];

store_mt_results mt_run_fail [
	("simple_mk_„ 3031 a",
	simple_mk_„,
	(c1,c1),
	gen_fail_msg "simple_mk_„" 3031 []),
	("simple_mk_„ 3031 b",
	simple_mk_„,
	(v1,c2),
	gen_fail_msg "simple_mk_„" 3031 [])
	];

store_mt_results mt_run [
	("simple_dest_„",
	simple_dest_„ o simple_mk_„,
	(vtv1, c1),
	(vtv1, c1))
	];

store_mt_results mt_run_fail [
	("simple_dest_„ 3034",
	simple_dest_„,
	c1,
	gen_fail_msg "simple_dest_„" 3034 [])
	];

store_mt_results mt_run [
	("simple_is_„ 1",
	simple_is_„,
	simple_mk_„ (v1,F),
	true),
	("simple_is_„ 1",
	simple_is_„,
	c1,
	false)
	];

store_mt_results mt_run [
	("simple_list_mk_„ 1",
	simple_list_mk_„,
	([vtv1, vtv2], c1),
	simple_mk_„(vtv1,simple_mk_„(vtv2,c1))),
	("simple_list_mk_„ 2",
	simple_list_mk_„,
	([], c1),
	c1)
	];

store_mt_results mt_run_fail [
	("simple_list_mk_„ 3031 a",
	simple_list_mk_„,
	([v1,c1],c1),
	gen_fail_msg "simple_mk_„" 3031 []),
	("simple_list_mk_„ 3031 b",
	simple_list_mk_„,
	([v1],c2),
	gen_fail_msg "simple_mk_„" 3031 [])
	];

=TEX
\subsubsection{Concerning Numbers}
=SML
store_mt_results mt_run [
	("mk_† 2",
	mk_†,
	2,
	mk_const("2",†))
	];

store_mt_results mt_run_fail [
	("mk_† 3021",
	mk_†,
	~3,
	gen_fail_msg "mk_†" 3021 [string_of_int ~3])
	];

store_mt_results mt_run [
	("is_† 1",
	is_†,
	N0,
	true),
	("is_† 2",
	is_†,
	mk_const("N0",†),
	false)
	];

store_mt_results mt_run [
	("dest_† 1",
	dest_†,
	N2,
	2)
	];

store_mt_results mt_run_fail [
	("dest_† 3026",
	dest_†,
	mk_const("N0",†),
	gen_fail_msg "dest_†" 3026 []),
	("dest_† 3026",
	dest_†,
	v1,
	gen_fail_msg "dest_†" 3026 [])
	];

=TEX
\subsubsection{Concerning Characters}
=SML
store_mt_results mt_run [
	("mk_char 1",
	mk_char,
	"a",
	mk_const("`a",CHAR))
	];

store_mt_results mt_run_fail [
	("mk_char 3023 a",
	mk_char,
	"abc",
	gen_fail_msg "mk_char" 3023 ["abc"]),
	("mk_char 3023 b",
	mk_char,
	"",
	gen_fail_msg "mk_char" 3023 [""])
	];

store_mt_results mt_run [
	("is_char 1",
	is_char,
	ccc,
	true),
	("is_char 2",
	is_char,
	mk_const("ab",CHAR),
	false),
	("is_char 3",
	is_char,
	mk_const("'ab",CHAR),
	false),
	("is_char 4",
	is_char,
	mk_const("`ab",CHAR),
	false)
	];

store_mt_results mt_run [
	("dest_char 1",
	dest_char,
	ccc,
	"c")
	];

store_mt_results mt_run_fail [
	("dest_char 3024 a",
	dest_char,
	mk_const("N0",CHAR),
	gen_fail_msg "dest_char" 3024 []),
	("dest_char 3024 b",
	dest_char,
	mk_const("'ab",CHAR),
	gen_fail_msg "dest_char" 3024 []),
	("dest_char 3024 c",
	dest_char,
	v1,
	gen_fail_msg "dest_char" 3024 [])
	];

=TEX
\subsubsection{Concerning Strings}
Note that tests for $dest\_string$ fail for issue 1.7
of \cite{DS/FMU/IED/IMP003}, due to a bug in the implementation, fixed in later verisons.
=SML
store_mt_results mt_run [
	("mk_string 1",
	mk_string,
	"abc",
	mk_const("\"abc",STRING)),
	("mk_string 2",
	mk_string,
	"",
	mk_const("\"",STRING))
	];

store_mt_results mt_run [
	("is_string 1",
	is_string,
	sc_abc,
	true),
	("is_string 2",
	is_string,
	mk_const("ab",STRING),
	false)
	];

store_mt_results mt_run [
	("dest_string 1",
	dest_string,
	sc_abc,
	"abc")
	];

store_mt_results mt_run_fail [
	("dest_string 3025",
	dest_string,
	mk_const("N0",STRING),
	gen_fail_msg "dest_string" 3025 []),
	("dest_string 3025",
	dest_string,
	v1,
	gen_fail_msg "dest_string" 3025 [])
	];


=TEX
\subsubsection{aconv}
Note that test 7 fails for issue 1.7
of \cite{DS/FMU/IED/IMP003}, due to a bug in the implementation, fixed in later verisons.
=SML
store_mt_results mt_run [
	("aconv 1",
	uncurry aconv,
	(vtv1, c1),
	false),
	("aconv 2",
	uncurry aconv,
	(vtv1, vtv1),
	true),
	("aconv 3",
	uncurry aconv,
	(simple_mk_abs(v1,c1), simple_mk_abs(av1,c1)),
	true),
	("aconv 4",
	uncurry aconv,
	(simple_mk_abs(v1,v1), simple_mk_abs(av1,av1)),
	true),
	("aconv 5",
	uncurry aconv,
	(simple_mk_abs(v1,v1), simple_mk_abs(av1,v1)),
	false),
	("aconv 6",
	uncurry aconv,
	(simple_mk_abs(v1,v1), simple_mk_abs(v1,av1)),
	false),
	("aconv 7",
	uncurry aconv,
	(simple_mk_abs(v1,v1), simple_mk_abs(vtv1,vtv1)),
	false)
	];

=TEX
\subsubsection{term\_mem}
=SML
store_mt_results mt_run [
	("term_mem 1",
	(curry(op term_mem)) v1,
	[v2,v1],
	true),
	("term_mem 2",
	(curry(op term_mem)) (simple_mk_abs(v1,v1)),
	[simple_mk_abs(av1,av1),v2],
	true),
	("term_mem 3",
	(curry(op term_mem)) v1,
	[simple_mk_abs(av1,av1),v2],
	false)
	];
=TEX
\subsubsection{term\_less}
=SML
store_mt_results mt_run [
	("term_less 1",
	(curry(op term_less)) [v2,v1],
	v1,
	[v2]),
	("term_less 2",
	(curry(op term_less)) [simple_mk_abs(av1,av1),v2],
	(simple_mk_abs(v1,v1)),
	[v2]),
	("term_less 3",
	(curry(op term_less)) [simple_mk_abs(av1,av1),v2],
	v1,
	[simple_mk_abs(av1,av1),v2])
	];
=TEX
\subsubsection{term\_grab}
=SML
store_mt_results mt_run [
	("term_grab 1",
	(curry(op term_grab)) [v2,v1],
	v1,
	[v2,v1]),
	("term_grab 2",
	(curry(op term_grab)) [simple_mk_abs(av1,av1),v2],
	(simple_mk_abs(v1,v1)),
	[simple_mk_abs(av1,av1),v2]),
	("term_grab 3",
	(curry(op term_grab)) [simple_mk_abs(av1,av1),v2],
	v1,
	[v1,simple_mk_abs(av1,av1),v2])
	];

=TEX
\subsubsection{term\_union}
=SML
store_mt_results mt_run [
	("term_union 1",
	(curry(op term_union)) [v2,v1],
	[v1],
	[v2,v1]),
	("term_union 2",
	(curry(op term_union)) [simple_mk_abs(av1,av1),v2],
	[(simple_mk_abs(v1,v1))],
	[v2,simple_mk_abs(v1,v1)]),
	("term_union 3",
	(curry(op term_union)) [simple_mk_abs(av1,av1),v2],
	[v1],
	[simple_mk_abs(av1,av1),v2,v1]),
	("term_union 4",
	(curry(op term_union)) [F,simple_mk_abs(av1,av1),v2],
	[v1,T,v2],
	[F,simple_mk_abs(av1,av1),v1,T,v2])
	];

=TEX
\subsubsection{list\_term\_union}
=SML
store_mt_results mt_run [
	("list_term_union 1",
	list_term_union,
	[[v2,v1],[v1]],
	[v2,v1]),
	("list_term_union 2",
	list_term_union,
	[[simple_mk_abs(av1,av1),v2],[(simple_mk_abs(v1,v1))]],
	[v2,simple_mk_abs(v1,v1)]),
	("list_term_union 3",
	list_term_union,
	[[simple_mk_abs(av1,av1),v2],[v1]],
	[simple_mk_abs(av1,av1),v2,v1]),
	("list_term_union 4",
	list_term_union,
	[[F,simple_mk_abs(av1,av1),v2],[v1,T,v2]],
	[F,simple_mk_abs(av1,av1),v1,T,v2]),
	("list_term_union 5",
	list_term_union,
	[],
	[]),
	("list_term_union 6",
	list_term_union,
	[[T],[F,v2],[v1,F]],
	[T,v2,v1,F])
	];
=TEX
\subsubsection{icl'variant}
=SML
store_mt_results mt_run [
	("icl'variant 1",
	icl'variant [],
	"s1",
	"s1"),
	("icl'variant 2",
	icl'variant ["s1","s2","s3"],
	"s2",
	"s2'"),
	("icl'variant 3",
	icl'variant ["s2'","s1","s2","s3"],
	"s2",
	"s2''")	];

store_mt_results mt_run [
	("set_variant_string 1",
	set_variant_string,
	"_var",
	"'")];

store_mt_results mt_run_fail [
	("set_variant_string 3028",
	set_variant_string,
	"",
	gen_fail_msg "set_variant_string" 3028 [])
	];

store_mt_results mt_run [
	("icl'variant 4",
	icl'variant ["s1","s2","s3","s2'"],
	"s2",
	"s2_var"),
	("icl'variant 5",
	icl'variant ["s1","s2","s3","s2_var"],
	"s2",
	"s2_var_var")
	];

store_mt_results mt_run [
	("set_variant_string 2",
	set_variant_string,
	"'",
	"_var")
	];

=TEX
\subsubsection{icl'subst}
=SML
store_mt_results mt_run [
	("icl'subst 1",
	icl'subst [(T,("v1",BOOL))],
	c1,
	c1),
	("icl'subst 2",
	icl'subst [(T,("v1",BOOL))],
	v1,
	T),
	("icl'subst 3",
	icl'subst [(T,("v1",BOOL)),(F,("av1",BOOL))],
	mk_eq(v1,av1),
	mk_eq(T,F)),
	("icl'subst 4",
	icl'subst [(T,("v1",BOOL)),(F,("v1",BOOL))],
	mk_eq(v1,av1),
	mk_eq(T,av1)),
	("icl'subst 5",
	icl'subst [(T,("v1",BOOL)),(F,("av1",BOOL))],
	simple_mk_„(v1,av1),
	simple_mk_„(v1,F)),
	("icl'subst 6",
	icl'subst [(T,("v1",BOOL)),(F,("av1",BOOL))],
	simple_mk_„(v1,v1),
	simple_mk_„(v1,v1)),
	("icl'subst 7",
	icl'subst [(T,("v1",BOOL)),(F,("av1",BOOL))],
	simple_mk_„(mk_var("v1",†),v1),
	simple_mk_„(mk_var("v1",†),T)),
	("icl'subst 8",
	icl'subst [(av1,("v1",BOOL))],
	simple_mk_„(mk_var("av1",†),v1),
	simple_mk_„(mk_var("av1'",†),av1))
	];

store_mt_results mt_run_fail [
	("icl'subst 3052",
	icl'subst [(T,("vtv1",tv2))],
	c1,
	gen_fail_msg "icl'subst" 3052 [])
	];
=TEX
\subsubsection{rename}
=SML
store_mt_results mt_run [
	("rename 1",
	rename ("v1",BOOL) "renamed_v1",
	simple_mk_„(v1, av1),
	simple_mk_„(v1, av1)),
	("rename 2",
	rename ("v1",BOOL) "renamed_v1",
	simple_mk_„(v1, v1),
	simple_mk_„(v1, v1)),
	("rename 3",
	rename ("v1",BOOL) "renamed_v1",
	simple_mk_„(av1, v1),
	simple_mk_„(av1, (mk_var("renamed_v1",BOOL))))
	];
=TEX
\subsubsection{icl'inst}
=SML
store_mt_results mt_run [
	("icl'inst 1",
	icl'inst [("av1",tv1),("av2",tv2)] [(BOOL,"'tv1"),(tv1,"'tv2")],
	cm3,
	list_mk_comb(mk_const("c6", mk_fun(BOOL,mk_fun(tv1,
		mk_fun(tv3,mk_type("triple",[BOOL,tv1,tv3]))))),
		[mk_var("vtv1",BOOL),
		 mk_var("vtv2",tv1),
		vtv3])),
	("icl'inst 2",
	icl'inst [("vtv2",tv1),("av2",tv2)] [(BOOL,"'tv1"),(tv1,"'tv2")],
	cm3,
	list_mk_comb(mk_const("c6", mk_fun(BOOL,mk_fun(tv1,
		mk_fun(tv3,mk_type("triple",[BOOL,tv1,tv3]))))),
		[mk_var("vtv1",BOOL),
		 mk_var("vtv2'",tv1),
		vtv3]))
	];
=TEX
\subsubsection{term\_types}
=SML
store_mt_results mt_run [
	("term_types 1",
	term_types,
	cm3,
	[type_of c6, tv1, tv2, tv3]),
	("term_types 2",
	term_types,
	a1,
	[BOOL, type_of c6, tv1, tv2, tv3])
	];
=TEX
\subsubsection{term\_any}
=SML
store_mt_results mt_run [
	("term_any 1",
	term_any (fn x => is_const x andalso fst(dest_const x) = "T"),
	cm3,
	false),
	("term_any 2",
	term_any (fn x => is_const x andalso fst(dest_const x) = "c6"),
	cm3,
	true)
	];
=TEX
\subsubsection{term\_any}
=SML
store_mt_results mt_run [
	("term_tyvars 1",
	term_tyvars,
	cm3,
	["'tv1", "'tv2", "'tv3"])
	];
=TEX
\subsubsection{term\_any}
=SML
store_mt_results mt_run [
	("term_type_constructors 1",
	term_type_constructors,
	cm3,
	[("‹", 2), ("triple", 3)]),
	("term_type_constructors 2",
	term_type_constructors,
	vtv1,
	[])
	];
=TEX
\subsubsection{term\_consts}
=SML
store_mt_results mt_run [
	("term_consts 1",
	term_consts,
	cm3,
	[dest_const c6]),
	("term_consts 2",
	term_consts,
	mk_eq(T,T),
	[("=",mk_fun(BOOL,mk_fun(BOOL,BOOL))), ("T",BOOL)])
	];
=TEX
\subsubsection{type\_match}
=SML
store_mt_results mt_run [
	("type_match 1",
	type_match BOOL,
	tv1,
	[(BOOL,tv1)]),
	("type_match 2",
	type_match BtoN,
	mk_fun(tv1,tv2),
	[(†,tv2),(BOOL,tv1)]),
	("type_match 3",
	type_match (mk_fun(tv1,tv2)),
	mk_fun(tv2,tv1),
	[(tv2,tv1),(tv1,tv2)]),
	("type_match 4",
	type_match (mk_fun(tv1,mk_fun(tv2,tv1))),
	mk_fun(tv2,mk_fun(tv1,tv2)),
	[(tv2,tv1),(tv1,tv2)]),
	("type_match 5",
	type_match (mk_fun(tv2,mk_fun(tv2,tv2))),
	mk_fun(tv2,mk_fun(tv1,tv2)),
	[(tv2,tv1)])
	];

store_mt_results mt_run_fail [
	("type_match 3053 a",
	type_match BOOL,
	BN,
	gen_fail_msg "type_match" 3053 []),
	("type_match 3053 b",
	type_match BtoN,
	(mk_fun(tv1,tv1)),
	gen_fail_msg "type_match" 3053 []),
	("type_match 3053 c",
	type_match (mk_fun(BOOL,mk_fun(tv2,BN))),
	(mk_fun(tv1,mk_fun(tv2,tv1))),
	gen_fail_msg "type_match" 3053 [])
	];
=TEX
\subsubsection{term\_match}
=SML
store_mt_results mt_run [
	("term_match 1",
	term_match v1,
	v1,
	([],[])),
	("term_match 2",
	term_match v2,
	vtv1,
	([(mk_type("triple",[tv1,tv2,tv3]),tv1)],[(v2,
		mk_var("vtv1",mk_type("triple",[tv1,tv2,tv3])))])),
	("term_match 3",
	term_match (list_mk_comb (mk_const("trio",mk_fun(BOOL,mk_fun(tv2,
		mk_fun(tv3, (BOOL cross tv2))))),[v1, vtv2,vtv3])),
	list_mk_comb ((mk_const("trio",mk_fun(tv1,mk_fun(tv2,mk_fun(tv3, 
	(tv1 cross tv2)))))),
	[vtv1, vtv2,vtv3]),	
	([(BOOL, tv1)],[(v1, mk_var("vtv1",BOOL))])),
	("term_match 4",
	term_match (mk_eq(T,F)),
	mk_eq(v1,av1),
	([],[(F,av1),(T,v1)])),
	("term_match 5",
	term_match (mk_var("v",tv2)),
	mk_var("v",tv1),
	([(tv2,tv1)],[]))
	];

store_mt_results mt_run_fail [
	("term_match 3054 a",
	term_match T,
	F,
	gen_fail_msg "term_match" 3054 []),
	("term_match 3054 b",
	term_match a1,
	a2,
	gen_fail_msg "term_match" 3054 []),
	("term_match 3054 b",
	term_match (mk_eq(T,F)),
	mk_eq(v1,v1),
	gen_fail_msg "term_match" 3054 [])
	];
=TEX
\subsubsection{is\_type\_instance}
=SML
store_mt_results mt_run [
	("is_type_instance 1",
	is_type_instance tv1,
	BOOL,
	false),
	("is_type_instance 2",
	is_type_instance BOOL,
	tv1,
	true)
	];
=TEX
\subsubsection{mg\_variables}
=SML
store_mt_results mt_run [
	("mg_variables",
	mg_variables [BOOL, mk_fun(BOOL,tv1),tv1,BOOL],
	[mk_var("@_2",tv1), mk_var("@_1",mk_fun(tv1,BOOL)), 
	(list_mk_comb ((mk_const("@trio",mk_fun(tv1,mk_fun(tv2,mk_fun(tv3, 
	(tv1 cross tv2)))))),
	[vtv1, mk_var("@_4",tv2),vtv3])),
	mk_const("@_3",BOOL)],
	[mk_var("@_3",BOOL), mk_var("@_5",mk_fun(BOOL,tv1)),
		mk_var("@_6",tv1),mk_var("@_7",BOOL)])
	];
=TEX
\subsubsection{variant}
=SML
store_mt_results mt_run [
	("variant 1",
	variant [],
	vtv1,
	vtv1),
	("variant 2",
	variant [vtv1],
	vtv1,
	mk_var("vtv1'",tv1)),
	("variant 3",
	variant [(vtv1),(mk_var("vtv1'",tv1))],
	vtv1,
	mk_var("vtv1''",tv1)),
	("variant 4",
	variant [mk_var("vtv1",tv2)],
	vtv1,
	mk_var("vtv1'",tv1))
	];

store_mt_results mt_run_fail [
	("variant 3056",
	variant[],
	c1,
	gen_fail_msg "variant" 3056 []),
	("variant 3057",
	variant[c1],
	vtv1,
	gen_fail_msg "variant" 3057 [])
	];
=TEX
\subsubsection{list$\_$variant}
=SML
store_mt_results mt_run [
	("list_variant 1",
	list_variant [],
	[vtv1],
	[vtv1]),
	("list_variant 2",
	list_variant [vtv1],
	[vtv1,vtv1],
	[mk_var("vtv1'",tv1), mk_var("vtv1''",tv1)]),
	("list_variant 3",
	list_variant [(vtv1),(mk_var("vtv1'",tv1))],
	[vtv1],
	[mk_var("vtv1''",tv1)]),
	("list_variant 4",
	list_variant [mk_var("vtv1",tv2)],
	[vtv1],
	[mk_var("vtv1'",tv1)])
	];

store_mt_results mt_run_fail [
	("list_variant 3029",
	list_variant[],
	[c1],
	gen_fail_msg "list_variant" 3029 []),
	("list_variant 3057",
	list_variant[c1],
	[vtv1],
	gen_fail_msg "list_variant" 3057 [])
	];
=TEX
\subsubsection{is\_free\_in}
=SML
store_mt_results mt_run [
	("is_free_in 1",
	is_free_in vtv2,
	cm3,
	true),
	("is_free_in 2",
	is_free_in vtv2,
	simple_mk_abs(vtv2,cm3),
	false),
	("is_free_in 3",
	is_free_in vtv2,
	mk_comb(simple_mk_abs(vtv2,cm3), vtv2),
	true),
	("is_free_in 3",
	is_free_in vtv2,
	mk_eq(vtv2,vtv2),
	true)
	];

store_mt_results mt_run_fail [
	("is_free_in 3004",
	is_free_in c1,
	c1,
	gen_fail_msg "is_free_in" 3004 [])
	];

=TEX
\subsubsection{frees}
=SML
store_mt_results mt_run [
	("frees 1",
	frees,
	cm3,
	[vtv3, vtv2, vtv1]),
	("frees 2",
	frees,
	simple_mk_abs(vtv2,cm3),
	[vtv3, vtv1]),
	("frees 3",
	frees,
	mk_eq(vtv1,vtv1),
	[vtv1])
	];
=TEX
\subsubsection{var\_subst}
=SML
store_mt_results mt_run [
	("var_subst 1",
	var_subst [(T,v1)],
	c1,
	c1),
	("var_subst 2",
	var_subst [(T,v1)],
	v1,
	T),
	("var_subst 3",
	var_subst [(T,v1),(F,av1)],
	mk_eq(v1,av1),
	mk_eq(T,F)),
	("var_subst 4",
	var_subst [(T,v1),(F,v1)],
	mk_eq(v1,av1),
	mk_eq(T,av1)),
	("var_subst 5",
	var_subst [(T,v1),(F,av1)],
	simple_mk_„(v1,av1),
	simple_mk_„(v1,F)),
	("var_subst 6",
	var_subst [(T,v1),(F,av1)],
	simple_mk_„(v1,v1),
	simple_mk_„(v1,v1)),
	("var_subst 7",
	var_subst [(T,v1),(F,av1)],
	simple_mk_„(mk_var("v1",†),v1),
	simple_mk_„(mk_var("v1",†),T)),
	("var_subst 8",
	var_subst [(av1,v1)],
	simple_mk_„(mk_var("av1",†),v1),
	simple_mk_„(mk_var("av1'",†),av1))

	];

store_mt_results mt_run_fail [
	("var_subst 3012",
	var_subst [(T,vtv1)],
	c1,
	gen_fail_msg "var_subst" 3012 []),
	("var_subst 3060",
	var_subst [(T,c1)],
	c1,
	gen_fail_msg "var_subst" 3060 [])
	];
=TEX
\subsubsection{subst}
=SML
store_mt_results mt_run [
	("subst 1",
	subst [(T,v1)],
	c1,
	c1),
	("subst 2",
	subst [(T,v1)],
	v1,
	T),
	("subst 3",
	subst [(T,v1),(F,av1)],
	mk_eq(v1,av1),
	mk_eq(T,F)),
	("subst 4",
	subst [(T,v1),(F,v1)],
	mk_eq(v1,av1),
	mk_eq(T,av1)),
	("subst 5",
	subst [(T,v1),(F,av1)],
	simple_mk_„(v1,av1),
	simple_mk_„(v1,F)),
	("subst 6",
	subst [(T,v1),(F,av1)],
	simple_mk_„(v1,v1),
	simple_mk_„(v1,v1)),
	("subst 7",
	subst [(T,v1),(F,av1)],
	simple_mk_„(mk_var("v1",†),v1),
	simple_mk_„(mk_var("v1",†),T)),
	("subst 8",
	subst [(v1,mk_Š(T,F))],
	(list_mk_Š[T,F,T,F]),
	(list_mk_Š[T,F,v1])),
	("subst 9",
	subst [(v1,mk_Š(T,F))],
	simple_mk_abs(v1,list_mk_Š[T,F,T,F]),
	(simple_mk_abs(mk_var("v1'",BOOL),list_mk_Š[T,F,v1])))
	];

store_mt_results mt_run_fail [
	("subst 3027",
	subst [(T,vtv1)],
	c1,
	gen_fail_msg "subst" 3027 [])
	];
=TEX
\subsubsection{term\_map}
=SML
store_mt_results mt_run[
	("term_map",
	term_map replace_with_const,
	cm3,
	list_mk_comb(c6,[mk_const("rwc_vtv1",tv1),
		mk_const("rwc_vtv2",tv2),
		mk_const("rwc_vtv3",tv3)]))
	];
=TEX
\subsubsection{inst}
=SML
store_mt_results mt_run [
	("inst 1",
	inst [mk_var("av1",tv1),mk_var("av2",tv2)] [(BOOL,tv1),(tv1,tv2)],
	cm3,
	list_mk_comb(mk_const("c6", mk_fun(BOOL,mk_fun(tv1,
		mk_fun(tv3,mk_type("triple",[BOOL,tv1,tv3]))))),
		[mk_var("vtv1",BOOL),
		 mk_var("vtv2",tv1),
		vtv3])),
	("inst 2",
	inst [mk_var("vtv2",tv1),mk_var("av2",tv2)] [(BOOL,tv1),(tv1,tv2)],
	cm3,
	list_mk_comb(mk_const("c6", mk_fun(BOOL,mk_fun(tv1,
		mk_fun(tv3,mk_type("triple",[BOOL,tv1,tv3]))))),
		[mk_var("vtv1",BOOL),
		 mk_var("vtv2'",tv1),
		vtv3]))
	];

store_mt_results mt_run_fail [
	("inst 3057",
	inst [c1],
	[],
	gen_fail_msg "inst" 3057 []),
	("inst 3062",
	inst [],
	[(BOOL,BOOL)],
	gen_fail_msg "inst" 3062 [])
	];
=TEX
\subsection{term$\_$fail}
This will fail if the pretty-printer is not yet installed.
=SML
store_mt_results mt_run_fail [
	("term_fail",
	term_fail "term_fail" 3001,
	[mk_eq(T,F)],
	gen_fail_msg "term_fail" 3001 ["»T ‚ F¼"])
	];

=TEX
\subsection{type$\_$fail}
This will fail if the pretty-printer is not yet installed.
=SML
store_mt_results mt_run_fail [
	("type_fail",
	type_fail "type_fail" 3001,
	[BtoN],
	gen_fail_msg "type_fail" 3001 ["»:BOOL ‹ †¼"])
	];

=TEX
\subsection{End of Tests}
=SML
summarize_mt_results ();
(* PolyML.quit(); *)
=TEX
\end{document}
