=TEX
\documentstyle[hol,11pt,TQ]{article}
\ftlinepenalty=9999
\makeindex
\TPPproject{FST PROJECT}  %% Mandatory field
\TPPtitle{Implementation of Tactics II}
\TPPref{DS/FMU/IED/IMP)28}  %% Mandatory field
\def\SCCSversion{$Revision$
}
\TPPissue{\SCCSversion}  %% Mandatory field
\TPPdate{\FormatDate{91/03/11 %
}}  %% Mandatory field
\TPPstatus{Draft}			%% Mandatory field
\TPPtype{SML Literate Script}
\TPPkeywords{}
\TPPauthor{R.D. Arthan & WIN01}  %% Mandatory field
%\TPPauthors{Name 1&location 1\\Name 2&location 2\\Name 3&location 3}
\TPPauthorisation{R.D.Arthan & FST Team Leader}
\TPPabstract{This document gives a detailed design for the 
first group of tactics and tacticals in ICL HOL.}
\TPPdistribution{\parbox[t]{4.0in}{%
	    Project Library
}}
%\TPPclass{CLASSIFICATION}
%\def\TPPheadlhs{}
%\def\TPPheadcentre{}
%def\TPPheadrhs{}
%\def\TPPfootlhs{}
%\def\TPPfootcentre{}
%\def\TPPfootrhs{}
\begin{document}
\makeTPPfrontpage
\vfill
\begin{centering}
\bf Copyright \copyright\ : International Computers Ltd \number\year
\end{centering}
\pagebreak
\section{Document control}
\subsection{Contents list}
\tableofcontents
\subsection{Document cross references}
\bibliographystyle{fmu}
\bibliography{fmu}

\subsection{Changes history}
\begin{description}
\item [Issue \SCCSversion (\FormatDate{$Date$%
})]
First draft version.
\end{description}
\subsection{Changes forecast}
None.
\section{GENERAL}
\subsection{Scope}
This document contains the implementation for material
whose detailed design is given in in \cite{DS/FMU/IED/DTD028}.
\subsection{Introduction}
\subsubsection{Purpose and Background}

\subsubsection{Dependencies}

\subsubsection{Deficiencies}
\section{PREAMBLE}
=SML
structure âTactics2á : Tactics1 = struct
=TEX
=SML
end; (* of structure Tactics2 *)
open Tactics2;
=TEX
\section{CONCERNING $T$}
=SML
val ât_tacá : TACTIC = accept_tac t_thm;
=TEX
=SML
val mk_t = »T:BOOL¼;
val mk_f = »F:BOOL¼;
=TEX
=SML
val â‚_t_tacá : TACTIC = (fn (asms, conc) => 
	let	val (lhs, rhs) = dest_eq conc;
	in	if rhs = mk_t
		then	([(asms, lhs)],
			 fn [th] => ‚_t_intro th | _ => bad_proof "‚_t_tac")
		else if lhs = mk_t
		then	([(asms, rhs)],
			 fn [th] => eq_sym_rule(‚_t_intro th) | _ => bad_proof "‚_t_tac")
		else term_fail "‚_t_tac" 28001 [conc]
	end	handle Fail _ => term_fail "‚_t_tac" 28001 [conc]
);
=TEX
\section{CONCERNING $F$)
=SML
val âcontr_tacá : TACTIC = (fn (asms, conc) => 
	([(asms, mk_f)],
	 fn [th] => contr_rule conc th | _ => bad_proof "‚_t_tac")
);
=TEX
=SML
fun  âC_CONTR_Tá (thmtac : THM -> TACTIC) : TACTIC = (fn gl as (asms, conc) =>
	let	val Œ_conc = mk_Œ conc;
		val (sgs, pf) = REMOVED_ASMS_T [Œ_conc] (thmtac (asm_rule Œ_conc)) (asms, mk_f);
		fun rule thm = (
			if Œ_conc asm_mem (hyps thm)
			then c_contr_rule conc thm
			else contr_rule Œ_conc thm
		);
	in	(sgs, rule o pf)
	end
);
=TEX
\section{CONCERNING NEGATION}
=TEX
=SML
fun  âŒ_INTRO2_Tá (t1 : TERM)
	(thmtac1 : THM -> TACTIC) (thmtac2 : THM -> TACTIC)
		: TACTIC = (fn gl as (asms, conc) =>
	let	val t2 = (dest_Œ conc)
			handle Fail _ => fail "Œ_INTRO2_T" 28003 [];
		val Œ_t1 = (mk_Œ t1)
			handle Fail _ => term_fail "Œ_INTRO2_T" 28002 [t1];
		val (sgs1, pf1) = REMOVED_ASMS_T [t2] (thmtac1 (asm_rule t2)) (asms, t1);
		val (sgs2, pf2) = REMOVED_ASMS_T [t2] (thmtac2 (asm_rule t2)) (asms, Œ_t1);
		fun rule [thm1, thm2] = Œ_intro t2 thm1 thm2
		|   rule _ = bad_proof "Œ_INTRO2_T";
	in	(sgs1 @ sgs2, rule o mapshape[(pf1, length sgs1), (pf2, length sgs2)])
	end	
);

=TEX
\twocolumn[\section{INDEX}]
\small
\printindex
\end{document}

=IGN
val a = asm_rule»a:BOOL¼;
val b = asm_rule»b:BOOL¼;
val c = asm_rule»c:BOOL¼;
val ab = €_intro a b;
val abc = €_intro ab c;

val t = list_prove_asm_rule [c, b, a] abc;


val gl : GOAL =  ([»b:BOOL¼, »a:BOOL¼], »a € b:BOOL¼);

accept_tac ab gl;

