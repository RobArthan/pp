=TEX
\documentstyle[hol,11pt,TQ]{article}
\ftlinepenalty=9999
\makeindex
\TPPproject{FST}  %% Mandatory field
%\TPPvolume{}
%\TPPpart{}
\TPPtitle{Release 1 ICL HOL: Module Tests for Nets}  %% Mandatory field
\def\TPPheadtitle{Release 1 ICL HOL \cr Module Tests for Nets}
\TPPref{DS/FMU/IED/MDT008}  %% Mandatory field
\def\SCCSversion{$Revision$ %
}
\TPPissue{\SCCSversion}  %% Mandatory field
\TPPdate{\FormatDate{$Date$ %
}}
\TPPstatus{Draft}			%% Mandatory field
\TPPtype{SML Literate Script}
\TPPkeywords{}
\TPPauthor{K.Blackburn & WIN01}  %% Mandatory field
%\TPPauthors{Name 1&location 1\\Name 2&location 2\\Name 3&location 3}
\TPPauthorisation{R.D.Arthan & Project Manager}
\TPPabstract{A set of module tests are given for the net tools.}
\TPPdistribution{\parbox[t]{4.0in}{%
	    Library
}}
\begin{document}
\makeTPPfrontpage
\vfill
\begin{centering}
\bf Copyright \copyright\ : International Computers Ltd \number\year
\end{centering}
\pagebreak
\section{Document control}
\subsection{Contents list}
\tableofcontents
\subsection{Document cross references}
\bibliographystyle{fmu}
\bibliography{fmu}

\subsection{Changes history} 
\begin{description}
\item [Issue 1.1]
First draft version.
\end{description}
%\subsection{Changes forecast}
\section{GENERAL}
\subsection{Scope}
This document contains the module testing of the net tools.
The design and test policy is in \cite{DS/FMU/IED/DTD008}
and the design is
implemented in \cite{DS/FMU/IED/IMP008}.

\subsection{Introduction}
\subsubsection{Purpose and Background}
This document contains the module testing of the material given a design in \cite{DS/FMU/IED/DTD008},
following the test policy given in that document and the general policy given in \cite{DS/FMU/IED/PLN008}.

\subsubsection{Dependencies}
This document is derived from the detailed design in \cite{DS/FMU/IED/DTD008},
and is further influenced by the implementation, in  \cite{DS/FMU/IED/IMP008}.
\subsubsection{Deficiencies}
The coverage of the tests, as called for by the test specification, may currently be incomplete.

\section{UTILITIES USED FOR TESTING}
=SML
open NetTools;
=TEX
Enter a list of entries:
=SML
fun list_enter ((tmc : TERM * int) :: rest) (net: int NET) = list_enter rest(enter tmc net)
| list_enter [] net = net;
=TEX
\section{THE TESTS}
=SML
val NUM = mk_type("NUM",[]);
val tv1 = mk_vartype "'tv1";
val tv2 = mk_vartype "'tv2";
val tv3 = mk_vartype "'tv3";
val vtv1 = mk_var("v1", tv1);
val vtv2 = mk_var("v2", tv2);
val vtv3 = mk_var("v3", tv3);

val c1 = mk_const("c1",BOOL);
val c6 = mk_const("c6",mk_fun(tv1,mk_fun(tv2,mk_fun(tv3,
	mk_type("triple",[tv1,tv2,tv3])))));
val cm1 = mk_comb(c6,vtv1);
val cm2 = mk_comb(cm1,vtv2);
val cm3 = mk_comb(cm2,vtv3);
val a1 = mk_simple_abs(vtv1, cm3);
val a2 = mk_simple_abs(vtv2,vtv2);
val cm4 = list_mk_comb (c6, [vtv1,vtv2,mk_const("c",tv3)]);
=TEX
A test net:
=SML
val net1 = list_enter [(c1, 1), (vtv1, 2), (cm3,3), (cm1, 4), (a1, 5), (a2, 6),
	(cm4,7), (cm3,8)] empty;
=TEX
Some lookups on the list, the expected result is given in a comment
after each lookup.
From these results we can check the ordering behaviour of $lookup$.
=SML
lookup net1 c1; (* [1,2] *)
lookup net1 vtv1; (* [2] *)
lookup net1 cm3; (* [8,3,2] *)
lookup net1 cm1; (* [4,2] *)
lookup net1 a1; (* [5,6,2] *)
lookup net1 a2; (* [6,2] *)
lookup net1 cm4; (* [7,8,3,2] *)
lookup net1 (mk_var("n",NUM)); (* [2] *)
lookup net1 (mk_const("c",NUM)); (* [2] *)
lookup net1 (mk_const("c1",NUM)); (* [1,2] *)
lookup net1 (mk_simple_abs(vtv2,vtv1)); (* [6,2] *)
lookup net1 (mk_simple_abs(vtv2,cm3)); (* [5,6,2] *)
lookup net1 (mk_simple_abs(vtv2,mk_comb(cm2,mk_const("c",tv3)))); (* [5,6,2] *)
lookup net1 (mk_simple_abs(vtv2,cm4)); (* [5,6,2] *)
lookup net1 (mk_simple_abs(vtv2,cm2)); (* [6,2] *)
lookup net1 cm2; (* [2] *)
lookup net1 (list_mk_comb ((mk_const ("c",type_of c6)), [vtv1,vtv2,vtv3])); (* [2] *)
=TEX
=SML
lookup empty a1; (* [] *)
lookup (enter (cm1,1) empty) a1; (* [] *)
lookup (enter (cm1,1) empty) cm1; (* [1] *)
=TEX
\end{document}
