=TEX
\documentstyle[hol,11pt,TQ]{article}
\ftlinepenalty=9999
\makeindex
\TPPproject{FST PROJECT}  %% Mandatory field
\TPPtitle{Implementation of Proof Contexts}
\TPPref{DS/FMU/IED/IMP051}  %% Mandatory field
\def\SCCSversion{$Revision$
}
\TPPissue{\SCCSversion}  %% Mandatory field
\TPPdate{\FormatDate{$Date$ %
}}  %% Mandatory field
\TPPstatus{Draft}			%% Mandatory field
\TPPtype{SML Literate Script}
\TPPkeywords{}
\TPPauthor{K.BLackburn & WIN01}  %% Mandatory field
%\TPPauthors{Name 1&location 1\\Name 2&location 2\\Name 3&location 3}
\TPPauthorisation{R.D.Arthan & FST Team Leader}
\TPPabstract{This document gives an implementation providing proof contexts.}
\TPPdistribution{\parbox[t]{4.0in}{%
	    Project Library
}}
%\TPPclass{CLASSIFICATION}
%\def\TPPheadlhs{}
%\def\TPPheadcentre{}
%def\TPPheadrhs{}
%\def\TPPfootlhs{}
%\def\TPPfootcentre{}
%\def\TPPfootrhs{}
\begin{document}
\makeTPPfrontpage
\vfill
\begin{centering}
\bf Copyright \copyright\ : International Computers Ltd \number\year
\end{centering}
\pagebreak
\section{Document Control}
\subsection{Contents List}
\tableofcontents
\subsection{Document Cross References}
\bibliographystyle{fmu}
\bibliography{fmu}

\subsection{Changes History}
\begin{description}
\item [Issue 1.1 (25 October)]
First draft version.
\end{description}
\subsection{Changes Forecast}
As detailed design.
\section{GENERAL}
\subsection{Scope}
This document contains the implementation for material
whose detailed design is given in in \cite{DS/FMU/IED/DTD051}.
It is module tested in \cite{DS/FMU/IED/MDT051}
\subsection{Introduction}
\subsubsection{Purpose and Background}
A proof context is a setting of various configurable
parameters of proof tools to support a particular mode of proof.
For instance, both $rewrite\_tac$ and $strip\_tac$ 
are configurable proof tools.
In particular, proof contexts will be later made available,
through the tools supplied here,
that supply a good environment to reason about Z,
or within a particular theory (e.g. set theory),
and alter the default environment.

\subsubsection{Dependencies}
This document is dependent on \cite{DS/FMU/IED/DTD051}.
\subsubsection{Deficiencies}
None known.
\subsubsection{Possible Enhancements}
As detailed design.
\section{PREAMBLE}
=SML
structure âProofContextá : ProofContext = struct
=TEX
\section{UTILITIES}
=TEX
\section{TYPES}
=SML
type âPROOF_CONTEXTá = {
	rw_eqn_cxt: (TERM * CONV)list,	(* EQN_CXT *)
	rw_canon: THM -> THM list,	(* CANON *)
	sa_eqn_cxt: (TERM * CONV)list,	(* EQN_CXT *)
	sg_eqn_cxt: (TERM * CONV)list	(* EQN_CXT *)}; 
=TEX
=SML
type âEPROOF_CONTEXTá = {
	rw_net: CONV NetTools.NET,
	rw_canon: THM -> THM list,	(* CANON *)
	sa_conv: CONV,
	sg_conv: CONV}; 
=TEX
\section{CODE}
The following is the (hidden) current proof context,
and proof context stack,
manipulated by the following visible functions.
=SML
val âcurrent_proof_contextá : EPROOF_CONTEXT ref = (ref {
		rw_net = NetTools.empty,
		rw_canon = (fn thm => [thm]),
		sa_conv = id_conv,
		sg_conv = id_conv}
);

val âproof_context_stacká : (EPROOF_CONTEXT list) ref = ref [];
=TEX
=SML
fun âget_proof_contextá () : EPROOF_CONTEXT = (!current_proof_context);

fun âpush_proof_contextá (pc : EPROOF_CONTEXT) : unit = (
	proof_context_stack := (!current_proof_context) :: (!proof_context_stack);
	current_proof_context := pc;
	()
);
fun âpop_proof_contextá () : EPROOF_CONTEXT = (
let	val cpc = (!current_proof_context);
	val (top, rest) = case (!proof_context_stack) of
		[] => fail "pop_proof_context" 51001 []
		| (head :: tail) => (head, tail);
in
	(current_proof_context := top;
	proof_context_stack := rest;
	cpc)
end);
=TEX		
\section{END OF SIGNATURE}
=SML
end; (* of structure ProofContext *)
open ProofContext;
=TEX
\twocolumn[\section{INDEX}]
\small
\printindex
\end{document}
=SML
