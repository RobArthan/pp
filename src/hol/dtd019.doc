%  dtd019.doc %Z% $Date$ $Revision$ $RCSfile$
=TEX
% TQtemplate.tex
\documentstyle[hol,11pt,TQ]{article}
\ftlinepenalty=9999
\def\Hide#1{}
\def\Bool{``$\it{:}bool\,$''}
\makeindex
\TPPproject{FST PROJECT}  %% Mandatory field
%\TPPvolume{}
%\TPPpart{}
\TPPtitle{Detailed Design for ICL HOL Parser}  %% Mandatory field
\TPPref{DS/FMU/IED/DTD019}  %% Mandatory field
\def\SCCSversion{$Revision$%
}
\TPPissue{\SCCSversion}  %% Mandatory field
\TPPdate{\FormatDate{$Date$%
}}
\TPPstatus{Approved}
%\TPPstatus{Draft}
\TPPtype{Specification}
\TPPkeywords{HOL}
\TPPauthor{R.D.~Arthan & WIN01}  %% Mandatory field
%\TPPauthors{Name 1&location 1\\Name 2&location 2\\Name 3&location 3}
\TPPauthorisation{R.B. Jones & HAT Manager}
\TPPabstract{
This document contains the detailed design for the
parser for ICL HOL.}
%\TPPabstractB{}
%\TPPabstractC{}
%\TPPabstractD{}
%\TPPabstractE{}
%\TPPabstractF{}
\TPPdistribution{\parbox[t]{4.0in}{%
	Library}}

%\TPPclass{CLASSIFICATION}
%\def\TPPheadlhs{}
%\def\TPPheadcentre{}
%def\TPPheadrhs{}
%\def\TPPfootlhs{}
%\def\TPPfootcentre{}
%\def\TPPfootrhs{}

\begin{document}
\TPPsetsizes
\makeTPPfrontpage

\vfill
\begin{centering}

\bf Copyright \copyright\ : International Computers Ltd \number\year

\end{centering}

\newpage
\section{DOCUMENT CONTROL}
\subsection{Contents List}
\tableofcontents
\subsection{Document Cross References}
\bibliographystyle{fmu}
\bibliography{fmu}

\subsection{Changes History}  % to get section number `0.3'
\begin{description}
\item[Issues 1.1 to 1.7 ] Initial drafts.
\item[Issue 2.1 (\FormatDate{91/09/11}) ] First approved version.
\end{description}
\subsection{Changes Forecast}
None.
\pagebreak
\section{GENERAL}
\subsection{Scope}
This document contains the detailed design for the parser for ICL HOL
as required in \cite{DS/FMU/IED/HLD008}.

\subsection{Introduction}

\subsubsection{Purpose and Background}

This document gives the detailed design for the parser for ICL HOL.
Of course, the interface specification is quite simple. The parser is
essentially a complex black box. It is actually to be implemented using
the SLRP parser generator, see \cite{DS/FMU/IED/DTD017} using a grammar
based on that specified in \cite{DS/FMU/IED/DEF001}.

\subsubsection{Dependencies}
The parser is dependent on the lexical analyser, \cite{DS/FMU/IED/DTD015}, 
and on the symbol table, \cite{DS/FMU/IED/DTD020}.
%\subsubsection{Possible Enhancements}
\subsubsection{Deficiencies}
None known.
\subsection{PREAMBLE}
=DOC
signature âParserá = sig
=DESCRIBE
This is the signature for the structure containing the parser for ICL HOL.
=ENDDOC
=SML
local
	open	Lex
in
=TEX
\section{DATA TYPES}
=TEX
The first phase of the parser will return a value of type $TM$ defined
as follows
(in which we remember fixity and bracketing solely for the purposes of error messages).
=DOC
datatype âTYá	=	âTyAtomá of string
		|	âTyCompoundá of (TY list) * string * FIXITY
		|	âTyAqá of TYPE;

datatype ('ty) âTMá	=	âBinderá of string * ('ty)TM * ('ty)TM 
		|	âLetá of (('ty)TM * ('ty)TM) list * ('ty)TM
		|	âCondá of  ('ty)TM * ('ty)TM * ('ty)TM
		|	âAppá of ('ty)TM * ('ty)TM * FIXITY
		|	âTmTypedá of ('ty)TM * 'ty
		|	âTmAqá of TERM
		|	âSetDisplayá of ('ty)TM list
		|	âSetComprehensioná of ('ty)TM * ('ty)TM
		|	âListDisplayá of ('ty)TM list
		|	âIdá of string
		|	âCharLitá of string
		|	âStringLitá of string
		|	âNumLitá of int;
=DESCRIBE
These datatypes are used for communication between the parser and the
type checker.
=ENDDOC

The $FIXITY$ fields help to preserve a little more of the structure
of the input HOL text for purposes of error messages.

=TEX
\section{FORMATTING UTILITIES}
=DOC
	val âformat_tmá  : ('ty -> string) -> ('ty) TM -> string 
	val âformat_tyá  : TY -> string 
=DESCRIBE
These utilities are used to format the datatypes $('ty)TM$ and
$TY$ which are used to communicate between the parser and the
type checker.
=ENDDOC
\section{INTERFACE}
=DOC
	val âHOL_parserá : HOL_TOKEN list -> (TY)TM
=DESCRIBE
This is the context-free parser for HOL. It maps the lists of
tokens output by the lexical analyser onto the datatype used as input
to the type inferrer.

If an error is detected in the parsed input some combination of
messages 17001, 17002 and 17004 below is printed and then an exception
with error message 17000 is reported. Messages 17005, 17006 and 17007 indicate
an error in the parser itself.
=FAILURE
17000	syntax error in quotation
17001	"*** SYNTAX ERROR  ****"
17002	"?0 is not a valid variable or varstruct"
17004	"?0 is not a valid local definition"
17005	"parser error: corrupt parsing stack detected in ?0"
17006	"parser error: unexpected return value from slrp'gen_parser"
17007	"parser error: ?0"
=ENDDOC
=SML
end; (* of local ... in ... end *)
end; (* of signature Parser *)
=TEX
\section{TEST POLICY}
The functions in this document are to be tested according to the
criteria identified in \cite{DS/FMU/IED/PLN008}.

\small
\twocolumn[\section{INDEX}]
\printindex

\end{document}
