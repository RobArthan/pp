=TEX
\documentstyle[hol,11pt,TQ]{article}
\ftlinepenalty=9999
\makeindex
\TPPproject{FST}  %% Mandatory field
%\TPPvolume{}
%\TPPpart{}
\TPPtitle{Module Tests for Derived Terms}  %% Mandatory field
\def\TPPheadtitle{Module Tests for Derived Terms}
\TPPref{DS/FMU/IED/MDT004}  %% Mandatory field
\def\SCCSversion{$Revision$ %
}
\TPPissue{\SCCSversion}  %% Mandatory field
\TPPdate{\FormatDate{$Date$ %
}}
\TPPstatus{Draft}			%% Mandatory field
\TPPtype{SML Literate Script}
\TPPkeywords{}
\TPPauthor{K.Blackburn & WIN01}  %% Mandatory field
%\TPPauthors{Name 1&location 1\\Name 2&location 2\\Name 3&location 3}
\TPPauthorisation{R.D.Arthan & Project Manager}
\TPPabstract{A set of module tests are given for the derived term functions.}
\TPPdistribution{\parbox[t]{4.0in}{%
	    Library
}}
\begin{document}
\makeTPPfrontpage
\vfill
\begin{centering}
\bf Copyright \copyright\ : International Computers Ltd \number\year
\end{centering}
\pagebreak
\section{Document control}
\subsection{Contents list}
\tableofcontents
\subsection{Document cross references}
\bibliographystyle{fmu}
\bibliography{fmu}

\subsection{Changes history} 
\begin{description}
\item [Issue 1.1]
First draft version.
\item [Issue 1.2]
Changed to reflect changes in  issue 1.5 of \cite{DS/FMU/IED/DTD004}.
\item [Issue 1.3]
Changed to reflect changes in  issue 1.6 of \cite{DS/FMU/IED/DTD004}.
\item [Issue 1.4]
Changed to reflect changes in  issue 1.7 of \cite{DS/FMU/IED/IMP004}.
\item [Issue 1.5]
Changed to reflect changes in  issue 1.8 of \cite{DS/FMU/IED/IMP004}.
\item [Issue 1.6]
Changed to reflect changes in  issue 1.9 of \cite{DS/FMU/IED/IMP004}.
\item [Issue 1.7]
Changed to use material from \cite{DS/FMU/IED/DTD013}.
\end{description}
%\subsection{Changes forecast}
\section{GENERAL}
\subsection{Scope}
This document contains the module testing of the derived term functions, required by Release 1 ICL HOL Product Requirement Specification \cite{DS/FMU/IED/DEF004}.
The design is in \cite{DS/FMU/IED/DTD004}
and it is
implemented in \cite{DS/FMU/IED/IMP004}.

\subsection{Introduction}
\subsubsection{Purpose and Background}
This document contains the module testing of the material given a design in \cite{DS/FMU/IED/DTD004},
following the test policy given in that document and the general policy given in \cite{DS/FMU/IED/PLN008}.

The tests use the test harness of \cite{DS/FMU/IED/DTD013}.
\subsubsection{Dependencies}
This document is derived from the detailed design in \cite{DS/FMU/IED/DTD004},
and is further influenced by the implementation, in  \cite{DS/FMU/IED/IMP004}.
\subsubsection{Deficiencies}
The coverage of the tests, as called for by the test specification, may currently be incomplete.
\section{INITIALISATION}
Initialise the test package:
=SML
usefile "dtd013.sml";
usefile "imp013.sml";
init_mt_results();
=TEX
\section{VALUE BINDINGS}
=SML
val tv1 = mk_vartype "'tv1";
val tv2 = mk_vartype "'tv2";
val tv3 = mk_vartype "'tv3";
val v1 = mk_var("v1", tv1);
val v2 = mk_var("v2", tv2);
val v3 = mk_var("v3", tv3);
val c1 = mk_const("c1",BOOL);
val c2 = mk_const("c2",mk_type("triple",[tv1,tv2,tv3]));
val cv1 = mk_const("cv1",tv1);
val v11 = mk_var("v11",BOOL);
val cp1 = mk_const("cp1",mk_pair_type(tv1, BOOL));
val cv2 = mk_const("cv2",tv2);
val f = mk_var("f",mk_fun(BOOL,BOOL));
=TEX
\section{THE TESTS}
The $?\_binder$, $?\_binop$, etc, functions will be considered
tested by the functions they are used to implement.
\subsection{Boolean Constants}
=SML
store_mt_results mt_run [ 
	("mk_t",
	Combinators.I,
	mk_t,
	mk_const("T",BOOL)),
	("mk_f",
	Combinators.I,
	mk_f,
	mk_const("F",BOOL))
	];
store_mt_results mt_run [ 
	("is_t 1",
	is_t,
	mk_t,
	true),
	("is_t 2",
	is_t,
	mk_f,
	false),
	("is_f 1",
	is_f,
	mk_t,
	false),
	("is_f 2",
	is_f,
	mk_f,
	true)
	];
=TEX
\subsection{Specific Constructor Functions}
\subsubsection{Pairs}
=SML
store_mt_results mt_run [ 
	("mk_pair_type",
	mk_pair_type,
	(BOOL, Ü),
	mk_type("â",[BOOL, Ü]))
	];
store_mt_results mt_run [ 
	("mk_pair",
	mk_pair,
	(c1, c2),
	list_mk_comb(mk_const(",",mk_fun(type_of c1,mk_fun(type_of c2,
		mk_pair_type(type_of c1,type_of c2)))),
		[c1,c2]))
	];
store_mt_results mt_run [ 
	("dest_pair",
	dest_pair,
	mk_pair(c1,c2),
	(c1,c2))
	];
store_mt_results mt_run_fail [
	("dest_pair 4003",
	dest_pair,
	c1,
	gen_fail_msg "dest_pair" 4003 [])
	];
store_mt_results mt_run [ 
	("is_pair 1",
	is_pair,
	c1,
	false),
	("is_pair 2",
	is_pair,
	mk_pair(c1,c2),
	true)
	];
=TEX
\subsubsection{General Abstractions}
=SML
store_mt_results mt_run [ 
	("mk_abs 1",
	mk_abs,
	(v1, c1),
	simple_mk_abs(v1, c1)),
	("mk_abs 2",
	mk_abs,
	(mk_pair(v1,v2), c1),
	mk_comb(mk_const("Uncurry",mk_fun(mk_fun(tv1,mk_fun(tv2,BOOL)),
		mk_fun(mk_pair_type(tv1,tv2),BOOL))),
		simple_list_mk_abs([v1,v2], c1)))
	];
store_mt_results mt_run_fail [
	("mk_abs 4001",
	mk_abs,
	(c1,c1),
	gen_fail_msg "mk_abs" 4001 [])
	];

store_mt_results mt_run [ 
	("dest_abs 1",
	dest_abs,
	mk_abs(v1, v1),
	(v1, v1)),
	("dest_abs 2",
	dest_abs,
	mk_abs(mk_pair(v1,v2), v1),
	(mk_pair(v1,v2), v1)),
	("dest_abs 3",
	dest_abs,
	mk_abs(mk_pair(mk_pair(v1,v2), mk_pair(v2,v3)), v2),
	(mk_pair(mk_pair(v1,v2), mk_pair(v2,v3)), v2))
	];

store_mt_results mt_run_fail [
	("dest_abs 4002",
	dest_abs,
	c1,
	gen_fail_msg "dest_abs" 4002 [])
	];
store_mt_results mt_run [ 
	("list_mk_abs",
	list_mk_abs,
	([mk_pair(v1,v2),v3],c1),
	mk_abs (mk_pair(v1,v2),mk_abs(v3,c1)))
	];
store_mt_results mt_run_fail [
	("list_mk_abs 4001",
	list_mk_abs,
	([c1],c1),
	gen_fail_msg "mk_abs" 4001 [])
	];
store_mt_results mt_run [ 
	("strip_abs",
	strip_abs,
	list_mk_abs([mk_pair(v1,v2),v3],c1),
	([mk_pair(v1,v2),v3],c1))
	];
store_mt_results mt_run [ 
	("is_abs",
	is_abs,
	list_mk_abs([mk_pair(v1,v2),v3],c1),
	true),
	("is_abs",
	is_abs,
	simple_mk_abs(v1,v1),
	true),
	("is_abs",
	is_abs,
	c1,
	false)
	];
=TEX
\subsubsection{Conjunctions}
=SML
store_mt_results mt_run [ 
	("mk_Ä",
	mk_Ä,
	(mk_t,mk_f),
	list_mk_comb(mk_const("Ä",mk_fun(BOOL,mk_fun(BOOL,BOOL))),[mk_t,mk_f]))
	];
store_mt_results mt_run_fail [
	("mk_Ä 4022",
	mk_Ä,
	(c2,mk_f),
	gen_fail_msg "mk_Ä" 4022 [])
	];
store_mt_results mt_run [ 
	("dest_Ä",
	dest_Ä,
	mk_Ä(mk_t,mk_f),
	(mk_t,mk_f))
	];
store_mt_results mt_run_fail [
	("dest_Ä 4032",
	dest_Ä,
	c1,
	gen_fail_msg "dest_Ä" 4032 [])
	];
store_mt_results mt_run [ 
	("is_Ä 1",
	is_Ä,
	c1,
	false),
	("is_Ä 2",
	is_Ä,
	mk_Ä(mk_t,mk_f),
	true)
	];
store_mt_results mt_run_fail [
	("list_mk_Ä 3017",
	list_mk_Ä,
	[],
	gen_fail_msg "list_mk_Ä" 3017 []),
	("list_mk_Ä 4025",
	list_mk_Ä,
	[c2, mk_t],
	gen_fail_msg "list_mk_Ä" 4025 [])
	];
store_mt_results mt_run [ 
	("list_mk_Ä",
	list_mk_Ä,
	[mk_t,mk_f,c1],
	mk_Ä(mk_t,mk_Ä(mk_f,c1)))
	];
store_mt_results mt_run [ 
	("strip_Ä 1",
	strip_Ä,
	c2,
	[c2]),
	("strip_Ä 2",
	strip_Ä,
	list_mk_Ä[mk_t,mk_f,c1],
	[mk_t,mk_f,c1])
	];
=TEX
\subsubsection{Disjunctions}
=SML
store_mt_results mt_run [ 
	("mk_Å",
	mk_Å,
	(mk_t,mk_f),
	list_mk_comb(mk_const("Å",mk_fun(BOOL,mk_fun(BOOL,BOOL))),[mk_t,mk_f]))
	];
store_mt_results mt_run_fail [
	("mk_Å 4026",
	mk_Å,
	(c2,mk_f),
	gen_fail_msg "mk_Å" 4026 [])
	];
store_mt_results mt_run [ 
	("dest_Å",
	dest_Å,
	mk_Å(mk_t,mk_f),
	(mk_t,mk_f))
	];
store_mt_results mt_run_fail [
	("dest_Å 4027",
	dest_Å,
	c1,
	gen_fail_msg "dest_Å" 4027 [])
	];
store_mt_results mt_run [ 
	("is_Å 1",
	is_Å,
	c1,
	false),
	("is_Å 2",
	is_Å,
	mk_Å(mk_t,mk_f),
	true)
	];
store_mt_results mt_run_fail [
	("list_mk_Å 3017",
	list_mk_Å,
	[],
	gen_fail_msg "list_mk_Å" 3017 []),
	("list_mk_Å 4025",
	list_mk_Å,
	[c2, mk_t],
	gen_fail_msg "list_mk_Å" 4025 [])
	];
store_mt_results mt_run [ 
	("list_mk_Å",
	list_mk_Å,
	[mk_t,mk_f,c1],
	mk_Å(mk_t,mk_Å(mk_f,c1)))
	];
store_mt_results mt_run [ 
	("strip_Å 1",
	strip_Å,
	c2,
	[c2]),
	("strip_Å 2",
	strip_Å,
	list_mk_Å[mk_t,mk_f,c1],
	[mk_t,mk_f,c1])
	];
=TEX
\subsubsection{Negations}
=SML
store_mt_results mt_run [ 
	("mk_å",
	mk_å,
	mk_t,
	mk_comb(mk_const("å",mk_fun(BOOL,BOOL)),mk_t))
	];
store_mt_results mt_run_fail [
	("mk_å 4028",
	mk_å,
	c2,
	gen_fail_msg "mk_å" 4028 [])
	];
store_mt_results mt_run [ 
	("dest_å",
	dest_å,
	mk_å mk_t,
	mk_t)
	];
store_mt_results mt_run_fail [
	("dest_å 4029",
	dest_å,
	c1,
	gen_fail_msg "dest_å" 4029 [])
	];
store_mt_results mt_run [ 
	("is_å 1",
	is_å,
	mk_t,
	false),
	("is_å 2",
	is_å,
	mk_å mk_t,
	true)
	];
=TEX
\subsubsection{Bi-implications}
(Notice how the constant name is ``='')
=SML
store_mt_results mt_run [ 
	("mk_Ç",
	mk_Ç,
	(mk_t,mk_f),
	list_mk_comb(mk_const("=",mk_fun(BOOL,mk_fun(BOOL,BOOL))),[mk_t,mk_f]))
	];
store_mt_results mt_run_fail [
	("mk_Ç 4030",
	mk_Ç,
	(c2,mk_f),
	gen_fail_msg "mk_Ç" 4030 [])
	];
store_mt_results mt_run [ 
	("dest_Ç",
	dest_Ç,
	mk_Ç(mk_t,mk_f),
	(mk_t,mk_f))
	];
store_mt_results mt_run_fail [
	("dest_Ç 4031",
	dest_Ç,
	c1,
	gen_fail_msg "dest_Ç" 4031 [])
	];
store_mt_results mt_run [ 
	("is_Ç 1",
	is_Ç,
	c1,
	false),
	("is_Ç 2",
	is_Ç,
	mk_Ç(mk_t,mk_f),
	true)
	];
=TEX
\subsubsection{Conditionals}
=SML
store_mt_results mt_run [ 
	("mk_if",
	mk_if,
	(c1,mk_t,mk_f),
	list_mk_comb(mk_const("Cond",mk_fun(BOOL,mk_fun(BOOL,mk_fun(BOOL,BOOL)))),
		[c1,mk_t,mk_f]))
	];
store_mt_results mt_run_fail [
	("mk_if 4004",
	mk_if,
	(c2,mk_t,mk_f),
	gen_fail_msg "mk_if" 4004 []),
	("mk_if 4004",
	mk_if,
	(mk_t,mk_t,c2),
	gen_fail_msg "mk_if" 4005 [])
	];
store_mt_results mt_run [ 
	("dest_if",
	dest_if,
	mk_if(c1,mk_t,mk_f),
	(c1,mk_t,mk_f))
	];
store_mt_results mt_run_fail [
	("dest_if 4006",
	dest_if,
	c1,
	gen_fail_msg "dest_if" 4006 [])
	];

store_mt_results mt_run [ 
	("is_if 1",
	is_if,
	mk_if(c1,mk_t,mk_f),
	true),
	("is_if 1",
	is_if,
	c1,
	false)
	];
=TEX
\subsubsection{let}
=SML
store_mt_results mt_run [ 
	("mk_let 1",
	mk_let,
	([],mk_t),
	mk_t),
	("mk_let 2",
	mk_let,
	([(v1, cv1)],mk_t),
	list_mk_comb(mk_const("Let",mk_fun(mk_fun(tv1,BOOL),mk_fun(tv1,BOOL))),
		[mk_abs(v1,mk_t), cv1])),
	("mk_let 3",
	mk_let,
	([(mk_pair(v1, v11), cp1)],mk_t),
	list_mk_comb(mk_const("Let",mk_fun(
			mk_fun(mk_pair_type(tv1, BOOL),BOOL),
			mk_fun(mk_pair_type(tv1, BOOL),BOOL))),
		[mk_abs(mk_pair(v1, v11),mk_t), cp1])),
	("mk_let 4",
	mk_let,
	([(mk_pair(v1, v11), cp1),(v2,cv2)],mk_t),
	list_mk_comb(mk_const("Let",mk_fun(mk_fun(tv2,BOOL),mk_fun(tv2,BOOL))),
		[mk_let([(mk_pair(v1, v11), cp1)],mk_abs(v2,mk_t)), cv2])),
	("mk_let 5",
	mk_let,
	([(mk_comb(f,v11), mk_t)],mk_f),
	list_mk_comb(mk_const("Let",mk_fun(
			mk_fun(mk_fun(BOOL,BOOL),BOOL),
			mk_fun(mk_fun(BOOL,BOOL),BOOL))),
		[mk_abs(f,mk_f), mk_abs(v11,mk_t)]))
	];

store_mt_results mt_run_fail [
	("mk_let 4007",
	mk_let,
	([(mk_comb(f, c1), mk_t)], mk_t),
	gen_fail_msg "mk_let" 4007 []),
	("mk_let 4008",
	mk_let,
	([(f, mk_t)], mk_t),
	gen_fail_msg "mk_let" 4008 [])
	];


store_mt_results mt_run [ 
	("dest_let",
	dest_let o mk_let,
	([(mk_pair(v1, v11), cp1),(v2,cv2)],mk_t),
	([(mk_pair(v1, v11), cp1),(v2,cv2)],mk_t))
	];

store_mt_results mt_run_fail [
	("dest_let 4009",
	dest_let,
	c1,
	gen_fail_msg "dest_let" 4009 [])
	];
store_mt_results mt_run [ 
	("is_let 1",
	is_let,
	c1,
	false),
	("is_let 2",
	is_let,
	mk_let([(mk_pair(v1, v11), cp1),(v2,cv2)],mk_t),
	true)
	];
store_mt_results mt_run [ 
	("list_mk_let",
	list_mk_let,
	([[(v1, cv1)],[(v2, cv2)]], mk_t),
	mk_let([(v1, cv1)],mk_let([(v2, cv2)],mk_t)))
	];
store_mt_results mt_run [ 
	("strip_let",
	strip_let,
	list_mk_let ([[(v1, cv1)],[(v2, cv2)]], mk_t),
	([[(v1, cv1)],[(v2, cv2)]], mk_t))
	];
=TEX
\subsubsection{Enumerated Sets}
=SML
store_mt_results mt_run [ 
	("mk_empty_enum_set",
	mk_empty_enum_set,
	Ü,
	mk_const("Empty",mk_type("SET",[Ü])))
	];

store_mt_results mt_run [ 
	("mk_enum_set",
	mk_enum_set,
	[mk_t],
	list_mk_comb(mk_const("Insert",mk_fun(BOOL,mk_fun(
			mk_type("SET",[BOOL]),mk_type("SET",[BOOL])))),
		[mk_t,mk_empty_enum_set BOOL]))
	];
store_mt_results mt_run_fail [
	("mk_enum_set 3017",
	mk_enum_set,
	[],
	gen_fail_msg "mk_enum_set" 3017 []),
	("mk_enum_set 4010",
	mk_enum_set,
	[mk_t,c2],
	gen_fail_msg "mk_enum_set" 4010 [])
	];
store_mt_results mt_run [ 
	("dest_enum_set",
	dest_enum_set,
	mk_enum_set [mk_t, mk_f, c1],
	[mk_t, mk_f, c1])
	];
store_mt_results mt_run_fail [
	("dest_enum_set 4011 a",
	dest_enum_set,
	c1,
	gen_fail_msg "dest_enum_set" 4011 []),
	("dest_enum_set 4011 b",
	dest_enum_set,
	list_mk_comb(mk_const("Insert",mk_fun(BOOL,mk_fun(
			mk_type("SET",[BOOL]),mk_type("SET",[BOOL])))),
		[mk_t,mk_var("v",mk_type("SET",[BOOL]))]),
	gen_fail_msg "dest_enum_set" 4011 [])
	];

store_mt_results mt_run [ 
	("is_enum_set 1",
	is_enum_set,
	mk_enum_set [mk_t, mk_f, c1],
	true),
	("is_enum_set 2",
	is_enum_set,
	mk_t,
	false)
	];
=TEX
\subsubsection{Sets}
=SML
store_mt_results mt_run [ 
	("mk_set 1",
	mk_set,
	(v1, mk_t),
	mk_comb(mk_const("SetComp",mk_fun(mk_fun(tv1,BOOL),mk_type("SET",[tv1]))),
		mk_abs(v1,mk_t))),
	("mk_set 2",
	mk_set,
	(mk_pair(v1,v2), mk_t),
	mk_comb(mk_const("SetComp",mk_fun(mk_fun(
			mk_pair_type(tv1,tv2),BOOL),
			mk_type("SET",[mk_pair_type(tv1,tv2)]))),
		mk_abs(mk_pair(v1,v2),mk_t)))
	];
store_mt_results mt_run_fail [
	("mk_set 4012",
	mk_set,
	(v1,v1),
	gen_fail_msg "mk_set" 4012 [])
	];
store_mt_results mt_run [ 
	("dest_set",
	dest_set,
	mk_set(mk_pair(v1,v2), mk_t),
	(mk_pair(v1,v2), mk_t))
	];
store_mt_results mt_run_fail [
	("dest_set 4013 a",
	dest_set,
	c1,
	gen_fail_msg "dest_set" 4013 []),
	("dest_set 4013 b",
	dest_set,
	mk_comb(mk_const("SetComp",mk_fun(mk_fun(
			mk_pair_type(tv1,tv2),BOOL),
			mk_type("SET",[mk_pair_type(tv1,tv2)]))),
		mk_var("v",mk_fun(mk_pair_type(tv1,tv2),BOOL))),
	gen_fail_msg "dest_set" 4013 [])
	];
store_mt_results mt_run [ 
	("is_set 1",
	is_set,
	mk_t,
	false),
	("is_set 2",
	is_set,
	mk_set(mk_pair(v1,v2), mk_t),
	true)
	];
=TEX
\subsubsection{Lists}
=SML
store_mt_results mt_run [ 
	("mk_empty_list",
	mk_empty_list,
	Ü,
	mk_const("Nil",mk_type("LIST",[Ü])))
	];

store_mt_results mt_run [ 
	("mk_list",
	mk_list,
	[mk_t],
	list_mk_comb(mk_const("Cons",mk_fun(BOOL,mk_fun(
			mk_type("LIST",[BOOL]),mk_type("LIST",[BOOL])))),
		[mk_t,mk_empty_list BOOL]))
	];
store_mt_results mt_run_fail [
	("mk_list 3017",
	mk_list,
	[],
	gen_fail_msg "mk_list" 3017 []),
	("mk_list 4010",
	mk_list,
	[mk_t,c2],
	gen_fail_msg "mk_list" 4010 [])
	];
store_mt_results mt_run [ 
	("dest_list",
	dest_list,
	mk_list [mk_t, mk_f, c1],
	[mk_t, mk_f, c1])
	];
store_mt_results mt_run_fail [
	("dest_list 4015 a",
	dest_list,
	c1,
	gen_fail_msg "dest_list" 4015 []),
	("dest_list 4015 b",
	dest_list,
	list_mk_comb(mk_const("Cons",mk_fun(BOOL,mk_fun(
			mk_type("LIST",[BOOL]),mk_type("LIST",[BOOL])))),
		[mk_t,mk_var("v",mk_type("LIST",[BOOL]))]),
	gen_fail_msg "dest_list" 4015 [])
	];

store_mt_results mt_run [ 
	("is_list 1",
	is_list,
	mk_list [mk_t, mk_f, c1],
	true),
	("is_list 2",
	is_list,
	mk_t,
	false)
	];
=TEX
\subsubsection{Full Universals}
=SML
store_mt_results mt_run [ 
	("mk_É 1",
	mk_É,
	(v1, mk_t),
	mk_comb(mk_const("É",mk_fun(mk_fun(tv1,BOOL),BOOL)),
		mk_abs(v1,mk_t))),
	("mk_É 2",
	mk_É,
	(mk_pair(v1,v2), mk_t),
	mk_comb(mk_const("É",mk_fun(mk_fun(
			mk_pair_type(tv1,tv2),BOOL),
			BOOL)),
		mk_abs(mk_pair(v1,v2),mk_t)))
	];
store_mt_results mt_run_fail [
	("mk_É 4016 a",
	mk_É,
	(v1,v1),
	gen_fail_msg "mk_É" 4016 []),
	("mk_É 4016 b",
	mk_É,
	(c1,v1),
	gen_fail_msg "mk_É" 4016 [])
	];
store_mt_results mt_run [ 
	("dest_É",
	dest_É,
	mk_É(mk_pair(v1,v2), mk_t),
	(mk_pair(v1,v2), mk_t))
	];
store_mt_results mt_run_fail [
	("dest_É 4017",
	dest_É,
	c1,
	gen_fail_msg "dest_É" 4017 [])
	];
store_mt_results mt_run [ 
	("is_É 1",
	is_É,
	mk_t,
	false),
	("is_É 2",
	is_É,
	mk_É(mk_pair(v1,v2), mk_t),
	true)
	];
store_mt_results mt_run [ 
	("list_mk_É 1",
	list_mk_É,
	([],mk_t),
	mk_t),
	("list_mk_É 2",
	list_mk_É,
	([v1,v2],mk_t),
	mk_É(v1,mk_É(v2,mk_t)))
	];
store_mt_results mt_run_fail [
	("list_mk_É 4016 a",
	list_mk_É,
	([v1],c2),
	gen_fail_msg "mk_É" 4016 []),
	("list_mk_É 4016 b",
	list_mk_É,
	([c1],c2),
	gen_fail_msg "mk_É" 4016 [])
	];
store_mt_results mt_run [ 
	("strip_É 1",
	strip_É,
	mk_t,
	([],mk_t)),
	("strip_É 2",
	strip_É,
	list_mk_É([v1,mk_pair(v2,v11)],mk_t),
	([v1,mk_pair(v2,v11)],mk_t))
	];
store_mt_results mt_run [ 
	("simple_strip_É 1",
	simple_strip_É,
	mk_t,
	([],mk_t)),
	("simple_strip_É 2",
	simple_strip_É,
	list_mk_É([v1,mk_pair(v2,v11)],mk_t),
	([v1],mk_É(mk_pair(v2,v11),mk_t)))
	];
=TEX
\subsubsection{Full Existentials}
=SML
store_mt_results mt_run [ 
	("mk_Ñ 1",
	mk_Ñ,
	(v1, mk_t),
	mk_comb(mk_const("Ñ",mk_fun(mk_fun(tv1,BOOL),BOOL)),
		mk_abs(v1,mk_t))),
	("mk_Ñ 2",
	mk_Ñ,
	(mk_pair(v1,v2), mk_t),
	mk_comb(mk_const("Ñ",mk_fun(mk_fun(
			mk_pair_type(tv1,tv2),BOOL),
			BOOL)),
		mk_abs(mk_pair(v1,v2),mk_t)))
	];
store_mt_results mt_run_fail [
	("mk_Ñ 4016 a",
	mk_Ñ,
	(v1,v1),
	gen_fail_msg "mk_Ñ" 4016 []),
	("mk_Ñ 4016 b",
	mk_Ñ,
	(c1,v1),
	gen_fail_msg "mk_Ñ" 4016 [])
	];
store_mt_results mt_run [ 
	("dest_Ñ",
	dest_Ñ,
	mk_Ñ(mk_pair(v1,v2), mk_t),
	(mk_pair(v1,v2), mk_t))
	];
store_mt_results mt_run_fail [
	("dest_Ñ 4020",
	dest_Ñ,
	c1,
	gen_fail_msg "dest_Ñ" 4020 [])
	];
store_mt_results mt_run [ 
	("is_Ñ 1",
	is_Ñ,
	mk_t,
	false),
	("is_Ñ 2",
	is_Ñ,
	mk_Ñ(mk_pair(v1,v2), mk_t),
	true)
	];
store_mt_results mt_run [ 
	("list_mk_Ñ 1",
	list_mk_Ñ,
	([],mk_t),
	mk_t),
	("list_mk_Ñ 2",
	list_mk_Ñ,
	([v1,v2],mk_t),
	mk_Ñ(v1,mk_Ñ(v2,mk_t)))
	];
store_mt_results mt_run_fail [
	("list_mk_Ñ 4016 a",
	list_mk_Ñ,
	([v1],c2),
	gen_fail_msg "mk_Ñ" 4016 []),
	("list_mk_Ñ 4016 b",
	list_mk_Ñ,
	([c1],c2),
	gen_fail_msg "mk_Ñ" 4016 [])
	];
store_mt_results mt_run [ 
	("strip_Ñ 1",
	strip_Ñ,
	mk_t,
	([],mk_t)),
	("strip_Ñ 2",
	strip_Ñ,
	list_mk_Ñ([v1,mk_pair(v2,v11)],mk_t),
	([v1,mk_pair(v2,v11)],mk_t))
	];
store_mt_results mt_run [ 
	("simple_strip_Ñ 1",
	simple_strip_Ñ,
	mk_t,
	([],mk_t)),
	("simple_strip_Ñ 2",
	simple_strip_Ñ,
	list_mk_Ñ([v1,mk_pair(v2,v11)],mk_t),
	([v1],mk_Ñ(mk_pair(v2,v11),mk_t)))
	];
=TEX
\subsubsection{Full Existentials}
=SML
store_mt_results mt_run [ 
	("mk_Ñ 1",
	mk_Ñ,
	(v1, mk_t),
	mk_comb(mk_const("Ñ",mk_fun(mk_fun(tv1,BOOL),BOOL)),
		mk_abs(v1,mk_t))),
	("mk_Ñ 2",
	mk_Ñ,
	(mk_pair(v1,v2), mk_t),
	mk_comb(mk_const("Ñ",mk_fun(mk_fun(
			mk_pair_type(tv1,tv2),BOOL),
			BOOL)),
		mk_abs(mk_pair(v1,v2),mk_t)))
	];
store_mt_results mt_run_fail [
	("mk_Ñ 4016 a",
	mk_Ñ,
	(v1,v1),
	gen_fail_msg "mk_Ñ" 4016 []),
	("mk_Ñ 4016 b",
	mk_Ñ,
	(c1,v1),
	gen_fail_msg "mk_Ñ" 4016 [])
	];
store_mt_results mt_run [ 
	("dest_Ñ",
	dest_Ñ,
	mk_Ñ(mk_pair(v1,v2), mk_t),
	(mk_pair(v1,v2), mk_t))
	];
store_mt_results mt_run_fail [
	("dest_Ñ 4020",
	dest_Ñ,
	c1,
	gen_fail_msg "dest_Ñ" 4020 [])
	];
store_mt_results mt_run [ 
	("is_Ñ 1",
	is_Ñ,
	mk_t,
	false),
	("is_Ñ 2",
	is_Ñ,
	mk_Ñ(mk_pair(v1,v2), mk_t),
	true)
	];
store_mt_results mt_run [ 
	("list_mk_Ñ 1",
	list_mk_Ñ,
	([],mk_t),
	mk_t),
	("list_mk_Ñ 2",
	list_mk_Ñ,
	([v1,v2],mk_t),
	mk_Ñ(v1,mk_Ñ(v2,mk_t)))
	];
store_mt_results mt_run_fail [
	("list_mk_Ñ 4016 a",
	list_mk_Ñ,
	([v1],c2),
	gen_fail_msg "mk_Ñ" 4016 []),
	("list_mk_Ñ 4016 b",
	list_mk_Ñ,
	([c1],c2),
	gen_fail_msg "mk_Ñ" 4016 [])
	];
store_mt_results mt_run [ 
	("strip_Ñ 1",
	strip_Ñ,
	mk_t,
	([],mk_t)),
	("strip_Ñ 2",
	strip_Ñ,
	list_mk_Ñ([v1,mk_pair(v2,v11)],mk_t),
	([v1,mk_pair(v2,v11)],mk_t))
	];
store_mt_results mt_run [ 
	("simple_strip_Ñ 1",
	simple_strip_Ñ,
	mk_t,
	([],mk_t)),
	("simple_strip_Ñ 2",
	simple_strip_Ñ,
	list_mk_Ñ([v1,mk_pair(v2,v11)],mk_t),
	([v1],mk_Ñ(mk_pair(v2,v11),mk_t)))
	];
=TEX
\subsubsection{Simple Unique Existentials}
=SML
store_mt_results mt_run [ 
	("simple_mk_Ñ%down%1 1",
	simple_mk_Ñ%down%1,
	(v1, mk_t),
	mk_comb(mk_const("Ñ%down%1",mk_fun(mk_fun(tv1,BOOL),BOOL)),
		mk_abs(v1,mk_t)))
	];
store_mt_results mt_run_fail [
	("simple_mk_Ñ%down%1 4018 a",
	simple_mk_Ñ%down%1,
	(v1,v1),
	gen_fail_msg "simple_mk_Ñ%down%1" 4018 []),
	("simple_mk_Ñ%down%1 4018 b",
	simple_mk_Ñ%down%1,
	(c1,v1),
	gen_fail_msg "simple_mk_Ñ%down%1" 4018 []),
	("simple_mk_Ñ%down%1 4018 c",
	simple_mk_Ñ%down%1,
	(mk_pair(v1,v2),mk_t),
	gen_fail_msg "simple_mk_Ñ%down%1" 4018 [])
	];
store_mt_results mt_run [ 
	("simple_dest_Ñ%down%1",
	simple_dest_Ñ%down%1,
	simple_mk_Ñ%down%1(v1, mk_t),
	(v1, mk_t))
	];
store_mt_results mt_run_fail [
	("simple_dest_Ñ%down%1 4019",
	simple_dest_Ñ%down%1,
	c1,
	gen_fail_msg "simple_dest_Ñ%down%1" 4019 [])
	];
store_mt_results mt_run [ 
	("simple_is_Ñ%down%1 1",
	simple_is_Ñ%down%1,
	mk_t,
	false),
	("simple_is_Ñ%down%1 2",
	simple_is_Ñ%down%1,
	simple_mk_Ñ%down%1(v1, mk_t),
	true)
	];
=TEX
\subsubsection{Full Unique Existentials}
=SML
store_mt_results mt_run [ 
	("mk_Ñ%down%1 1",
	mk_Ñ%down%1,
	(v1, mk_t),
	mk_comb(mk_const("Ñ%down%1",mk_fun(mk_fun(tv1,BOOL),BOOL)),
		mk_abs(v1,mk_t))),
	("mk_Ñ%down%1 2",
	mk_Ñ%down%1,
	(mk_pair(v1,v2), mk_t),
	mk_comb(mk_const("Ñ%down%1",mk_fun(mk_fun(
			mk_pair_type(tv1,tv2),BOOL),
			BOOL)),
		mk_abs(mk_pair(v1,v2),mk_t)))
	];
store_mt_results mt_run_fail [
	("mk_Ñ%down%1 4016 a",
	mk_Ñ%down%1,
	(v1,v1),
	gen_fail_msg "mk_Ñ%down%1" 4016 []),
	("mk_Ñ%down%1 4016 b",
	mk_Ñ%down%1,
	(c1,v1),
	gen_fail_msg "mk_Ñ%down%1" 4016 [])
	];
store_mt_results mt_run [ 
	("dest_Ñ%down%1",
	dest_Ñ%down%1,
	mk_Ñ%down%1(mk_pair(v1,v2), mk_t),
	(mk_pair(v1,v2), mk_t))
	];
store_mt_results mt_run_fail [
	("dest_Ñ%down%1 4021",
	dest_Ñ%down%1,
	c1,
	gen_fail_msg "dest_Ñ%down%1" 4021 [])
	];
store_mt_results mt_run [ 
	("is_Ñ%down%1 1",
	is_Ñ%down%1,
	mk_t,
	false),
	("is_Ñ%down%1 2",
	is_Ñ%down%1,
	mk_Ñ%down%1(mk_pair(v1,v2), mk_t),
	true)
	];
=TEX
\subsubsection{Full Choice}
=SML
store_mt_results mt_run [ 
	("mk_á 1",
	mk_á,
	(v1, mk_t),
	mk_comb(mk_const("á",mk_fun(mk_fun(tv1,BOOL),tv1)),
		mk_abs(v1,mk_t))),
	("mk_á 2",
	mk_á,
	(mk_pair(v1,v2), mk_t),
	mk_comb(mk_const("á",mk_fun(mk_fun(
			mk_pair_type(tv1,tv2),BOOL),
			mk_pair_type(tv1,tv2))),
		mk_abs(mk_pair(v1,v2),mk_t)))
	];
store_mt_results mt_run_fail [
	("mk_á 4016 a",
	mk_á,
	(v1,v1),
	gen_fail_msg "mk_á" 4016 []),
	("mk_á 4016 b",
	mk_á,
	(c1,v1),
	gen_fail_msg "mk_á" 4016 [])
	];
store_mt_results mt_run [ 
	("dest_á",
	dest_á,
	mk_á(mk_pair(v1,v2), mk_t),
	(mk_pair(v1,v2), mk_t))
	];
store_mt_results mt_run_fail [
	("dest_á 4023",
	dest_á,
	c1,
	gen_fail_msg "dest_á" 4023 [])
	];
store_mt_results mt_run [ 
	("is_á 1",
	is_á,
	mk_t,
	false),
	("is_á 2",
	is_á,
	mk_á(mk_pair(v1,v2), mk_t),
	true)
	];
store_mt_results mt_run [ 
	("list_mk_á 1",
	list_mk_á,
	([],mk_t),
	mk_t),
	("list_mk_á 2",
	list_mk_á,
	([v1,mk_var("v",BOOL)],mk_t),
	mk_á(v1,mk_á(mk_var("v",BOOL),mk_t)))
	];
store_mt_results mt_run_fail [
	("list_mk_á 4016 a",
	list_mk_á,
	([v1],c2),
	gen_fail_msg "mk_á" 4016 []),
	("list_mk_á 4016 b",
	list_mk_á,
	([c1],c1),
	gen_fail_msg "mk_á" 4016 []),
	("list_mk_á 4016 c",
	list_mk_á,
	([v1,v2],c1),
	gen_fail_msg "mk_á" 4016 [])
	];
store_mt_results mt_run [ 
	("strip_á 1",
	strip_á,
	mk_t,
	([],mk_t)),
	("strip_á 2",
	strip_á,
	list_mk_á([mk_pair(v2,v11),mk_var("v",BOOL)],mk_t),
	([mk_pair(v2,v11),mk_var("v",BOOL)],mk_t))
	];
=TEX
\subsection{Destroyed Terms}
=SML
store_mt_results mt_run [ 
	("dest_term 1",
	dest_term,
	mk_var ("v2",BOOL),
	DVar ("v2",BOOL)),
	("dest_term 2",
	dest_term,
	mk_const ("c2",BOOL),
	DConst ("c2",BOOL)),
	("dest_term 3",
	dest_term,
	mk_comb (f,c1),
	DComb (f,c1)),
	("dest_term 4",
	dest_term,
	mk_abs (f,c1),
	DAbs (f,c1)),
	("dest_term 5",
	dest_term,
	mk_abs (mk_pair(v1,v2),c1),
	DAbs (mk_pair(v1,v2),c1)),
	("dest_term 6",
	dest_term,
	mk_eq (mk_Ü 1,mk_Ü 1),
	DEq(mk_Ü 1,mk_Ü 1)),
	("dest_term 6.1",
	dest_term,
	mk_ä (mk_t,mk_f),
	Dä(mk_t,mk_f)),
	("dest_term 6.2",
	dest_term,
	mk_å mk_t,
	Då mk_t),
	("dest_term 7",
	dest_term,
	mk_pair(v1,v2),
	DPair(v1,v2)),
	("dest_term 8",
	dest_term,
	mk_Ä (mk_t,c1),
	DÄ(mk_t,c1)),
	("dest_term 9",
	dest_term,
	mk_Å (mk_t,c1),
	DÅ(mk_t,c1)),
	("dest_term 10",
	dest_term,
	mk_Ç (mk_t,c1),
	DÇ(mk_t,c1)),
	("dest_term 11",
	dest_term,
	mk_eq (mk_t,c1),
	DÇ(mk_t,c1)),
	("dest_term 12",
	dest_term,
	mk_let([(mk_pair(v1, v11), cp1),(v2,cv2)],mk_t),
	DLet([(mk_pair(v1, v11), cp1),(v2,cv2)],mk_t)),
	("dest_term 13 a",
	dest_term,
	mk_enum_set [mk_t,mk_f,c1],
	DEnumSet ([mk_t,mk_f,c1],BOOL)),
	("dest_term 13 b",
	dest_term,
	mk_empty_enum_set BOOL,
	DEnumSet ([],BOOL)),
	("dest_term 14",
	dest_term,
	mk_set(mk_pair(v1,v2), mk_t),
	DSet (mk_pair(v1,v2), mk_t)),
	("dest_term 15",
	dest_term,
	mk_list [mk_t,mk_f,c1],
	DList ([mk_t,mk_f,c1],BOOL)),
	("dest_term 16 a",
	dest_term,
	mk_list [mk_t,mk_f,c1],
	DList ([mk_t,mk_f,c1],BOOL)),
	("dest_term 16 b",
	dest_term,
	mk_empty_list BOOL,
	DList ([],BOOL)),
	("dest_term 17",
	dest_term,
	mk_É (mk_pair(v1,mk_pair(v2,v11)),mk_t),
	DÉ(mk_pair(v1,mk_pair(v2,v11)),mk_t)),
	("dest_term 18",
	dest_term,
	mk_Ñ (mk_pair(v1,mk_pair(v2,v11)),mk_t),
	DÑ(mk_pair(v1,mk_pair(v2,v11)),mk_t)),
	("dest_term 19",
	dest_term,
	mk_á (mk_pair(v1,mk_pair(v2,v11)),mk_t),
	Dá(mk_pair(v1,mk_pair(v2,v11)),mk_t)),
	("dest_term 20",
	dest_term,
	mk_if (mk_t,mk_Ü 1,mk_Ü 2),
	DIf(mk_t,mk_Ü 1,mk_Ü 2)),
	("dest_term 21",
	dest_term,
	list_mk_comb (mk_const("g",mk_fun(BOOL,mk_fun(Ü,mk_fun(Ü,BOOL)))),
		[mk_t,mk_Ü 1,mk_Ü 2]),
	DComb(list_mk_comb (mk_const("g",mk_fun(BOOL,mk_fun(Ü,mk_fun(Ü,BOOL)))),
		[mk_t,mk_Ü 1]),mk_Ü 2))
	];

store_mt_results mt_run [
	("mk_term 1",
	mk_term o dest_term,
	mk_var ("v2",BOOL),
	mk_var ("v2",BOOL)),
	("mk_term 2",
	mk_term o dest_term,
	mk_const ("c2",BOOL),
	mk_const ("c2",BOOL)),
	("mk_term 3",
	mk_term o dest_term,
	mk_comb (f,c1),
	mk_comb (f,c1)),
	("mk_term 4",
	mk_term o dest_term,
	mk_abs (f,c1),
	mk_abs (f,c1)),
	("mk_term 5",
	mk_term o dest_term,
	mk_abs (mk_pair(v1,v2),c1),
	mk_abs (mk_pair(v1,v2),c1)),
	("mk_term 6",
	mk_term o dest_term,
	mk_eq (mk_Ü 1,mk_Ü 1),
	mk_eq(mk_Ü 1,mk_Ü 1)),
	("mk_term 6.1",
	mk_term o dest_term,
	mk_ä (mk_t,mk_f),
	mk_ä (mk_t,mk_f)),
	("mk_term 6.2",
	mk_term o dest_term,
	mk_å mk_t,
	mk_å mk_t),
	("mk_term 7",
	mk_term o dest_term,
	mk_pair(v1,v2),
	mk_pair(v1,v2)),
	("mk_term 8",
	mk_term o dest_term,
	mk_Ä (mk_t,c1),
	mk_Ä(mk_t,c1)),
	("mk_term 9",
	mk_term o dest_term,
	mk_Å (mk_t,c1),
	mk_Å(mk_t,c1)),
	("mk_term 10",
	mk_term o dest_term,
	mk_Ç (mk_t,c1),
	mk_Ç(mk_t,c1)),
	("mk_term 11",
	mk_term o dest_term,
	mk_eq (mk_t,c1),
	mk_Ç(mk_t,c1)),
	("mk_term 12",
	mk_term o dest_term,
	mk_let([(mk_pair(v1, v11), cp1),(v2,cv2)],mk_t),
	mk_let([(mk_pair(v1, v11), cp1),(v2,cv2)],mk_t)),
	("mk_term 13 a",
	mk_term o dest_term,
	mk_enum_set [mk_t,mk_f,c1],
	mk_enum_set [mk_t,mk_f,c1]),
	("mk_term 13 b",
	mk_term o dest_term,
	mk_empty_enum_set BOOL,
	mk_empty_enum_set BOOL),
	("mk_term 14",
	mk_term o dest_term,
	mk_set(mk_pair(v1,v2), mk_t),
	mk_set (mk_pair(v1,v2), mk_t)),
	("mk_term 15",
	mk_term o dest_term,
	mk_list [mk_t,mk_f,c1],
	mk_list [mk_t,mk_f,c1]),
	("mk_term 16 a",
	mk_term o dest_term,
	mk_list [mk_t,mk_f,c1],
	mk_list [mk_t,mk_f,c1]),
	("mk_term 16 b",
	mk_term o dest_term,
	mk_empty_list BOOL,
	mk_empty_list BOOL),
	("mk_term 17",
	mk_term o dest_term,
	mk_É (mk_pair(v1,mk_pair(v2,v11)),mk_t),
	mk_É(mk_pair(v1,mk_pair(v2,v11)),mk_t)),
	("mk_term 18",
	mk_term o dest_term,
	mk_Ñ (mk_pair(v1,mk_pair(v2,v11)),mk_t),
	mk_Ñ(mk_pair(v1,mk_pair(v2,v11)),mk_t)),
	("mk_term 19",
	mk_term o dest_term,
	mk_á (mk_pair(v1,mk_pair(v2,v11)),mk_t),
	mk_á(mk_pair(v1,mk_pair(v2,v11)),mk_t)),
	("mk_term 20",
	mk_term o dest_term,
	mk_if (mk_t,mk_Ü 1,mk_Ü 2),
	mk_if(mk_t,mk_Ü 1,mk_Ü 2)),
	("mk_term 21",
	mk_term o dest_term,
	list_mk_comb (mk_const("g",mk_fun(BOOL,mk_fun(Ü,mk_fun(Ü,BOOL)))),
		[mk_t,mk_Ü 1,mk_Ü 2]),
	list_mk_comb (mk_const("g",mk_fun(BOOL,mk_fun(Ü,mk_fun(Ü,BOOL)))),
		[mk_t,mk_Ü 1,mk_Ü 2]))
	];
=TEX
\subsection{End of Tests}
=SML
summarize_mt_results();
(* PolyML.quit(); *)
=TEX
\end{document}
