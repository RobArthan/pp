=TEX
\documentstyle[hol1,11pt,TQ]{article}
\ftlinepenalty=9999
\makeindex
\TPPproject{FST PROJECT}  %% Mandatory field
%\TPPvolume{}
%\TPPpart{}
\TPPtitle{Module Tests for Derived Terms}  %% Mandatory field
\def\TPPheadtitle{Module Tests for Derived Terms}
\TPPref{DS/FMU/IED/MDT004}  %% Mandatory field
\def\SCCSversion{$Revision$ %
}
\TPPissue{\SCCSversion}  %% Mandatory field
\TPPdate{\FormatDate{$Date$ %
}}
\TPPstatus{Draft}
%\TPPstatus{Approved}
\TPPtype{SML Literate Script}
\TPPkeywords{}
\TPPauthor{K.Blackburn & WIN01}  %% Mandatory field
%\TPPauthors{Name 1&location 1\\Name 2&location 2\\Name 3&location 3}
\TPPauthorisation{R.D.Arthan & FST Team Leader}
\TPPabstract{A set of module tests are given for the derived term functions.}
\TPPdistribution{\parbox[t]{4.0in}{%
	    Library
}}
\begin{document}
\makeTPPfrontpage
\vfill
\begin{centering}

\bf Copyright \copyright\ : International Computers Ltd \number\year

\end{centering}
\pagebreak
\section{DOCUMENT CONTROL}
\subsection{Contents List}
\tableofcontents
\subsection{Document Cross References}
\bibliographystyle{fmu}
\bibliography{fmu}

\subsection{Changes History} 
\begin{description}
\item [Issue 1.1 to 1.12]
First drafts.
\item [Issue 1.13]
Changes in response to deskcheck ID0092.
\item [Issue 2.1 (20th November 1991)]
Approved version of issue 1.13.

\item[Issue \SCCSversion, \FormatDate{92/01/20} ] Updated to use new fonts.

\end{description}
%\subsection{Changes Forecast}
\section{GENERAL}
\subsection{Scope}
This document contains the module testing of the derived term functions, required by Release 1 ICL HOL Product Requirement Specification \cite{DS/FMU/IED/DEF004}.
The design is in \cite{DS/FMU/IED/DTD004}
and it is
implemented in \cite{DS/FMU/IED/IMP004}.

\subsection{Introduction}
\subsubsection{Purpose and Background}
This document contains the module testing of the material given a design in \cite{DS/FMU/IED/DTD004},
following the test policy given in that document and the general policy given in \cite{DS/FMU/IED/PLN008}.

The tests use the test harness of \cite{DS/FMU/IED/DTD013}.
\subsubsection{Dependencies}
This document is derived from the detailed design in \cite{DS/FMU/IED/DTD004},
and is further influenced by the implementation, in  \cite{DS/FMU/IED/IMP004}.
\subsubsection{Deficiencies}
None known.
\section{TEST CASES}
We test each function of the signature of \cite{DS/FMU/IED/DTD004}
in turn, where possible in the same order as in the design document,
except for those exceptions noted in section \ref{untested}.
\section{INITIALISATION}
Initialise the test package:
=SML
usefile "dtd013.sml";
usefile "imp013.sml";
init_mt_results();
=TEX
\section{VALUE BINDINGS}
=SML
val tv1 = mk_vartype "'tv1";
val tv2 = mk_vartype "'tv2";
val tv3 = mk_vartype "'tv3";
val vb = mk_var("vb", BOOL);
val v1 = mk_var("v1", tv1);
val v2 = mk_var("v2", tv2);
val v3 = mk_var("v3", tv3);
val c1 = mk_const("c1",BOOL);
val c2 = mk_const("c2",mk_ctype("triple",[tv1,tv2,tv3]));
val cv1 = mk_const("cv1",tv1);
val v11 = mk_var("v11",BOOL);
val cp1 = mk_const("cp1",mk_¸_type(tv1, BOOL));
val cv2 = mk_const("cv2",tv2);
val f = mk_var("f",mk_­_type(BOOL,BOOL));
=TEX
\section{THE TESTS}
\subsection{Boolean Constants}
=SML
store_mt_results mt_run [ 
	("mk_t",
	Combinators.I,
	mk_t,
	mk_const("T",BOOL)),
	("mk_f",
	Combinators.I,
	mk_f,
	mk_const("F",BOOL))
	];
store_mt_results mt_run [ 
	("is_t 1",
	is_t,
	mk_t,
	true),
	("is_t 2",
	is_t,
	mk_f,
	false),
	("is_f 1",
	is_f,
	mk_t,
	false),
	("is_f 2",
	is_f,
	mk_f,
	true)
	];
=TEX
\subsection{Generic Binder Functions}
The $?\_binder$, etc, functions will be considered
tested by the functions they are used to implement,
as noted in \ref{untested}.
\subsection{Pairs}
=SML
store_mt_results mt_run [ 
	("mk_¸_type",
	mk_¸_type,
	(BOOL, î),
	mk_ctype("¸",[BOOL, î]))
	];
store_mt_results mt_run_fail [ 
	("dest_¸_type 4018",
	dest_¸_type,
	BOOL,
	gen_fail_msg "dest_¸_type" 4018 ["¬:BOOL®"])
	];
store_mt_results mt_run [ 
	("dest_¸_type",
	dest_¸_type o mk_¸_type,
	(BOOL, î),
	(BOOL, î))
	];
store_mt_results mt_run [ 
	("is_¸_type 1",
	is_¸_type,
	mk_¸_type(BOOL, î),
	true),
	("is_¸_type 2",
	is_¸_type,
	BOOL,
	false)
	];

store_mt_results mt_run [ 
	("mk_pair",
	mk_pair,
	(c1, c2),
	list_mk_app(mk_const(",",mk_­_type(type_of c1,mk_­_type(type_of c2,
		mk_¸_type(type_of c1,type_of c2)))),
		[c1,c2]))
	];
store_mt_results mt_run [ 
	("dest_pair",
	dest_pair,
	mk_pair(c1,c2),
	(c1,c2))
	];
store_mt_results mt_run_fail [
	("dest_pair 4003",
	dest_pair,
	c1,
	gen_fail_msg "dest_pair" 4003 ["¬c1®"])
	];
store_mt_results mt_run [ 
	("is_pair 1",
	is_pair,
	c1,
	false),
	("is_pair 2",
	is_pair,
	mk_pair(c1,c2),
	true)
	];
=TEX
\subsection{(Paired) Ì-abstractions}
=SML
store_mt_results mt_run [ 
	("mk_Ì 1",
	mk_Ì,
	(v1, c1),
	mk_simple_Ì(v1, c1)),
	("mk_Ì 2",
	mk_Ì,
	(mk_pair(v1,v2), c1),
	mk_app(mk_const("Uncurry",mk_­_type(mk_­_type(tv1,mk_­_type(tv2,BOOL)),
		mk_­_type(mk_¸_type(tv1,tv2),BOOL))),
		list_mk_simple_Ì([v1,v2], c1)))
	];
store_mt_results mt_run_fail [
	("mk_Ì 4016",
	mk_Ì,
	(c1,c1),
	gen_fail_msg "mk_Ì" 4016 ["¬c1®"])
	];

store_mt_results mt_run [ 
	("dest_Ì 1",
	dest_Ì,
	mk_Ì(v1, v1),
	(v1, v1)),
	("dest_Ì 2",
	dest_Ì,
	mk_Ì(mk_pair(v1,v2), v1),
	(mk_pair(v1,v2), v1)),
	("dest_Ì 3",
	dest_Ì,
	mk_Ì(mk_pair(mk_pair(v1,v2), mk_pair(v2,v3)), v2),
	(mk_pair(mk_pair(v1,v2), mk_pair(v2,v3)), v2))
	];

store_mt_results mt_run_fail [
	("dest_Ì 4002",
	dest_Ì,
	c1,
	gen_fail_msg "dest_Ì" 4002 ["¬c1®"])
	];
store_mt_results mt_run [ 
	("list_mk_Ì",
	list_mk_Ì,
	([mk_pair(v1,v2),v3],c1),
	mk_Ì (mk_pair(v1,v2),mk_Ì(v3,c1)))
	];
store_mt_results mt_run_fail [
	("list_mk_Ì 4016",
	list_mk_Ì,
	([c1],c1),
	gen_fail_msg "mk_Ì" 4016 ["¬c1®"])
	];
store_mt_results mt_run [ 
	("strip_Ì",
	strip_Ì,
	list_mk_Ì([mk_pair(v1,v2),v3],c1),
	([mk_pair(v1,v2),v3],c1))
	];
store_mt_results mt_run [ 
	("is_Ì a",
	is_Ì,
	list_mk_Ì([mk_pair(v1,v2),v3],c1),
	true),
	("is_Ì b",
	is_Ì,
	mk_simple_Ì(v1,v1),
	true),
	("is_Ì c",
	is_Ì,
	c1,
	false)
	];
=TEX
\subsection{Conjunctions}
=SML
store_mt_results mt_run [ 
	("mk_±",
	mk_±,
	(mk_t,mk_f),
	list_mk_app(mk_const("±",mk_­_type(BOOL,mk_­_type(BOOL,BOOL))),[mk_t,mk_f]))
	];
store_mt_results mt_run_fail [
	("mk_± 3031",
	mk_±,
	(c2,mk_f),
	gen_fail_msg "mk_±" 3031 ["¬c2®"]),
	("mk_± 3015",
	mk_±,
	(mk_f,c2),
	gen_fail_msg "mk_±" 3015 ["","¬c2®"])
	];
store_mt_results mt_run [ 
	("dest_±",
	dest_±,
	mk_±(mk_t,mk_f),
	(mk_t,mk_f))
	];
store_mt_results mt_run_fail [
	("dest_± 4032",
	dest_±,
	c1,
	gen_fail_msg "dest_±" 4032 ["¬c1®"])
	];
store_mt_results mt_run [ 
	("is_± 1",
	is_±,
	c1,
	false),
	("is_± 2",
	is_±,
	mk_±(mk_t,mk_f),
	true)
	];
store_mt_results mt_run_fail [
	("list_mk_± 3017",
	list_mk_±,
	[],
	gen_fail_msg "list_mk_±" 3017 []),
	("list_mk_± 3031",
	list_mk_±,
	[c2, mk_t],
	gen_fail_msg "list_mk_±" 3031 ["¬c2®"])
	];
store_mt_results mt_run [ 
	("list_mk_±",
	list_mk_±,
	[mk_t,mk_f,c1],
	mk_±(mk_t,mk_±(mk_f,c1)))
	];
store_mt_results mt_run [ 
	("strip_± 1",
	strip_±,
	c2,
	[c2]),
	("strip_± 2",
	strip_±,
	list_mk_±[mk_t,mk_f,c1],
	[mk_t,mk_f,c1])
	];
=TEX
\subsection{Disjunctions}
=SML
store_mt_results mt_run [ 
	("mk_²",
	mk_²,
	(mk_t,mk_f),
	list_mk_app(mk_const("²",mk_­_type(BOOL,mk_­_type(BOOL,BOOL))),[mk_t,mk_f]))
	];
store_mt_results mt_run_fail [
	("mk_² 3031",
	mk_²,
	(c2,mk_f),
	gen_fail_msg "mk_²" 3031 ["¬c2®"]),
	("mk_² 3015",
	mk_²,
	(mk_f,c2),
	gen_fail_msg "mk_²" 3015 ["","¬c2®"])
	];
store_mt_results mt_run [ 
	("dest_²",
	dest_²,
	mk_²(mk_t,mk_f),
	(mk_t,mk_f))
	];
store_mt_results mt_run_fail [
	("dest_² 4027",
	dest_²,
	c1,
	gen_fail_msg "dest_²" 4027 ["¬c1®"])
	];
store_mt_results mt_run [ 
	("is_² 1",
	is_²,
	c1,
	false),
	("is_² 2",
	is_²,
	mk_²(mk_t,mk_f),
	true)
	];
store_mt_results mt_run_fail [
	("list_mk_² 3017",
	list_mk_²,
	[],
	gen_fail_msg "list_mk_²" 3017 []),
	("list_mk_² 3031",
	list_mk_²,
	[c2, mk_t],
	gen_fail_msg "list_mk_²" 3031 ["¬c2®"])
	];
store_mt_results mt_run [ 
	("list_mk_²",
	list_mk_²,
	[mk_t,mk_f,c1],
	mk_²(mk_t,mk_²(mk_f,c1)))
	];
store_mt_results mt_run [ 
	("strip_² 1",
	strip_²,
	c2,
	[c2]),
	("strip_² 2",
	strip_²,
	list_mk_²[mk_t,mk_f,c1],
	[mk_t,mk_f,c1])
	];
=TEX
\subsection{Negations}
=SML
store_mt_results mt_run [ 
	("mk_³",
	mk_³,
	mk_t,
	mk_app(mk_const("³",mk_­_type(BOOL,BOOL)),mk_t))
	];
store_mt_results mt_run [ 
	("mk_multi_³",
	mk_multi_³,
	(2,mk_t),
	mk_³(mk_³ mk_t))
	];
store_mt_results mt_run [ 
	("dest_multi_³ a",
	dest_multi_³,
	mk_multi_³(2,mk_t),
	(2,mk_t)),
	("dest_multi_³ b",
	dest_multi_³,
	mk_î 0,
	(0,mk_î 0))
	];
store_mt_results mt_run_fail [
	("mk_³ 3031",
	mk_³,
	c2,
	gen_fail_msg "mk_³" 3031 ["¬c2®"])
	];
store_mt_results mt_run_fail [
	("mk_multi_³ 3031",
	mk_multi_³,
	(2,c2),
	gen_fail_msg "mk_multi_³" 3031 ["¬c2®"]),
	("mk_multi_³ 4030",
	mk_multi_³,
	(~2,c2),
	gen_fail_msg "mk_multi_³" 4030 ["-2"])
	];
store_mt_results mt_run [ 
	("dest_³",
	dest_³,
	mk_³ mk_t,
	mk_t)
	];
store_mt_results mt_run_fail [
	("dest_³ 4029",
	dest_³,
	c1,
	gen_fail_msg "dest_³" 4029 ["¬c1®"])
	];
store_mt_results mt_run [ 
	("is_³ 1",
	is_³,
	mk_t,
	false),
	("is_³ 2",
	is_³,
	mk_³ mk_t,
	true)
	];
=TEX
\subsection{Bi-implications}
(Notice how the constant name is ``='')
=SML
store_mt_results mt_run [ 
	("mk_¤",
	mk_¤,
	(mk_t,mk_f),
	list_mk_app(mk_const("=",mk_­_type(BOOL,mk_­_type(BOOL,BOOL))),
		[mk_t,mk_f]))
	];
store_mt_results mt_run_fail [
	("mk_¤ 3031",
	mk_¤,
	(c2,mk_f),
	gen_fail_msg "mk_¤" 3031 ["¬c2®"]),
	("mk_¤ 3015",
	mk_¤,
	(mk_f,c2),
	gen_fail_msg "mk_¤" 3015 ["","¬c2®"])
	];
store_mt_results mt_run [ 
	("dest_¤",
	dest_¤,
	mk_¤(mk_t,mk_f),
	(mk_t,mk_f))
	];
store_mt_results mt_run_fail [
	("dest_¤ 4031",
	dest_¤,
	c1,
	gen_fail_msg "dest_¤" 4031 ["¬c1®"])
	];
store_mt_results mt_run [ 
	("is_¤ 1",
	is_¤,
	c1,
	false),
	("is_¤ 2",
	is_¤,
	mk_¤(mk_t,mk_f),
	true)
	];
=TEX
\subsection{Conditionals}
=SML
store_mt_results mt_run [ 
	("mk_if",
	mk_if,
	(c1,mk_t,mk_f),
	list_mk_app(mk_const("Cond",mk_­_type(BOOL,mk_­_type(BOOL,
		mk_­_type(BOOL,BOOL)))),
		[c1,mk_t,mk_f]))
	];
store_mt_results mt_run_fail [
	("mk_if 3031",
	mk_if,
	(c2,mk_t,mk_f),
	gen_fail_msg "mk_if" 3031 ["¬c2®"]),
	("mk_if 3012",
	mk_if,
	(mk_t,mk_t,c2),
	gen_fail_msg "mk_if" 3012 ["¬T®","¬c2®"])
	];
store_mt_results mt_run [ 
	("dest_if",
	dest_if,
	mk_if(c1,mk_t,mk_f),
	(c1,mk_t,mk_f))
	];
store_mt_results mt_run_fail [
	("dest_if 4006",
	dest_if,
	c1,
	gen_fail_msg "dest_if" 4006 ["¬c1®"])
	];

store_mt_results mt_run [ 
	("is_if 1",
	is_if,
	mk_if(c1,mk_t,mk_f),
	true),
	("is_if 2",
	is_if,
	c1,
	false)
	];
=TEX
\subsection{Let-terms}
=SML
store_mt_results mt_run [ 
	("mk_let 1",
	mk_let,
	([],mk_t),
	mk_t),
	("mk_let 2",
	mk_let,
	([(v1, cv1)],mk_t),
	list_mk_app(mk_const("Let",mk_­_type(mk_­_type(tv1,BOOL),
		mk_­_type(tv1,BOOL))),
		[mk_Ì(v1,mk_t), cv1])),
	("mk_let 3",
	mk_let,
	([(mk_pair(v1, v11), cp1)],mk_t),
	list_mk_app(mk_const("Let",mk_­_type(
			mk_­_type(mk_¸_type(tv1, BOOL),BOOL),
			mk_­_type(mk_¸_type(tv1, BOOL),BOOL))),
		[mk_Ì(mk_pair(v1, v11),mk_t), cp1])),
	("mk_let 4",
	mk_let,
	([(mk_pair(v1, v11), cp1),(v2,cv2)],mk_t),
	list_mk_app(mk_const("Let",mk_­_type(mk_­_type(tv2,BOOL),
		mk_­_type(tv2,BOOL))),
		[mk_let([(mk_pair(v1, v11), cp1)],mk_Ì(v2,mk_t)), cv2])),
	("mk_let 5",
	mk_let,
	([(mk_app(f,v11), mk_t)],mk_f),
	list_mk_app(mk_const("Let",mk_­_type(
			mk_­_type(mk_­_type(BOOL,BOOL),BOOL),
			mk_­_type(mk_­_type(BOOL,BOOL),BOOL))),
		[mk_Ì(f,mk_f), mk_Ì(v11,mk_t)]))
	];

store_mt_results mt_run_fail [
	("mk_let 4007",
	mk_let,
	([(mk_app(f, c1), mk_t)], mk_t),
	gen_fail_msg "mk_let" 4007 ["¬f c1®"]),
	("mk_let 3012",
	mk_let,
	([(f, mk_t)], mk_t),
	gen_fail_msg "mk_let" 3012 ["¬f®","¬T®"])
	];


store_mt_results mt_run [ 
	("dest_let",
	dest_let o mk_let,
	([(mk_pair(v1, v11), cp1),(v2,cv2)],mk_t),
	([(mk_pair(v1, v11), cp1),(v2,cv2)],mk_t))
	];

store_mt_results mt_run_fail [
	("dest_let 4009",
	dest_let,
	c1,
	gen_fail_msg "dest_let" 4009 ["¬c1®"])
	];
store_mt_results mt_run [ 
	("is_let 1",
	is_let,
	c1,
	false),
	("is_let 2",
	is_let,
	mk_let([(mk_pair(v1, v11), cp1),(v2,cv2)],mk_t),
	true)
	];
store_mt_results mt_run [ 
	("list_mk_let",
	list_mk_let,
	([[(v1, cv1)],[(v2, cv2)]], mk_t),
	mk_let([(v1, cv1)],mk_let([(v2, cv2)],mk_t)))
	];
store_mt_results mt_run [ 
	("strip_let",
	strip_let,
	list_mk_let ([[(v1, cv1)],[(v2, cv2)]], mk_t),
	([[(v1, cv1)],[(v2, cv2)]], mk_t))
	];
=TEX
\subsection{Enumerated Sets}
=SML
store_mt_results mt_run [
	("mk_š",
	mk_š,
	î,
	mk_const("Empty",mk_ctype("SET",[î])))
	];

store_mt_results mt_run [ 
	("mk_enum_set",
	mk_enum_set,
	[mk_t],
	list_mk_app(mk_const("Insert",mk_­_type(BOOL,mk_­_type(
			mk_ctype("SET",[BOOL]),mk_ctype("SET",[BOOL])))),
		[mk_t,mk_š BOOL]))
	];
store_mt_results mt_run_fail [
	("mk_enum_set 3017",
	mk_enum_set,
	[],
	gen_fail_msg "mk_enum_set" 3017 []),
	("mk_enum_set 3012",
	mk_enum_set,
	[mk_t,c2],
	gen_fail_msg "mk_enum_set" 3012 ["¬T®","¬c2®"])
	];
store_mt_results mt_run [ 
	("dest_enum_set",
	dest_enum_set,
	mk_enum_set [mk_t, mk_f, c1],
	[mk_t, mk_f, c1])
	];
store_mt_results mt_run_fail [
	("dest_enum_set 4011 a",
	dest_enum_set,
	c1,
	gen_fail_msg "dest_enum_set" 4011 ["¬c1®"]),
	("dest_enum_set 4011 b",
	dest_enum_set,
	list_mk_app(mk_const("Insert",mk_­_type(BOOL,mk_­_type(
			mk_ctype("SET",[BOOL]),mk_ctype("SET",[BOOL])))),
		[mk_t,mk_var("v",mk_ctype("SET",[BOOL]))]),
	gen_fail_msg "dest_enum_set" 4011 ["¬Insert T v®"])
	];

store_mt_results mt_run [ 
	("is_enum_set 1",
	is_enum_set,
	mk_enum_set [mk_t, mk_f, c1],
	true),
	("is_enum_set 2",
	is_enum_set,
	mk_t,
	false)
	];
=TEX
\subsection{Set Comprehensions}
=SML
store_mt_results mt_run [ 
	("mk_set_comp 1",
	mk_set_comp,
	(v1, mk_t),
	mk_app(mk_const("SetComp",mk_­_type(mk_­_type(tv1,BOOL),
		mk_ctype("SET",[tv1]))),
		mk_Ì(v1,mk_t))),
	("mk_set_comp 2",
	mk_set_comp,
	(mk_pair(v1,v2), mk_t),
	mk_app(mk_const("SetComp",mk_­_type(mk_­_type(
			mk_¸_type(tv1,tv2),BOOL),
			mk_ctype("SET",[mk_¸_type(tv1,tv2)]))),
		mk_Ì(mk_pair(v1,v2),mk_t)))
	];
store_mt_results mt_run_fail [
	("mk_set_comp 3015",
	mk_set_comp,
	(v1,v1),
	gen_fail_msg "mk_set_comp" 3015 ["","¬v1®"]),
	("mk_set_comp 4016",
	mk_set_comp,
	(c2,v1),
	gen_fail_msg "mk_set_comp" 4016 ["¬c2®"])
	];
store_mt_results mt_run [ 
	("dest_set_comp",
	dest_set_comp,
	mk_set_comp(mk_pair(v1,v2), mk_t),
	(mk_pair(v1,v2), mk_t))
	];
store_mt_results mt_run_fail [
	("dest_set_comp 4013 a",
	dest_set_comp,
	c1,
	gen_fail_msg "dest_set_comp" 4013 ["¬c1®"]),
	("dest_set_comp 4013 b",
	dest_set_comp,
	mk_app(mk_const("SetComp",mk_­_type(mk_­_type(
			mk_¸_type(tv1,tv2),BOOL),
			mk_ctype("SET",[mk_¸_type(tv1,tv2)]))),
		mk_var("v",mk_­_type(mk_¸_type(tv1,tv2),BOOL))),
	gen_fail_msg "dest_set_comp" 4013 ["¬$SetComp v®"])
	];
store_mt_results mt_run [ 
	("is_set_comp 1",
	is_set_comp,
	mk_t,
	false),
	("is_set_comp 2",
	is_set_comp,
	mk_set_comp(mk_pair(v1,v2), mk_t),
	true)
	];
=TEX
\subsection{List-Terms}
=SML
store_mt_results mt_run [ 
	("mk_empty_list",
	mk_empty_list,
	î,
	mk_const("Nil",mk_ctype("LIST",[î])))
	];

store_mt_results mt_run [ 
	("mk_list",
	mk_list,
	[mk_t],
	list_mk_app(mk_const("Cons",mk_­_type(BOOL,mk_­_type(
			mk_ctype("LIST",[BOOL]),mk_ctype("LIST",[BOOL])))),
		[mk_t,mk_empty_list BOOL]))
	];
store_mt_results mt_run_fail [
	("mk_list 3017",
	mk_list,
	[],
	gen_fail_msg "mk_list" 3017 []),
	("mk_list 3012",
	mk_list,
	[mk_t,c2],
	gen_fail_msg "mk_list" 3012 ["¬T®","¬c2®"])
	];
store_mt_results mt_run [ 
	("dest_list",
	dest_list,
	mk_list [mk_t, mk_f, c1],
	[mk_t, mk_f, c1])
	];
store_mt_results mt_run_fail [
	("dest_list 4015 a",
	dest_list,
	c1,
	gen_fail_msg "dest_list" 4015 ["¬c1®"]),
	("dest_list 4015 b",
	dest_list,
	list_mk_app(mk_const("Cons",mk_­_type(BOOL,mk_­_type(
			mk_ctype("LIST",[BOOL]),mk_ctype("LIST",[BOOL])))),
		[mk_t,mk_var("v",mk_ctype("LIST",[BOOL]))]),
	gen_fail_msg "dest_list" 4015 ["¬Cons T v®"])
	];

store_mt_results mt_run [ 
	("is_list 1",
	is_list,
	mk_list [mk_t, mk_f, c1],
	true),
	("is_list 2",
	is_list,
	mk_t,
	false)
	];
=TEX
\subsection{Full Universals}
=SML
store_mt_results mt_run [ 
	("mk_µ 1",
	mk_µ,
	(v1, mk_t),
	mk_app(mk_const("µ",mk_­_type(mk_­_type(tv1,BOOL),BOOL)),
		mk_Ì(v1,mk_t))),
	("mk_µ 2",
	mk_µ,
	(mk_pair(v1,v2), mk_t),
	mk_app(mk_const("µ",mk_­_type(mk_­_type(
			mk_¸_type(tv1,tv2),BOOL),
			BOOL)),
		mk_Ì(mk_pair(v1,v2),mk_t)))
	];
store_mt_results mt_run_fail [
	("mk_µ 3015",
	mk_µ,
	(v1,v1),
	gen_fail_msg "mk_µ" 3015 ["","¬v1®"]),
	("mk_µ 4016",
	mk_µ,
	(c1,v1),
	gen_fail_msg "mk_µ" 4016 ["¬c1®"])
	];
store_mt_results mt_run [ 
	("dest_µ",
	dest_µ,
	mk_µ(mk_pair(v1,v2), mk_t),
	(mk_pair(v1,v2), mk_t))
	];
store_mt_results mt_run_fail [
	("dest_µ 4017",
	dest_µ,
	c1,
	gen_fail_msg "dest_µ" 4017 ["¬c1®"])
	];
store_mt_results mt_run [ 
	("is_µ 1",
	is_µ,
	mk_t,
	false),
	("is_µ 2",
	is_µ,
	mk_µ(mk_pair(v1,v2), mk_t),
	true)
	];
store_mt_results mt_run [ 
	("list_mk_µ 1",
	list_mk_µ,
	([],mk_t),
	mk_t),
	("list_mk_µ 2",
	list_mk_µ,
	([v1,v2],mk_t),
	mk_µ(v1,mk_µ(v2,mk_t)))
	];
store_mt_results mt_run_fail [
	("list_mk_µ 3015",
	list_mk_µ,
	([v1],c2),
	gen_fail_msg "mk_µ" 3015 ["","¬c2®"]),
	("list_mk_µ 4016",
	list_mk_µ,
	([c1],mk_t),
	gen_fail_msg "mk_µ" 4016 ["¬c1®"])
	];
store_mt_results mt_run [ 
	("strip_µ 1",
	strip_µ,
	mk_t,
	([],mk_t)),
	("strip_µ 2",
	strip_µ,
	list_mk_µ([v1,mk_pair(v2,v11)],mk_t),
	([v1,mk_pair(v2,v11)],mk_t))
	];
store_mt_results mt_run [ 
	("strip_simple_µ 1",
	strip_simple_µ,
	mk_t,
	([],mk_t)),
	("strip_simple_µ 2",
	strip_simple_µ,
	list_mk_µ([v1,mk_pair(v2,v11)],mk_t),
	([v1],mk_µ(mk_pair(v2,v11),mk_t)))
	];
=TEX
\subsection{Full Existentials}
=SML
store_mt_results mt_run [ 
	("mk_¶ 1",
	mk_¶,
	(v1, mk_t),
	mk_app(mk_const("¶",mk_­_type(mk_­_type(tv1,BOOL),BOOL)),
		mk_Ì(v1,mk_t))),
	("mk_¶ 2",
	mk_¶,
	(mk_pair(v1,v2), mk_t),
	mk_app(mk_const("¶",mk_­_type(mk_­_type(
			mk_¸_type(tv1,tv2),BOOL),
			BOOL)),
		mk_Ì(mk_pair(v1,v2),mk_t)))
	];
store_mt_results mt_run_fail [
	("mk_¶ 3015",
	mk_¶,
	(v1,v1),
	gen_fail_msg "mk_¶" 3015 ["","¬v1®"]),
	("mk_¶ 4016",
	mk_¶,
	(c1,v1),
	gen_fail_msg "mk_¶" 4016 ["¬c1®"])
	];
store_mt_results mt_run [ 
	("dest_¶",
	dest_¶,
	mk_¶(mk_pair(v1,v2), mk_t),
	(mk_pair(v1,v2), mk_t))
	];
store_mt_results mt_run_fail [
	("dest_¶ 4020",
	dest_¶,
	c1,
	gen_fail_msg "dest_¶" 4020 ["¬c1®"])
	];
store_mt_results mt_run [ 
	("is_¶ 1",
	is_¶,
	mk_t,
	false),
	("is_¶ 2",
	is_¶,
	mk_¶(mk_pair(v1,v2), mk_t),
	true)
	];
store_mt_results mt_run [ 
	("list_mk_¶ 1",
	list_mk_¶,
	([],mk_t),
	mk_t),
	("list_mk_¶ 2",
	list_mk_¶,
	([v1,v2],mk_t),
	mk_¶(v1,mk_¶(v2,mk_t)))
	];
store_mt_results mt_run_fail [
	("list_mk_¶ 3015",
	list_mk_¶,
	([v1],c2),
	gen_fail_msg "mk_¶" 3015 ["","¬c2®"]),
	("list_mk_¶ 4016",
	list_mk_¶,
	([c1],c2),
	gen_fail_msg "mk_¶" 4016 ["¬c1®"])
	];
store_mt_results mt_run [ 
	("strip_¶ 1",
	strip_¶,
	mk_t,
	([],mk_t)),
	("strip_¶ 2",
	strip_¶,
	list_mk_¶([v1,mk_pair(v2,v11)],mk_t),
	([v1,mk_pair(v2,v11)],mk_t))
	];
store_mt_results mt_run [ 
	("strip_simple_¶ 1",
	strip_simple_¶,
	mk_t,
	([],mk_t)),
	("strip_simple_¶ 2",
	strip_simple_¶,
	list_mk_¶([v1,mk_pair(v2,v11)],mk_t),
	([v1],mk_¶(mk_pair(v2,v11),mk_t)))
	];
=TEX
\subsection{Simple Unique Existentials}
=SML
store_mt_results mt_run [ 
	("mk_simple_¶%down%1 1",
	mk_simple_¶%down%1,
	(v1, mk_t),
	mk_app(mk_const("¶%down%1",mk_­_type(mk_­_type(tv1,BOOL),BOOL)),
		mk_Ì(v1,mk_t)))
	];
store_mt_results mt_run_fail [
	("mk_simple_¶%down%1 3015",
	mk_simple_¶%down%1,
	(v1,v1),
	gen_fail_msg "mk_simple_¶%down%1" 3015 ["","¬v1®"]),
	("mk_simple_¶%down%1 3007 a",
	mk_simple_¶%down%1,
	(c1,v1),
	gen_fail_msg "mk_simple_¶%down%1" 3007 ["¬c1®"]),
	("mk_simple_¶%down%1 3007 b",
	mk_simple_¶%down%1,
	(mk_pair(v1,v2),mk_t),
	gen_fail_msg "mk_simple_¶%down%1" 3007 ["¬(v1, v2)®"])
	];
store_mt_results mt_run [ 
	("dest_simple_¶%down%1",
	dest_simple_¶%down%1,
	mk_simple_¶%down%1(v1, mk_t),
	(v1, mk_t))
	];
store_mt_results mt_run_fail [
	("dest_simple_¶%down%1 4019",
	dest_simple_¶%down%1,
	c1,
	gen_fail_msg "dest_simple_¶%down%1" 4019 ["¬c1®"])
	];
store_mt_results mt_run [ 
	("is_simple_¶%down%1 1",
	is_simple_¶%down%1,
	mk_t,
	false),
	("is_simple_¶%down%1 2",
	is_simple_¶%down%1,
	mk_simple_¶%down%1(v1, mk_t),
	true)
	];
=TEX
\subsection{Full Unique Existentials}
=SML
store_mt_results mt_run [ 
	("mk_¶%down%1 1",
	mk_¶%down%1,
	(v1, mk_t),
	mk_app(mk_const("¶%down%1",mk_­_type(mk_­_type(tv1,BOOL),BOOL)),
		mk_Ì(v1,mk_t))),
	("mk_¶%down%1 2",
	mk_¶%down%1,
	(mk_pair(v1,v2), mk_t),
	mk_app(mk_const("¶%down%1",mk_­_type(mk_­_type(
			mk_¸_type(tv1,tv2),BOOL),
			BOOL)),
		mk_Ì(mk_pair(v1,v2),mk_t)))
	];
store_mt_results mt_run_fail [
	("mk_¶%down%1 3015",
	mk_¶%down%1,
	(v1,v1),
	gen_fail_msg "mk_¶%down%1" 3015 ["","¬v1®"]),
	("mk_¶%down%1 4016",
	mk_¶%down%1,
	(c1,v1),
	gen_fail_msg "mk_¶%down%1" 4016 ["¬c1®"])
	];
store_mt_results mt_run [ 
	("dest_¶%down%1",
	dest_¶%down%1,
	mk_¶%down%1(mk_pair(v1,v2), mk_t),
	(mk_pair(v1,v2), mk_t))
	];
store_mt_results mt_run_fail [
	("dest_¶%down%1 4021",
	dest_¶%down%1,
	c1,
	gen_fail_msg "dest_¶%down%1" 4021 ["¬c1®"])
	];
store_mt_results mt_run [ 
	("is_¶%down%1 1",
	is_¶%down%1,
	mk_t,
	false),
	("is_¶%down%1 2",
	is_¶%down%1,
	mk_¶%down%1(mk_pair(v1,v2), mk_t),
	true)
	];
=TEX
\subsection{Full Choice}
=SML
store_mt_results mt_run [ 
	("mk_Í 1",
	mk_Í,
	(v1, mk_t),
	mk_app(mk_const("Í",mk_­_type(mk_­_type(tv1,BOOL),tv1)),
		mk_Ì(v1,mk_t))),
	("mk_Í 2",
	mk_Í,
	(mk_pair(v1,v2), mk_t),
	mk_app(mk_const("Í",mk_­_type(mk_­_type(
			mk_¸_type(tv1,tv2),BOOL),
			mk_¸_type(tv1,tv2))),
		mk_Ì(mk_pair(v1,v2),mk_t)))
	];
store_mt_results mt_run_fail [
	("mk_Í 3015",
	mk_Í,
	(v1,v1),
	gen_fail_msg "mk_Í" 3015 ["","¬v1®"]),
	("mk_Í 4016",
	mk_Í,
	(c1,v1),
	gen_fail_msg "mk_Í" 4016 ["¬c1®"])
	];
store_mt_results mt_run [ 
	("dest_Í",
	dest_Í,
	mk_Í(mk_pair(v1,v2), mk_t),
	(mk_pair(v1,v2), mk_t))
	];
store_mt_results mt_run_fail [
	("dest_Í 4023",
	dest_Í,
	c1,
	gen_fail_msg "dest_Í" 4023 ["¬c1®"])
	];
store_mt_results mt_run [ 
	("is_Í 1",
	is_Í,
	mk_t,
	false),
	("is_Í 2",
	is_Í,
	mk_Í(mk_pair(v1,v2), mk_t),
	true)
	];
store_mt_results mt_run [ 
	("list_mk_Í 1",
	list_mk_Í,
	([],mk_t),
	mk_t),
	("list_mk_Í 2",
	list_mk_Í,
	([v1,mk_var("v",BOOL)],mk_t),
	mk_Í(v1,mk_Í(mk_var("v",BOOL),mk_t)))
	];
store_mt_results mt_run_fail [
	("list_mk_Í 3015 a",
	list_mk_Í,
	([v1],c2),
	gen_fail_msg "mk_Í" 3015 ["","¬c2®"]),
	("list_mk_Í 4016",
	list_mk_Í,
	([c1],c1),
	gen_fail_msg "mk_Í" 4016 ["¬c1®"]),
	("list_mk_Í 3015 b",
	list_mk_Í,
	([v1,v2],c1),
	gen_fail_msg "mk_Í" 3015 ["","¬Í v2· c1®"])
	];
store_mt_results mt_run [ 
	("strip_Í 1",
	strip_Í,
	mk_t,
	([],mk_t)),
	("strip_Í 2",
	strip_Í,
	list_mk_Í([mk_pair(v2,v11),mk_var("v",BOOL)],mk_t),
	([mk_pair(v2,v11),mk_var("v",BOOL)],mk_t))
	];
=TEX
\subsection{Destroyed Terms}
It is convenient to do these tests out of sequence with
the detailed design.
=SML
store_mt_results mt_run [ 
	("dest_term 1",
	dest_term,
	mk_var ("v2",BOOL),
	DVar ("v2",BOOL)),
	("dest_term 2",
	dest_term,
	mk_const ("c2",BOOL),
	DConst ("c2",BOOL)),
	("dest_term 3",
	dest_term,
	mk_app (f,c1),
	DApp (f,c1)),
	("dest_term 4",
	dest_term,
	mk_Ì (f,c1),
	DÌ (f,c1)),
	("dest_term 5",
	dest_term,
	mk_Ì (mk_pair(v1,v2),c1),
	DÌ (mk_pair(v1,v2),c1)),
	("dest_term 6",
	dest_term,
	mk_eq (mk_î 1,mk_î 1),
	DEq(mk_î 1,mk_î 1)),
	("dest_term 6.1",
	dest_term,
	mk_´ (mk_t,mk_f),
	D´(mk_t,mk_f)),
	("dest_term 6.2",
	dest_term,
	mk_³ mk_t,
	D³ mk_t),
	("dest_term 7",
	dest_term,
	mk_pair(v1,v2),
	DPair(v1,v2)),
	("dest_term 8",
	dest_term,
	mk_± (mk_t,c1),
	D±(mk_t,c1)),
	("dest_term 9",
	dest_term,
	mk_² (mk_t,c1),
	D²(mk_t,c1)),
	("dest_term 10",
	dest_term,
	mk_¤ (mk_t,c1),
	D¤(mk_t,c1)),
	("dest_term 11",
	dest_term,
	mk_eq (mk_t,c1),
	D¤(mk_t,c1)),
	("dest_term 12",
	dest_term,
	mk_let([(mk_pair(v1, v11), cp1),(v2,cv2)],mk_t),
	DLet([(mk_pair(v1, v11), cp1),(v2,cv2)],mk_t)),
	("dest_term 13 a",
	dest_term,
	mk_enum_set [mk_t,mk_f,c1],
	DEnumSet [mk_t,mk_f,c1]),
	("dest_term 13 b",
	dest_term,
	mk_š BOOL,
	Dš BOOL),
	("dest_term 14",
	dest_term,
	mk_set_comp(mk_pair(v1,v2), mk_t),
	DSetComp (mk_pair(v1,v2), mk_t)),
	("dest_term 15",
	dest_term,
	mk_list [mk_t,mk_f,c1],
	DList [mk_t,mk_f,c1]),
	("dest_term 16 a",
	dest_term,
	mk_list [mk_t,mk_f,c1],
	DList [mk_t,mk_f,c1]),
	("dest_term 16 b",
	dest_term,
	mk_empty_list BOOL,
	DEmptyList BOOL),
	("dest_term 17",
	dest_term,
	mk_µ (mk_pair(v1,mk_pair(v2,v11)),mk_t),
	Dµ(mk_pair(v1,mk_pair(v2,v11)),mk_t)),
	("dest_term 18",
	dest_term,
	mk_¶ (mk_pair(v1,mk_pair(v2,v11)),mk_t),
	D¶(mk_pair(v1,mk_pair(v2,v11)),mk_t)),
	("dest_term 19",
	dest_term,
	mk_Í (mk_pair(v1,mk_pair(v2,v11)),mk_t),
	DÍ(mk_pair(v1,mk_pair(v2,v11)),mk_t)),
	("dest_term 20",
	dest_term,
	mk_if (mk_t,mk_î 1,mk_î 2),
	DIf(mk_t,mk_î 1,mk_î 2)),
	("dest_term 21",
	dest_term,
	list_mk_app (mk_const("g",mk_­_type(BOOL,
		mk_­_type(î,mk_­_type(î,BOOL)))),
		[mk_t,mk_î 1,mk_î 2]),
	DApp(list_mk_app (mk_const("g",mk_­_type(BOOL,mk_­_type(î,
		mk_­_type(î,BOOL)))),
		[mk_t,mk_î 1]),mk_î 2)),
	("dest_term 22",
	dest_term,
	mk_t,
	DT),
	("dest_term 23",
	dest_term,
	mk_f,
	DF),
	("dest_term 25",
	dest_term,
	mk_¶%down%1(vb,vb),
	D¶%down%1(vb,vb))
	];

store_mt_results mt_run [
	("mk_term 1",
	mk_term o dest_term,
	mk_var ("v2",BOOL),
	mk_var ("v2",BOOL)),
	("mk_term 2",
	mk_term o dest_term,
	mk_const ("c2",BOOL),
	mk_const ("c2",BOOL)),
	("mk_term 3",
	mk_term o dest_term,
	mk_app (f,c1),
	mk_app (f,c1)),
	("mk_term 4",
	mk_term o dest_term,
	mk_Ì (f,c1),
	mk_Ì (f,c1)),
	("mk_term 5",
	mk_term o dest_term,
	mk_Ì (mk_pair(v1,v2),c1),
	mk_Ì (mk_pair(v1,v2),c1)),
	("mk_term 6",
	mk_term o dest_term,
	mk_eq (mk_î 1,mk_î 1),
	mk_eq(mk_î 1,mk_î 1)),
	("mk_term 6.1",
	mk_term o dest_term,
	mk_´ (mk_t,mk_f),
	mk_´ (mk_t,mk_f)),
	("mk_term 6.2",
	mk_term o dest_term,
	mk_³ mk_t,
	mk_³ mk_t),
	("mk_term 7",
	mk_term o dest_term,
	mk_pair(v1,v2),
	mk_pair(v1,v2)),
	("mk_term 8",
	mk_term o dest_term,
	mk_± (mk_t,c1),
	mk_±(mk_t,c1)),
	("mk_term 9",
	mk_term o dest_term,
	mk_² (mk_t,c1),
	mk_²(mk_t,c1)),
	("mk_term 10",
	mk_term o dest_term,
	mk_¤ (mk_t,c1),
	mk_¤(mk_t,c1)),
	("mk_term 11",
	mk_term o dest_term,
	mk_eq (mk_t,c1),
	mk_¤(mk_t,c1)),
	("mk_term 12",
	mk_term o dest_term,
	mk_let([(mk_pair(v1, v11), cp1),(v2,cv2)],mk_t),
	mk_let([(mk_pair(v1, v11), cp1),(v2,cv2)],mk_t)),
	("mk_term 13 a",
	mk_term o dest_term,
	mk_enum_set [mk_t,mk_f,c1],
	mk_enum_set [mk_t,mk_f,c1]),
	("mk_term 13 b",
	mk_term o dest_term,
	mk_š BOOL,
	mk_š BOOL),
	("mk_term 14",
	mk_term o dest_term,
	mk_set_comp(mk_pair(v1,v2), mk_t),
	mk_set_comp (mk_pair(v1,v2), mk_t)),
	("mk_term 15",
	mk_term o dest_term,
	mk_list [mk_t,mk_f,c1],
	mk_list [mk_t,mk_f,c1]),
	("mk_term 16 a",
	mk_term o dest_term,
	mk_list [mk_t,mk_f,c1],
	mk_list [mk_t,mk_f,c1]),
	("mk_term 16 b",
	mk_term o dest_term,
	mk_empty_list BOOL,
	mk_empty_list BOOL),
	("mk_term 17",
	mk_term o dest_term,
	mk_µ (mk_pair(v1,mk_pair(v2,v11)),mk_t),
	mk_µ(mk_pair(v1,mk_pair(v2,v11)),mk_t)),
	("mk_term 18",
	mk_term o dest_term,
	mk_¶ (mk_pair(v1,mk_pair(v2,v11)),mk_t),
	mk_¶(mk_pair(v1,mk_pair(v2,v11)),mk_t)),
	("mk_term 19",
	mk_term o dest_term,
	mk_Í (mk_pair(v1,mk_pair(v2,v11)),mk_t),
	mk_Í(mk_pair(v1,mk_pair(v2,v11)),mk_t)),
	("mk_term 20",
	mk_term o dest_term,
	mk_if (mk_t,mk_î 1,mk_î 2),
	mk_if(mk_t,mk_î 1,mk_î 2)),
	("mk_term 21",
	mk_term o dest_term,
	list_mk_app (mk_const("g",mk_­_type(BOOL,mk_­_type(î,mk_­_type(î,BOOL)))),
		[mk_t,mk_î 1,mk_î 2]),
	list_mk_app (mk_const("g",mk_­_type(BOOL,mk_­_type(î,mk_­_type(î,BOOL)))),
		[mk_t,mk_î 1,mk_î 2])),
	("mk_term 22",
	mk_term o dest_term,
	mk_t,
	mk_t),
	("mk_term 23",
	mk_term o dest_term,
	mk_f,
	mk_f),
	("mk_term 24",
	mk_term o dest_term,
	mk_¶%down%1(vb,vb),
	mk_¶%down%1(vb,vb))
	];
=TEX
\subsection{End of Tests}
=SML
diag_string(summarize_mt_results());
=TEX
\section{UNTESTED FUNCTIONS}
\label{untested}
The following functions are not tested, on the assumption they are
each used to implement a function tested in this document,
which can be checked in \cite{DS/FMU/IED/IMP004}.
=GFT
dest_binder
is_binder
list_mk_binder
mk_binder
strip_binder
strip_simple_binder
=TEX

\end{document}


