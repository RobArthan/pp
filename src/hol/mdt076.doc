% $Id$ %Z%
=TEX
\documentstyle[hol1,11pt,TQ]{article}
\ftlinepenalty=9999
\makeindex
\TPPproject{FST PROJECT}  %% Mandatory field
%\TPPvolume{}
%\TPPpart{}
\TPPtitle{Module Tests for the Supplied Proof Contexts}  %% Mandatory field
\def\TPPheadtitle{Module Tests for the Supplied Proof Contexts}
\TPPref{DS/FMU/IED/MDT076}  %% Mandatory field
\def\SCCSversion{$Revision$ %
}
\TPPissue{\SCCSversion}  %% Mandatory field
\TPPdate{\FormatDate{$Date$ %
}}
\TPPstatus{Draft}			%% Mandatory field
\TPPtype{ML Literate Script}
\TPPkeywords{}
\TPPauthor{K.Blackburn & WIN01}  %% Mandatory field
%\TPPauthors{Name 1&location 1\\Name 2&location 2\\Name 3&location 3}
\TPPauthorisation{R.D.Arthan & Project Manager}
\TPPabstract{A set of module tests are given for the 
the supplied proof contexts.}
\TPPdistribution{\parbox[t]{4.0in}{%
	    Library
}}
\begin{document}
\makeTPPfrontpage
\vfill
\begin{centering}

\bf Copyright \copyright\ : International Computers Ltd \number\year

\end{centering}
\pagebreak
\section{DOCUMENT CONTROL}
\subsection{Contents List}
\tableofcontents
\subsection{Document Cross References}
\bibliographystyle{fmu}
\bibliography{fmu}

\subsection{Changes History} 
\begin{description}
\item [Issue 1.1,1.2,1.3]
First drafts.
\item [Issue 1.4 (27th May 1992)]
Bug fixing.
\end{description}
\subsection{Changes Forecast}
None.
\section{GENERAL}
\subsection{Scope}
This document contains the module testing of the supplied proof contexts.
The design is in \cite{DS/FMU/IED/DTD076}
and it is
implemented in \cite{DS/FMU/IED/IMP076}.

\subsection{Introduction}
\subsubsection{Purpose and Background}
This document contains the module testing of the material given a design in \cite{DS/FMU/IED/DTD076},
following the test policy given in that document and the general policy given in \cite{DS/FMU/IED/PLN008}.

\subsubsection{Dependencies}
This document is derived from the detailed design in \cite{DS/FMU/IED/DTD076},
and is further influenced by the implementation, in  \cite{DS/FMU/IED/IMP076}.
\subsubsection{Deficiencies}
None known.
\section{TEST CASES}
We test the two functions of the signature of \cite{DS/FMU/IED/DTD076}
in turn.
We then test for the presence, effect, and ``out of problem domain'' for each supplied prof context.
\section{PROLOGUE}
Initialise the test package:
=SML
use_file "dtd013.sml";
use_file "imp013.sml";
init_mt_results();
=TEX
=SML
open_theory "basic_hol";
set_pc "basic_hol";
=TEX
\section{FUNCTIONS}
=SML
store_mt_results (mt_runf (op =$)) [("supplied_prove_tac 1",
	concl o tac_proof,
	(([],¨µ x ∑ x = xÆ),supplied_prove_tac []),
	¨µ x ∑ x = xÆ),
	("supplied_prove_tac 2",
	concl o tac_proof,
	(([],concl prim_rec_thm),supplied_prove_tac [prim_rec_thm]),
	concl prim_rec_thm)];
=TEX
=SML
store_mt_results (mt_runf (op =$)) [("supplied_prove_conv 1",
	concl o supplied_prove_conv [],
	¨µ x ∑ x = xÆ,
	¨(µ x ∑ x = x) § TÆ),
	("supplied_prove_conv 2",
	concl o supplied_prove_conv [prim_rec_thm],
	concl prim_rec_thm,
	mk_§(concl prim_rec_thm, mk_t))];
store_mt_results mt_run_fail [("supplied_prove_conv 76001",
	supplied_prove_conv [],
	mk_f,
	gen_fail_msg "supplied_prove_conv" 76001 ["¨FÆ"])];
=TEX

\section{SUPPLIED PROOF CONTEXTS}
\subsection{Test Functions}
=SML
fun lprove_rule tm = tac_proof(([],tm),
	TRY_T(rewrite_tac[]) THEN
	REPEAT strip_tac)
	handle complaint =>
	divert complaint "tac_proof" "lprove_rule" 76001
		[fn () => string_of_term tm];
=TEX
\subsection{Proof Context: ``initial''}
=SML
set_pc "initial";
store_mt_results (mt_runf (op =$)) [("proof context initial",
	concl o lprove_rule,
	¨a ¥ aÆ,
	¨a ¥ aÆ)];
store_mt_results mt_run_fail [("proof context initial does not apply",
	lprove_rule,
	¨a § aÆ,
	gen_fail_msg "lprove_rule" 76001 ["¨a § aÆ"])];
=TEX

\subsection{Proof Context: ``basic$\_$prove$\_∂\_$conv''}
=SML
set_pc "basic_prove_∂_conv";
store_mt_results (mt_runf (op =$)) [("proof context basic_prove_∂_conv",
	concl o prove_∂_conv,
	¨∂ x ∑ x = 1Æ,
	¨(∂ x ∑ x = 1) § TÆ)];
store_mt_results mt_run_fail [("proof context basic_prove_∂_conv does not apply a",
	lprove_rule,
	¨a § aÆ,
	gen_fail_msg "lprove_rule" 76001 ["¨a § aÆ"])];
=TEX
\subsection{Proof Context: ``simple$\_$abstractions''}
=SML
set_pc "simple_abstractions";
store_mt_results (mt_runf (op =$)) [("proof context simple_abstractions",
	concl o lprove_rule,
	¨(≥(a ≤ b)) ¥ ≥ aÆ,
	¨(≥(a ≤ b)) ¥ ≥ aÆ)];
store_mt_results mt_run_fail [("proof context simple_abstractions does not apply a",
	lprove_rule,
	¨a § aÆ,
	gen_fail_msg "lprove_rule" 76001 ["¨a § aÆ"]),
	("proof context simple_abstractions does not apply b",
	lprove_rule,
	¨µ (x, y)∑ x ¥ xÆ,
	gen_fail_msg "lprove_rule" 76001 ["¨µ (x, y)∑ x ¥ xÆ"])];
=TEX
\subsection{Proof Context: ``paired$\_$abstractions''}
=SML

set_pc "paired_abstractions";
store_mt_results (mt_runf (op =$)) [("proof context paired_abstractions",
	concl o lprove_rule,
	¨µ (x, y)∑ x ¥ xÆ,
	¨µ (x, y)∑ x ¥ xÆ)];
store_mt_results mt_run_fail [("proof context paired_abstractions does not apply",
	lprove_rule,
	¨a § aÆ,
	gen_fail_msg "lprove_rule" 76001 ["¨a § aÆ"])];
=TEX
\subsection{Proof Context: ``propositions''}
=SML
set_pc "propositions";
store_mt_results (mt_runf (op =$)) [("proof context propositions",
	concl o lprove_rule,
	¨a § aÆ,
	¨a § aÆ)];
store_mt_results mt_run_fail [("proof context propositions does not apply",
	lprove_rule,
	¨≥(a ≤ b) ¥ aÆ,
	gen_fail_msg "lprove_rule" 76001 ["¨≥ (a ≤ b) ¥ aÆ"])];
=TEX
\subsection{Proof Context: ``fun$\_$ext''}
=SML
set_pc "fun_ext";
store_mt_results (mt_runf (op =$)) [("proof context fun_ext",
	concl o lprove_rule,
	¨(µ x ∑ f x = g x) ¥ (f = g)Æ,
	¨(µ x ∑ f x = g x) ¥ (f = g)Æ)];
store_mt_results mt_run_fail [("proof context fun_ext does not apply",
	lprove_rule,
	¨a § aÆ,
	gen_fail_msg "lprove_rule" 76001 ["¨a § aÆ"])];
=TEX
\subsection{Proof Context: ``predicates''}
=SML
set_pc "predicates";
store_mt_results (mt_runf (op =$)) [("proof context predicates",
	concl o lprove_rule,
	¨µ (x,y) ∑ ≥(x ± y) ¥ ≥ x ≤ ≥ yÆ,
	¨µ (x,y) ∑ ≥(x ± y) ¥ ≥ x ≤ ≥ yÆ)];
store_mt_results mt_run_fail [("proof context predicates does not apply",
	lprove_rule,
	¨(µ x ∑ f x = g x) ¥ (f = g)Æ,
	gen_fail_msg "lprove_rule" 76001 ["¨(µ x∑ f x = g x) ¥ f = gÆ"])];
=TEX
\subsection{Proof Context: ``predicates1''}
=SML
set_pc "predicates1";
store_mt_results (mt_runf (op =$)) [("proof context predicates1",
	concl o lprove_rule,
	¨(µ x ∑ f x = g x) § (f = g)Æ,
	¨(µ x ∑ f x = g x) § (f = g)Æ)];
store_mt_results mt_run_fail [("proof context predicates1 does not apply",
	lprove_rule,
	¨(a, b) = (c, d) ¥ a = cÆ,
	gen_fail_msg "lprove_rule" 76001 ["¨(a, b) = (c, d) ¥ a = cÆ"])];
=TEX
\subsection{Proof Context: ``pair''}
=SML
set_pc "pair";
store_mt_results (mt_runf (op =$)) [("proof context pair",
	concl o lprove_rule,
	¨((a, b) = (c, d)) ¥ a = cÆ,
	¨((a, b) = (c, d)) ¥ a = cÆ)];
store_mt_results mt_run_fail [("proof context pair does not apply a",
	lprove_rule,
	¨a § aÆ,
	gen_fail_msg "lprove_rule" 76001 ["¨a § aÆ"]),
	("proof context pair does not apply b",
	lprove_rule,
	¨((a, b) = c) ¥ a = Fst cÆ,
	gen_fail_msg "lprove_rule" 76001 ["¨(a, b) = c ¥ a = Fst cÆ"])];
=TEX
\subsection{Proof Context: ``pair1''}
=SML
set_pc "pair1";
store_mt_results (mt_runf (op =$)) [("proof context pair1",
	concl o lprove_rule,
	¨((a, b) = c) ¥ a = Fst cÆ,
	¨((a, b) = c) ¥ a = Fst cÆ)];
store_mt_results mt_run_fail [("proof context pair1 does not apply",
	lprove_rule,
	¨a § aÆ,
	gen_fail_msg "lprove_rule" 76001 ["¨a § aÆ"])];
=TEX
\subsection{Proof Context: ``Ó''}
=SML
set_pc "Ó";
store_mt_results (mt_runf (op =$)) [
	("proof context Ó",
	concl o lprove_rule,
	¨0 º xÆ,
	¨0 º xÆ)];
store_mt_results mt_run_fail [("proof context Ó does not apply a",
	lprove_rule,
	¨≥(1 = 0)Æ,
	gen_fail_msg "lprove_rule" 76001 ["¨≥ 1 = 0Æ"]),
	("proof context Ó does not apply b",
	lprove_rule,
	¨2 + 3 = 5Æ,
	gen_fail_msg "lprove_rule" 76001 ["¨2 + 3 = 5Æ"])];
=TEX
\subsection{Proof Context: ``Ó$\_$lit''}
=SML
set_pc "Ó_lit";
store_mt_results (mt_runf (op =$)) [("proof context Ó_lit",
	concl o lprove_rule,
	¨2 + 3 = 5Æ,
	¨2 + 3 = 5Æ)];
store_mt_results mt_run_fail [("proof context Ó_lit does not apply",
	lprove_rule,
	¨0 º xÆ,
	gen_fail_msg "lprove_rule" 76001 ["¨0 º xÆ"])];
=TEX
\subsection{Proof Context: ``list''}
=SML
set_pc "list";
store_mt_results (mt_runf (op =$)) [("proof context list",
	concl o lprove_rule,
	¨[a] = [b] ¥ a = bÆ,
	¨[a] = [b] ¥ a = bÆ)];
store_mt_results mt_run_fail [("proof context list does not apply",
	lprove_rule,
	¨a § aÆ,
	gen_fail_msg "lprove_rule" 76001 ["¨a § aÆ"])];
=TEX
\subsection{Proof Context: ``char''}
=SML
set_pc "char";
store_mt_results (mt_runf (op =$)) [("proof context char",
	concl o lprove_rule,
	¨"ab" = "cd" ¥ xÆ,
	¨"ab" = "cd" ¥ xÆ)];
store_mt_results mt_run_fail [("proof context char does not apply",
	lprove_rule,
	¨a § aÆ,
	gen_fail_msg "lprove_rule" 76001 ["¨a § aÆ"])];
=TEX
\subsection{Proof Context: ``basic$\_$hol''}
=SML
set_pc "basic_hol";
store_mt_results (mt_runf (op =$)) [("proof context basic_hol",
	concl o lprove_rule,
	¨≥(0 = 1) ± ≥("ab" = "ac")Æ,
	¨≥(0 = 1) ± ≥("ab" = "ac")Æ)];
store_mt_results mt_run_fail [("proof context basic_hol does not apply",
	lprove_rule,
	¨2 + 3 = 5Æ,
	gen_fail_msg "lprove_rule" 76001 ["¨2 + 3 = 5Æ"])];
=TEX
\subsection{Proof Context: ``basic$\_$hol1''}
=SML
set_pc "basic_hol1";
store_mt_results (mt_runf (op =$)) [("proof context basic_hol1",
	concl o lprove_rule,
	¨3 - (2+1) º xÆ,
	¨3 - (2+1) º xÆ)];
store_mt_results mt_run_fail [("proof context basic_hol1 does not apply",
	lprove_rule,
	¨FÆ,
	gen_fail_msg "lprove_rule" 76001 ["¨FÆ"])];
=TEX
\subsection{Proof Context: ``sum''}
=SML
open_theory "sum";
set_pc "sum";
store_mt_results (mt_runf (op =$)) [("proof context sum",
	concl o lprove_rule,
	¨InL x = InR x ¥ yÆ,
	¨InL x = InR x ¥ yÆ)];
store_mt_results mt_run_fail [("proof context sum does not apply",
	lprove_rule,
	¨a § aÆ,
	gen_fail_msg "lprove_rule" 76001 ["¨a § aÆ"])];
=TEX
\subsection{Proof Context: ``one''}
=SML
open_theory "one";
set_pc "one";
store_mt_results (mt_runf (op =$)) [("proof context one",
	concl o lprove_rule,
	¨(x:ONE) = yÆ,
	¨(x:ONE) = yÆ)];
store_mt_results mt_run_fail [("proof context one does not apply",
	lprove_rule,
	¨a § aÆ,
	gen_fail_msg "lprove_rule" 76001 ["¨a § aÆ"])];
=TEX
\subsection{Proof Context: ``combin''}
=SML
open_theory "combin";
set_pc "combin";
store_mt_results (mt_runf (op =$)) [("proof context combin",
	concl o lprove_rule,
	¨CombK T FÆ,
	¨CombK T FÆ)];
store_mt_results mt_run_fail [("proof context combin does not apply",
	lprove_rule,
	¨a § aÆ,
	gen_fail_msg "lprove_rule" 76001 ["¨a § aÆ"])];
=TEX
\subsection{Proof Context: ``sets$\_$alg''}
=SML
open_theory "sets";
set_pc "sets_alg";
store_mt_results (mt_runf (op =$)) [("proof context sets_alg",
	concl o lprove_rule,
	¨x ç UniverseÆ,
	¨x ç UniverseÆ)];
store_mt_results mt_run_fail [("proof context  does not apply",
	lprove_rule,
	¨a = b ¥ {v | a} = {w | b}Æ,
	gen_fail_msg "lprove_rule" 76001 ["¨(a § b) ¥ {v|a} = {w|b}Æ"])];
=TEX
\subsection{Proof Context: ``sets$\_$ext''}
=SML
open_theory "sets";
set_pc "sets_ext";
store_mt_results (mt_runf (op =$)) [("proof context sets_ext",
	concl o lprove_rule,
	¨a = b ¥ {v | a} = {w | b}Æ,
	¨a = b ¥ {v | a} = {w | b}Æ)];
store_mt_results mt_run_fail [("proof context sets_ext does not apply a",
	lprove_rule,
	¨a § aÆ,
	gen_fail_msg "lprove_rule" 76001 ["¨a § aÆ"]),
	("proof context sets_ext does not apply b",
	lprove_rule,
	¨a ° b = b ° aÆ,
	gen_fail_msg "lprove_rule" 76001 ["¨a ° b = b ° aÆ"])];
=TEX
\subsection{Proof Context: ``hol''}
=SML
open_theory "hol";
set_pc "hol";
store_mt_results (mt_runf (op =$)) [("proof context hol",
	concl o lprove_rule,
	¨(x ç a ° b) § (x ç b ° a)Æ,
	¨(x ç a ° b) § (x ç b ° a)Æ)];
store_mt_results mt_run_fail [("proof context hol does not apply",
	lprove_rule,
	¨a ° b = b ° aÆ,
	gen_fail_msg "lprove_rule" 76001 ["¨a ° b = b ° aÆ"])];
=TEX
\subsection{Proof Context: ``hol1''}
=SML
open_theory "hol";
set_pc "hol1";
store_mt_results (mt_runf (op =$)) [("proof context hol1",
	concl o lprove_rule,
	¨a ° b = b ° aÆ,
	¨a ° b = b ° aÆ)];
store_mt_results mt_run_fail [("proof context hol1 does not apply",
	lprove_rule,
	¨FÆ,
	gen_fail_msg "lprove_rule" 76001 ["¨FÆ"])];
=TEX
=IGN
SPARE SPARE SPARE SPARE SPARE SPARE SPARE SPARE SPARE 
\subsection{Proof Context: ``''}
 =SML
set_pc "";
store_mt_results (mt_runf (op =$)) [("proof context ",
	concl o lprove_rule,
	¨Æ,
	¨Æ)];
store_mt_results mt_run_fail [("proof context  does not apply",
	lprove_rule,
	¨Æ,
	gen_fail_msg "lprove_rule" 76001 ["¨Æ"])];
=TEX
\subsection{End of Tests}
=SML
diag_string(summarize_mt_results());
=TEX
\end{document}


