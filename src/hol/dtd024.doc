% dtd024.doc   %Z% $Date$ $Revision$ $RCSfile$

=TEX
% dtd024.doc   %Z% $Date$ $Revision$ $RCSfile$
\documentstyle[hol,11pt,TQ]{article}

\TPPtitle{Detailed Design of `Oppen' Formatting Routines}
\TPPref{DS/FMU/IED/DTD024}
\def\SCCSissue{$Revision$%
}
\TPPissue{\SCCSissue}
\TPPdate{\FormatDate{$Date$%
}}
\TPPproject{FST PROJECT}

=IGN

Commands to process this document in various ways.

doc4errors dtd024
usefile "dtd024.sml";

make -f rel001.mkf dtd024.dvi
doc4tex dtd024
tex4dvi dtd024
bibtex dtd024
doc4tex dtd024 ; tex4dvi dtd024
dvipage dtd024 &


doc4errors dtd024
usefile "dtd024.sml";

lasp -s dtd024.doc > zz1
lasp -s -u dtd024.OKwords dtd024.doc > zz1

=TEX
\TPPstatus{Draft}			%% Mandatory field
\TPPtype{Specification}
\TPPkeywords{HOL}
\TPPauthor{A.J. Hammon & WIN01}  %% Mandatory field
\TPPauthorisation{R.B.~Jones & FMU Manager}
\TPPabstract{This document contains Oppen-style formatting routines for
	Release~1 of ICL~HOL.}
\TPPdistribution{\parbox[t]{4.0in}{%
	Library
}}

%\ftlinepenalty=9999
\makeindex

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\catcode`\_=\active
\def\_{\kern.06em\vbox{\hrule height.1ex width.3em}\hskip0.1em\relax}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}
\makeTPPfrontpage

\vfill
\begin{center}
\bf Copyright \copyright\ : International Computers Ltd \number\year
\end{center}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage
\section{DOCUMENT CONTROL}

%********************************************************************

\subsection{Contents List}
\tableofcontents
% \listoftables

%********************************************************************

\subsection{Document Cross References}

\bibliographystyle{fmu}
\bibliography{fmu}

%********************************************************************

\subsection{Changes History}

\begin{description}

\item[31 May 1991, issue 1.1 ] This issue is an authors draft, it
	contains a first draft of the Oppen-style formatting routines.
	In this case the implementation of the routines simply formats
	the argument text without attempting to lay it out neatly.

\item[\FormatDate{$Date$%
}, issue $Revision$
 ] Minor changes to allow the full Oppen-style formatting algorithms.

\end{description}

%********************************************************************

\subsection{Changes Forecast} \label{ChangesForecast}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\newpage
\section{GENERAL}

%********************************************************************

\subsection{Scope}

This document contains the Oppen-style formatting routines for Release~1 of
the ICL HOL system.

%********************************************************************

\subsection{Introduction}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{SIGNATURE} \label{StartSignature}

=DOC
signature âOppenFormattingá = sig
=DESCRIBE
=ENDDOC


%--------------------------------------------------------------------
=DOC
type âOPPEN_FUNSá	(*
		(    (string -> unit)		(* addstring *)
		*   (int * bool -> unit)		(* beginb *)
		*   (int * int -> unit)		(* space *)
		*   (unit -> unit)		(* endb *)		*);
=DESCRIBE
The routines that form the interface to the Oppen style
layout system~\cite{Oppen80}.
=FAILURE
24002	Failed to empty scan buffer
=FAILUREC
Error 24002 denotes an internal fault in the formatting routines.
=ENDDOC
%--------------------------------------------------------------------
=DOC
val âoppen_formatá :
		(unit -> int)			(* width *)
	->	(OPPEN_FUNS -> 'a -> unit)	(* printer *)
	->	'a				(* arg *)
	->	string list
=DESCRIBE
In the call `$oppen_format\;\;width\;\;printer\;\;arg$' the
string representation of the value of $arg$ is produced by the side
effects of function $printer$ which uses the Oppen-style printing
routines passed to it.  A complex value may be split across several
lines of text, one line per list element, the head element of the list
being the first line of the output.  The function $width$ yields the
maximum number of characters desired per line.  Longer lines may be
produced when an argument to the $addstring$ printing routine exceeds
the desired width.  The style of the interface is designed to be close
to that of function $PolyML.pretty_printer$ so that the same $printer$
function may be used for either.
=SEEALSO
Type $OPPEN_FUNS$ for function $addstring$.
=FAILURE
24001	Line width ?0 is too small, minimum is ?1
=ENDDOC
%--------------------------------------------------------------------
=DOC
val âoppen_printá :
		(unit -> int)			(* width *)
	->	(OPPEN_FUNS -> 'a -> unit)	(* printer *)
	->	'a				(* arg *)
	->	unit
=DESCRIBE
In the call `$oppen_print\;\;width\;\;printer\;\;arg$' the
the value of $arg$ is printed on the standard output by the side
effects of function $printer$ which uses the Oppen-style printing
routines passed to it.  A complex value may be split across several
lines of text.  The function $width$ yields the
maximum number of characters desired per line.  Longer lines may be
produced when an argument to the $addstring$ printing routine exceeds
the desired width.  The style of the interface is designed to be close
to that of function $PolyML.pretty_printer$ so that the same $printer$
function may be used for either.
=SEEALSO
Type $OPPEN_FUNS$ for function $addstring$.
=FAILURE
24001	Line width ?0 is too small, minimum is ?1
=ENDDOC
%--------------------------------------------------------------------

=SML
end (* of signature OppenFormatting *);
=TEX

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\end{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%********************************************************************
%--------------------------------------------------------------------

\newpage

\makeatletter
\def\refstepcounter#1{\stepcounter{#1}\global\edef\@currentlabel{\csname
	p@#1\endcsname\csname the#1\endcsname}}
\makeatother

\twocolumn[\section{INDEX}] \label{Index}

\footnotesize
\printindex

\onecolumn

\end{document}
