% mdt058.doc $Id$
=TEX
\documentstyle[hol,11pt,TQ]{article}
\ftlinepenalty=9999
\makeindex
\TPPproject{FST PROJECT}  %% Mandatory field
%\TPPvolume{}
%\TPPpart{}
\TPPtitle{Module Tests for Automatic Existence Proofs}  %% Mandatory field
\def\TPPheadtitle{Module Tests for Automatic Existence Proofs}
\TPPref{DS/FMU/IED/MDT058}  %% Mandatory field
\def\SCCSversion{$Revision$ %
}
\TPPissue{\SCCSversion}  %% Mandatory field
\TPPdate{\FormatDate{$Date$ %
}}
\TPPstatus{Draft}			%% Mandatory field
\TPPtype{ML Literate Script}
\TPPkeywords{}
\TPPauthor{K.Blackburn & WIN01}  %% Mandatory field
%\TPPauthors{Name 1&location 1\\Name 2&location 2\\Name 3&location 3}
\TPPauthorisation{R.D.Arthan & Project Manager}
\TPPabstract{A set of module tests are given for the 
the automatic existence proof tools.}
\TPPdistribution{\parbox[t]{4.0in}{%
	    Library
}}
\begin{document}
\makeTPPfrontpage
\vfill
\begin{centering}

\bf Copyright \copyright\ : International Computers Ltd \number\year

\end{centering}
\pagebreak
\section{DOCUMENT CONTROL}
\subsection{Contents List}
\tableofcontents
\subsection{Document Cross References}
\bibliographystyle{fmu}
\bibliography{fmu}

\subsection{Changes History} 
\begin{description}
\item [Issue 1.1]
First draft.
\end{description}
\subsection{Changes Forecast}
None.
\section{GENERAL}
\subsection{Scope}
This document contains the module testing of the automatic existence proof tools.
The design is in \cite{DS/FMU/IED/DTD058}
and it is
implemented in \cite{DS/FMU/IED/IMP058}.

\subsection{Introduction}
\subsubsection{Purpose and Background}
This document contains the module testing of the material given a design in \cite{DS/FMU/IED/DTD058},
following the test policy given in that document and the general policy given in \cite{DS/FMU/IED/PLN008}.

\subsubsection{Dependencies}
This document is derived from the detailed design in \cite{DS/FMU/IED/DTD058},
and is further influenced by the implementation, in  \cite{DS/FMU/IED/IMP058}.
\subsubsection{Deficiencies}
None known.
\section{TEST CASES}
We test each function of the signature of \cite{DS/FMU/IED/DTD058}
in turn, where possible in the same order as in the design document, testing both successful, and all error, cases.
We do not test for design errors, or the ``special case''
message 58015, in the later case as it is not certain that it can be provoked.
\section{PROLOGUE}
Initialise the test package:
=SML
usefile "dtd013.sml";
usefile "imp013.sml";
init_mt_results();
=TEX
=SML
open_theory "sum";
=TEX
=TEX
\section{SETTING THE PROOF CONTEXT}
To make the tests independent of some outside changes, we give a local 
proof context:
=SML
pop_proof_context();
push_proof_context prove_Ñ_epc;
=TEX
\section{THE TESTS OF COMPONENT FUNCTIONS}
\subsection{ALL$\_$SIMPLE$\_$É$\_$C}
=SML
store_mt_results mt_run [
	("ALL_SIMPLE_É_C 1",
	dest_thm o ALL_SIMPLE_É_C eq_sym_conv,
	ªÉ a b c:'a é a = bº,
	([],ª(É a b c:'a é a = b) = (É a b c:'a é b = a)º)),
	("ALL_SIMPLE_É_C 2",
	dest_thm o ALL_SIMPLE_É_C eq_sym_conv,
	ªÉ aé a = bº,
	([],ª(É aé a = b) = (É aé b = a)º)),
	("ALL_SIMPLE_É_C 3",
	dest_thm o ALL_SIMPLE_É_C eq_sym_conv,
	ªa = bº,
	([],ª(a = b) = (b = a)º))
	];
store_mt_results mt_run_fail [
	("ALL_SIMPLE_É_C 3014",
	ALL_SIMPLE_É_C eq_sym_conv,
	mk_t,
	gen_fail_msg "eq_sym_conv" 3014 ["ªTº"])
	];
=TEX
\subsection{ALL$\_$SIMPLE$\_$Ñ$\_$C}
=SML
store_mt_results mt_run [
	("ALL_SIMPLE_Ñ_C 1",
	dest_thm o ALL_SIMPLE_Ñ_C eq_sym_conv,
	ªÑ a b c:'a é a = bº,
	([],ª(Ñ a b c:'a é a = b) = (Ñ a b c:'a é b = a)º)),
	("ALL_SIMPLE_Ñ_C 2",
	dest_thm o ALL_SIMPLE_Ñ_C eq_sym_conv,
	ªÑ aé a = bº,
	([],ª(Ñ aé a = b) = (Ñ aé b = a)º)),
	("ALL_SIMPLE_Ñ_C 3",
	dest_thm o ALL_SIMPLE_Ñ_C eq_sym_conv,
	ªa = bº,
	([],ª(a = b) = (b = a)º))
	];
store_mt_results mt_run_fail [
	("ALL_SIMPLE_Ñ_C 3014",
	ALL_SIMPLE_Ñ_C eq_sym_conv,
	mk_t,
	gen_fail_msg "eq_sym_conv" 3014 ["ªTº"])
	];
=TEX
\subsection{ALL$\_$Ä$\_$C}
=SML
store_mt_results mt_run [
	("ALL_Ä_C 1",
	dest_thm o ALL_Ä_C eq_sym_conv,
	ªa Ä (a Ç b) Ä cº,
	([],ª(a Ä (a Ç b) Ä c) Ç (a Ä (b Ç a) Ä c)º)),
	("ALL_Ä_C 2",
	dest_thm o ALL_Ä_C eq_sym_conv,
	ª(a Ç b)º,
	([],ª(a Ç b) Ç (b Ç a)º))
	];
store_mt_results mt_run_fail [
	("ALL_Ä_C 3014",
	ALL_Ä_C eq_sym_conv,
	ªa Ä bº,
	gen_fail_msg "eq_sym_conv" 3014 ["ªbº"])
	];
=TEX
\subsection{ALL$\_$Å$\_$C}
=SML
store_mt_results mt_run [
	("ALL_Å_C 1",
	dest_thm o ALL_Å_C eq_sym_conv,
	ªa Å (a Ç b) Å cº,
	([],ª(a Å (a Ç b) Å c) Ç (a Å (b Ç a) Å c)º)),
	("ALL_Å_C 2",
	dest_thm o ALL_Å_C eq_sym_conv,
	ª(a Ç b)º,
	([],ª(a Ç b) Ç (b Ç a)º))
	];
store_mt_results mt_run_fail [
	("ALL_Å_C 3014",
	ALL_Å_C eq_sym_conv,
	ªa Å bº,
	gen_fail_msg "eq_sym_conv" 3014 ["ªbº"])
	];
=TEX
\subsection{simple$\_$Ñ$\_$Å$\_$conv}
=SML
store_mt_results mt_run [
	("simple_Ñ_Å_conv 1",
	dest_thm o simple_Ñ_Å_conv,
	ªÑ x y é f x Å g yº,
	([],ª(Ñ x y é f x Å g y) Ç (Ñ x é f x) Å (Ñ y é g y)º)),
	("simple_Ñ_Å_conv 2",
	dest_thm o simple_Ñ_Å_conv,
	ªÑ x y é f x Å g y Å h x y Å iº,
	([],ª(Ñ x y é f x Å g y Å h x y Å i) Ç 
		(Ñ x é f x) 
		Å (Ñ y é g y)
		Å (Ñ x y é h x y)
		Å iº))
	];
store_mt_results mt_run_fail [
	("simple_Ñ_Å_conv",
	simple_Ñ_Å_conv,
	mk_t,
	gen_fail_msg "simple_Ñ_Å_conv" 58010 ["ªTº"])
	];
=TEX

\subsection{simple$\_$Ñ$\_$Ä$\_$conv}
=SML
store_mt_results mt_run [
	("simple_Ñ_Ä_conv 1",
	dest_thm o simple_Ñ_Ä_conv,
	ªÑ x é P x Ä Qº,
	([],ª(Ñ x é P x Ä Q) Ç (Ñ x é P x) Ä Qº)),
	("simple_Ñ_Ä_conv 2",
	dest_thm o simple_Ñ_Ä_conv,
	ªÑ x é P Ä Q xº,
	([],ª(Ñ x:'a é P Ä Q x) Ç (Ñ x:'a é Q x) Ä Pº)),
	("simple_Ñ_Ä_conv 3",
	dest_thm o simple_Ñ_Ä_conv,
	ªÑ x y:'a é P x Ä Q yº,
	([],ª(Ñ x y :'aé P x Ä Q y) Ç (Ñ y:'a é Q y) Ä (Ñ x:'a éP x)º)),
	("simple_Ñ_Ä_conv 4",
	dest_thm o simple_Ñ_Ä_conv,
	ªÑ x y z:'a é P x z Ä Q y zº,
	([],ª(Ñ x y z :'aé P x z Ä Q y z) Ç 
	Ñ z :'aé (Ñ y :'aé Q y z) Ä (Ñ x :'aéP x z)º))
	];
store_mt_results mt_run_fail [
	("simple_Ñ_Ä_conv",
	simple_Ñ_Ä_conv,
	mk_t,
	gen_fail_msg "simple_Ñ_Ä_conv" 58012 ["ªTº"])
	];
=TEX
\subsection{É$\_$Ä$\_$conv}
=SML
store_mt_results mt_run [
	("simple_É_Ä_conv 1",
	dest_thm o É_Ä_conv,
	ªÉ x y é f x Ä g yº,
	([],ª(É x y é f x Ä g y) Ç (É x é f x) Ä (É y é g y)º)),
	("É_Ä_conv 2",
	dest_thm o É_Ä_conv,
	ªÉ x y é f x Ä g y Ä h x y Ä iº,
	([],ª(É x y é f x Ä g y Ä h x y Ä i) Ç 
		(É x é f x) 
		Ä (É y é g y)
		Ä (É x y é h x y)
		Ä iº)),
	("simple_É_Ä_conv 3",
	dest_thm o É_Ä_conv,
	ªÉ (x, y) é f x Ä g yº,
	([],ª(É (x,y) é f x Ä g y) Ç (É x é f x) Ä (É y é g y)º))
	];
store_mt_results mt_run_fail [
	("É_Ä_conv",
	É_Ä_conv,
	mk_t,
	gen_fail_msg "É_Ä_conv" 58020 ["ªTº"])
	];
=TEX
\subsection{simple$\_$É$\_$Ñ$\_$conv}
=SML
store_mt_results mt_run [
	("simple_É_Ñ_conv 1",
	dest_thm o simple_É_Ñ_conv,
	ªÉ x :'aé Ñ y:'b é f x Ä g yº,
	([],ª(É x :'aé Ñ y :'bé f x Ä g y) Ç (Ñ y' é É x:'a é f x Ä g (y' x))º))
	];
store_mt_results mt_run_fail [
	("simple_É_Ñ_conv",
	simple_É_Ñ_conv,
	mk_t,
	gen_fail_msg "simple_É_Ñ_conv" 58016 ["ªTº"])
	];
=TEX
\subsection{simple$\_$Ñ$\_$É$\_$conv}
=SML
store_mt_results mt_run [
	("simple_Ñ_É_conv 1",
	dest_thm o simple_Ñ_É_conv,
	ªÑ x :'bé É y:'a é f x Ä g yº,
	([],ª(Ñ x:'b é É y:'a é f x Ä g y) Ç (É y' é Ñ x:'b é f x Ä g (y' x))º))
	];
store_mt_results mt_run_fail [
	("simple_Ñ_É_conv",
	simple_Ñ_É_conv,
	mk_t,
	gen_fail_msg "simple_Ñ_É_conv" 58017 ["ªTº"])
	];
=TEX
\subsection{simple$\_$Ñ$\_$É$\_$conv1}
=SML
store_mt_results mt_run [
	("simple_Ñ_É_conv1 1",
	dest_thm o simple_Ñ_É_conv1,
	ªÑ y :'c ã 'b é É x :'cé f x Ä g (y x)º,
	([],ª(Ñ y :'c ã 'b é É x :'cé f x Ä g (y x)) Ç (É x é Ñ y'é f x Ä g y')º))
	];
store_mt_results mt_run_fail [
	("simple_Ñ_É_conv1",
	simple_Ñ_É_conv1,
	mk_t,
	gen_fail_msg "simple_Ñ_É_conv1" 58019 ["ªTº"])
	];
=TEX
\subsection{simple$\_$Ñ$\_$equation$\_$conv}
=SML
store_mt_results mt_run [
	("simple_Ñ_equation_conv 1",
	dest_thm o simple_Ñ_equation_conv,
	ªÑ f é f = xº,
	([],ª(Ñ f é f = x) Ç (T)º)),
	("simple_Ñ_equation_conv 2",
	dest_thm o simple_Ñ_equation_conv,
	ªÑ f é x = fº,
	([],ª(Ñ f é x = f) Ç (T)º)),
	("simple_Ñ_equation_conv 3",
	dest_thm o simple_Ñ_equation_conv,
	ªÑ f é (f = x) Ä P fº,
	([],ª(Ñ f é (f = x) Ä P f) Ç (P x)º)),
	("simple_Ñ_equation_conv 4",
	dest_thm o simple_Ñ_equation_conv,
	ªÑ f g é (f = g) Ä P fº,
	([],ª(Ñ f g é (f = g) Ä P f) Ç (Ñ g é P g)º)),
	("simple_Ñ_equation_conv 5",
	dest_thm o simple_Ñ_equation_conv,
	ªÑ f é f Ä P fº,
	([],ª(Ñ f é f Ä P f) Ç (P T)º)),
	("simple_Ñ_equation_conv 6",
	dest_thm o simple_Ñ_equation_conv,
	ªÑ f é å f Ä P fº,
	([],ª(Ñ f é å f Ä P f) Ç (P F)º))
	];
store_mt_results mt_run_fail [
	("simple_Ñ_equation_conv 3034",
	simple_Ñ_equation_conv,
	mk_t,
	gen_fail_msg "simple_Ñ_equation_conv" 3034 ["ªTº"]),
	("simple_Ñ_equation_conv 58013 1",
	simple_Ñ_equation_conv,
	ªÑ x é f xº,
	gen_fail_msg "simple_Ñ_equation_conv" 58013 ["ªÑ xé f xº"]),
	("simple_Ñ_equation_conv 58013 2",
	simple_Ñ_equation_conv,
	ªÑ x é É f é f = xº,
	gen_fail_msg "simple_Ñ_equation_conv" 58013 ["ªÑ xé É fé f = xº"])
	];
=TEX
\section{THE TESTS OF MAIN FUNCTIONS}
\subsection{prove$\_$Ñ$\_$conv}
=SML
store_mt_results mt_run [
	("prove_Ñ_conv 1",
	dest_thm o prove_Ñ_conv,
	ªÑ f é fº,
	([],ª(Ñ f é f) Ç (T)º)),
	("prove_Ñ_conv 2",
	dest_thm o prove_Ñ_conv,
	ªÑ f é (a = f) Ä f gº,
	([],ª(Ñ f é (a = f) Ä f g) Ç (a g)º)),
	("prove_Ñ_conv 3",
	dest_thm o prove_Ñ_conv,
	ªÑ f é É z é (z h Ä (a = f) Ä z f) Ä f gº,
	([],ª(Ñ f é É z é (z h Ä (a = f) Ä z f) Ä f g) Ç 
		((É z é z h) Ä (É z é z a) Ä a g)º)),
	("prove_Ñ_conv 4",
	dest_thm o prove_Ñ_conv,
	ªÑ f:'a ã BOOL é É (z, x) é (z h Ä (a = f) Ä z (f x)) Ä (É g :'aé f g)º,
	([],ª(Ñ f:'a ã BOOL é É (z, x) é (z h Ä (a = f) Ä z (f x)) Ä (É g :'aé f g)) Ç 
	(((É z x é z (a x)) Ä (É g:'aé a g)) Ä (É z é z h))º)),
	("prove_Ñ_conv 5",
	dest_thm o prove_Ñ_conv,
	ªÑ f:'b ã 'c é (É x é f x = g) Ä (É y é h (f  y))º,
	([],ª(Ñ f :'b ã 'cé (É x é f x = g) Ä (É y é h (f  y))) Ç 
		(h g)º)),
	("prove_Ñ_conv 6",
	dest_thm o prove_Ñ_conv,
	ªÑ f:((BOOL â BOOL) â (BOOL â BOOL)) ã BOOL ã BOOL é 
		(É a b c p é f (a,(b,c)) p Ç Fst a Ä c Ä p) Ä
		(É d e g p é f ((d,e),g) p Ç Snd g Ä p Ä d)  Ä
		(É a g q é f(a,g) q Ç q Ä Snd g Ä Fst a)º,
	([],ª(Ñ f:((BOOL â BOOL) â (BOOL â BOOL)) ã BOOL ã BOOL é 
		(É a b c p é f (a,(b,c)) p Ç Fst a Ä c Ä p) Ä
		(É d e g p é f ((d,e),g) p Ç Snd g Ä p Ä d)
Ä
		(É a g q é f(a,g) q Ç q Ä Snd g Ä Fst a)) 
	Ç 
		((É (x:(BOOL â BOOL) â (BOOL â BOOL)) p'é (Fst (Fst x)
	 Ä Snd (Snd x) Ä p' Ç Snd (Snd x) Ä p' Ä Fst (Fst x))
  Ä (Fst (Fst x) Ä Snd (Snd x) Ä p' Ç p' Ä Snd (Snd x) Ä Fst (Fst x))))º))
	];

=TEX
=SML
store_mt_results mt_run_fail [
	("prove_Ñ_conv 58001",
	prove_Ñ_conv,
	mk_t,
	gen_fail_msg "prove_Ñ_conv" 58001 ["ªTº"]),
	("prove_Ñ_conv 58002",
	prove_Ñ_conv,
	ªÑ f é P fº,
	gen_fail_msg "prove_Ñ_conv" 58002 ["ªÑ fé P fº"])
	];
=TEX

\subsection{prove$\_$Ñ$\_$rule}
=SML
fun test tm = (concl(prove_Ñ_rule tm) = tm);
store_mt_results mt_run [
	("prove_Ñ_rule 1",
	test,
	ªÑ a (b, c) d e é (a = b) Ä (a = d) Ä (b = 1) Ä (c = d) Ä (e = c)º,
	true),
	("prove_Ñ_rule 2",
	test,
	ªÑ f éfº,
	true),
	("prove_Ñ_rule 3",
	test,
	ªÑ f é f Ç Tº,
	true),
	("prove_Ñ_rule 4",
	test,
	ªÑ f é a = fº,
	true),
	("prove_Ñ_rule 5",
	test,
	ªÑ f é É x é f xº,
	true),
	("prove_Ñ_rule 6",
	test,
	ªÑ f g h é (É x é f x = g) Ä (É y é h (f  y))º,
	true),
	("prove_Ñ_rule 7",
	test,
	ªÑ g h f é (É x y z é f x y z = g y z x) Ä (É a b c é h (f c a) b)º,
	true),
	("prove_Ñ_rule 8",
	test,
	ªÑ fst snd é É x y é (fst(x,y) = x) Ä (snd(x,y) = y)º,
	true),
	("prove_Ñ_rule 9",
	test,
	ªÑ app é É p q r é (app [] q = q) Ä
	(app (Cons p q) r = (Cons p (app q r))) Ä Tº,
	true),
	("prove_Ñ_rule 10",
	test,
	ªÑ app é (É q é (app [] q = q)) Ä
	(É p q r é (app (Cons p q) r = (Cons p (app q r))))º,
	true),
	("prove_Ñ_rule 11",
	test,
	ªÑ mp é É f é (mp f [] = []) Ä (É p q é mp f (Cons p q) = Cons (f p) (mp f q))º,
	true),
	("prove_Ñ_rule 12",
	test,
	ªÑ ce éÉ p q r s é 
	(ce (Cons p r) (Cons q s) Ç (p = q) Ä (ce r s)) Ä
	(ce [] []) Ä
	(å ce (Cons p r) []) Ä
	(å ce [] (Cons p r))º,
	true),
	("prove_Ñ_rule 13",
	test,
	ªÑ fact é É n é (fact 0 = 1) Ä (fact (n+1) = (n + 1) *  fact n)º,
	true),
	("prove_Ñ_rule 14",
	test,
	ªÑ limit_it é É n a x é 
	(limit_it (n + 1) (Cons a x) = Cons a (limit_it n x)) Ä
	(limit_it (n + 1) [] = []) Ä
	(limit_it 0 [] = []) Ä
	(limit_it 0 (Cons a x) = [])º,
	true),
	("prove_Ñ_rule 15",
	test,
	ªÑ limit_it é É n a x é 
	(limit_it (n + 1) (Cons a x) = Cons a (limit_it n x)) Ä
	(limit_it (n + 1) [] = []) Ä
	(limit_it 0 x = [])º,
	true),
	("prove_Ñ_rule 16",
	test,
	ªÑ f é É x y é (f(InL x) = g x)Ä (f(InR y) = h y)º,
	true),
	("prove_Ñ_rule 17",
	test,
	ªÑ f éf [] = 1º,
	true),
	("prove_Ñ_rule 18",
	test,
	ªÑ f éÉ x a é f (Cons a x) = aº,
	true),
	("prove_Ñ_rule 19",
	test,
	ªÑ f éÉ x a é f (a+1) = aº,
	true),
	("prove_Ñ_rule 20",
	test,
	ªÑ f éf 0 = aº,
	true),
	("prove_Ñ_rule 21",
	test,
	ªÑ ce éÉ p q r s é 
	(ce (Cons p r, Cons q s) Ç (p = q) Ä (ce (r, s))) Ä
	(ce ([], [])) Ä
	(å ce (Cons p r,[])) Ä
	(å ce ([], Cons p r))º,
	true)
	];

=TEX
=SML
store_mt_results mt_run_fail [
	("prove_Ñ_rule 58001",
	prove_Ñ_rule,
	mk_t,
	gen_fail_msg "prove_Ñ_rule" 58001 ["ªTº"]),
	("prove_Ñ_rule 58002",
	prove_Ñ_rule,
	ªÑ f é P fº,
	gen_fail_msg "prove_Ñ_rule" 58002 ["ªÑ fé P fº"]),
	("prove_Ñ_rule 58003",
	prove_Ñ_rule,
	ªÑ f é f Ä Pº,
	gen_fail_msg "prove_Ñ_rule" 58003 ["ªÑ fé f Ä Pº"])
	];
=TEX

\subsection{prove$\_$Ñ$\_$tac}
=SML
fun test tm = (concl(tac_proof(([],tm),prove_Ñ_tac)) = tm);
store_mt_results mt_run [
	("prove_Ñ_tac 1",
	test,
	ªÑ a (b, c) d e é (a = b) Ä (a = d) Ä (b = 1) Ä (c = d) Ä (e = c)º,
	true),
	("prove_Ñ_tac 2",
	test,
	ªÑ f éfº,
	true),
	("prove_Ñ_tac 3",
	test,
	ªÑ f é f Ç Tº,
	true),
	("prove_Ñ_tac 4",
	test,
	ªÑ f é a = fº,
	true),
	("prove_Ñ_tac 5",
	test,
	ªÑ f é É x é f xº,
	true),
	("prove_Ñ_tac 6",
	test,
	ªÑ f g h é (É x é f x = g) Ä (É y é h (f  y))º,
	true),
	("prove_Ñ_tac 7",
	test,
	ªÑ g h f é (É x y z é f x y z = g y z x) Ä (É a b c é h (f c a) b)º,
	true),
	("prove_Ñ_tac 8",
	test,
	ªÑ fst snd é É x y é (fst(x,y) = x) Ä (snd(x,y) = y)º,
	true),
	("prove_Ñ_tac 9",
	test,
	ªÑ app é É p q r é (app [] q = q) Ä
	(app (Cons p q) r = (Cons p (app q r))) Ä Tº,
	true),
	("prove_Ñ_tac 10",
	test,
	ªÑ app é (É q é (app [] q = q)) Ä
	(É p q r é (app (Cons p q) r = (Cons p (app q r))))º,
	true),
	("prove_Ñ_tac 11",
	test,
	ªÑ mp é É f é (mp f [] = []) Ä (É p q é mp f (Cons p q) = Cons (f p) (mp f q))º,
	true),
	("prove_Ñ_tac 12",
	test,
	ªÑ ce éÉ p q r s é 
	(ce (Cons p r) (Cons q s) Ç (p = q) Ä (ce r s)) Ä
	(ce [] []) Ä
	(å ce (Cons p r) []) Ä
	(å ce [] (Cons p r))º,
	true),
	("prove_Ñ_tac 13",
	test,
	ªÑ fact é É n é (fact 0 = 1) Ä (fact (n+1) = (n + 1) *  fact n)º,
	true),
	("prove_Ñ_tac 14",
	test,
	ªÑ limit_it é É n a x é 
	(limit_it (n + 1) (Cons a x) = Cons a (limit_it n x)) Ä
	(limit_it (n + 1) [] = []) Ä
	(limit_it 0 [] = []) Ä
	(limit_it 0 (Cons a x) = [])º,
	true),
	("prove_Ñ_tac 15",
	test,
	ªÑ limit_it é É n a x é 
	(limit_it (n + 1) (Cons a x) = Cons a (limit_it n x)) Ä
	(limit_it (n + 1) [] = []) Ä
	(limit_it 0 x = [])º,
	true),
	("prove_Ñ_tac 16",
	test,
	ªÑ f é É x y é (f(InL x) = g x)Ä (f(InR y) = h y)º,
	true),
	("prove_Ñ_tac 17",
	test,
	ªÑ f éf [] = 1º,
	true),
	("prove_Ñ_tac 18",
	test,
	ªÑ f éÉ x a é f (Cons a x) = aº,
	true),
	("prove_Ñ_tac 19",
	test,
	ªÑ f éÉ x a é f (a+1) = aº,
	true),
	("prove_Ñ_tac 20",
	test,
	ªÑ f éf 0 = aº,
	true),
	("prove_Ñ_tac 21",
	test,
	ªÑ ce éÉ p q r s é 
	(ce (Cons p r, Cons q s) Ç (p = q) Ä (ce (r, s))) Ä
	(ce ([], [])) Ä
	(å ce (Cons p r,[])) Ä
	(å ce ([], Cons p r))º,
	true)
	];

=TEX
=SML
store_mt_results mt_run_fail [
	("prove_Ñ_tac 58004",
	prove_Ñ_tac,
	([],mk_t),
	gen_fail_msg "prove_Ñ_tac" 58004 []),
	("prove_Ñ_tac 58005",
	prove_Ñ_tac,
	([],ªÑ f é P fº),
	gen_fail_msg "prove_Ñ_tac" 58005 []),
	("prove_Ñ_tac 58006",
	prove_Ñ_tac,
	([],ªÑ f é f Ä Pº),
	gen_fail_msg "prove_Ñ_tac" 58006 [])
	];
=TEX
\section{PROOF CONTEXTS}
We first create a new theory:
=SML
open_theory "sum";
delete_theory "mdt058_test_theory" handle (Fail _) => ();
new_theory "mdt058_test_theory";
new_type ("NARY",1);
new_const("NNode",ª:('a NARY)LIST ã 'a NARYº);
new_const("NLeaf",ª:'a ã 'a NARYº);
val nary_axiom = new_axiom("nary_axiom",
	ªÉ node leaf é Ñ%down%1 f é 
	(É n é f (NLeaf n) = leaf n) Ä
	(É l é f (NNode l) = node l (Map f l))º);

new_type ("OPS",1);
new_const("Op1",ª:'a OPS ã 'a OPS ã 'a OPSº);
new_const("Op2",ª:'a OPS ã 'a OPS ã 'a OPSº);
new_const("Atom",ª:'a ã 'a OPSº);
val ops_axiom = new_axiom("ops_axiom",
	ªÉ a op1 op2 é Ñ%down%1 f é
	(É x é f (Atom x) = a x) Ä
	(É p q é f (Op1 p q) = op1 p q (f p) (f q)) Ä
	(É p q é f (Op2 p q) = op2 (f p) (f q) p q)º);

new_type("TRIPLE",3);
val triple = new_const("Triple",ª:'a ã 'b ã 'c ã ('a, 'b, 'c)TRIPLEº);
val tripe1 = new_const("Tripe1",ª:('a, 'b, 'c)TRIPLE ã 'aº);
val tripe2 = new_const("Tripe2",ª:('a, 'b, 'c)TRIPLE ã 'bº);
val tripe3 = new_const("Tripe3",ª:('a, 'b, 'c)TRIPLE ã 'cº);
val tripe_rw = new_axiom("tripe_rw",
	ªÉ a b c x é 
	(Triple(Tripe1 x)(Tripe2 x)(Tripe3 x) = x)
	Ä
	(Tripe1(Triple a b c) = a)
	Ä
	(Tripe2(Triple a b c) = b)
	Ä
	(Tripe3(Triple a b c) = c)º);
=TEX
Now create a new context (incidentally testing $evaluate\_Ñ\_cd\_thm$:
=SML
val new_prove_Ñ_epc = (
	set_epc_Ñ_vs_thm 
	(("Triple",([tripe1, tripe2, tripe3],tripe_rw)) ::
		(get_epc_Ñ_vs_thm(get_proof_context())))
	(set_epc_Ñ_cd_thm
	(evaluate_Ñ_cd_thm nary_axiom :: 
		evaluate_Ñ_cd_thm ops_axiom :: 
		(get_epc_Ñ_cd_thm(get_proof_context())))
	prove_Ñ_epc)
);
push_proof_context new_prove_Ñ_epc;
=TEX
Now test it:
=SML
fun test tm = (concl(prove_Ñ_rule tm) = tm);
store_mt_results mt_run [
	("prove_Ñ_rule 1",
	test,
	ªÑ g é É p q a é (g (Op2 p q) Ç h p Ä g q)
	Ä 
	(g (Op1 p q) Ç h q Ä g p)
	Ä 
	g(Atom a) = (a=0)º,
	true),
	("prove_Ñ_rule 2",
	test,
	ªÑ sum_tree é
	(É n é sum_tree (NLeaf n) = n) Ä
	(É l é sum_tree (NNode l) = Fold ($+) (Map sum_tree l) 0)º,
	true),
	("prove_Ñ_rule 3",
	test,
	ªÑ map_tree é É f l n é 
	(map_tree f (NLeaf n) = NLeaf (f n))
	Ä
	(map_tree f (NNode l) = NNode (Map (map_tree f) l))º,
	true),
	("prove_Ñ_rule 4",
	test,
	ªÑ f é É a b c n x é (f 0 (Triple a b c) Ç a Ä b Ä c) Ä
		(f (n+1) x Ç h n Ä f n x)º,
	true)
	];
=TEX
\subsection{evaluate$\_$Ñ$\_$cd$\_$thm}
Successful evaluation of this function is tested above.
Failures:
=SML
store_mt_results mt_run_fail [
	("evaluate_Ñ_cd_thm 58007",
	evaluate_Ñ_cd_thm,
	t_thm,
	gen_fail_msg "evaluate_Ñ_cd_thm" 58007 ["Ö T"]),
	("evaluate_Ñ_cd_thm 58008",
	evaluate_Ñ_cd_thm,
	asm_rule ªÉ P é Ñ%down%1 f é P fº,
	gen_fail_msg "evaluate_Ñ_cd_thm" 58008 
		["É Pé Ñ%down%1 fé P f Ö É Pé Ñ%down%1 fé P f"]),
	("evaluate_Ñ_cd_thm 58009",
	evaluate_Ñ_cd_thm,
	asm_rule ªÉ Pé Ñ%down%1 fé g 0 = P fº,
	gen_fail_msg "evaluate_Ñ_cd_thm" 58009
		["É Pé Ñ%down%1 fé g 0 = P f Ö É Pé Ñ%down%1 fé g 0 = P f"]),
	("evaluate_Ñ_cd_thm 58021",
	evaluate_Ñ_cd_thm,
	asm_rule ªÉ P Ré Ñ%down%1 fé (f 0 = P f) Ä 
		(f 0 = R f) º,
	gen_fail_msg "evaluate_Ñ_cd_thm" 58021 
		[("É P Ré Ñ%down%1 fé f 0 = P f Ä f 0 = R f " ^ 
		"Ö É P Ré Ñ%down%1 fé f 0 = P f Ä f 0 = R f")]),
	("evaluate_Ñ_cd_thm 58023",
	evaluate_Ñ_cd_thm,
	asm_rule ªÉ Pé Ñ%down%1 fé f 0 = Rº,
	gen_fail_msg "evaluate_Ñ_cd_thm" 58023 
		["É Pé Ñ%down%1 fé f 0 = R Ö É Pé Ñ%down%1 fé f 0 = R"])
	];
=TEX

\subsection{End of Tests}
=SML
diag_string(summarize_mt_results());
=TEX
\end{document}
