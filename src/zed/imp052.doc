=TEX
\documentstyle[hol1,11pt,TQ]{article}
\ftlinepenalty=9999
\makeindex
\TPPproject{FST PROJECT}  %% Mandatory field
%\TPPvolume{}
%\TPPpart{}
\TPPtitle{Implementation of Z Primitive Constants in the Theory ``Z''}  %% Mandatory field
\def\TPPheadtitle{Implementation of Z Primitive Constants \cr in the Theory ``Z''}
\TPPref{DS/FMU/IED/IMP052}  %% Mandatory field
\def\SCCSversion{$Revision$ %
}
\TPPissue{\SCCSversion}  %% Mandatory field
\TPPdate{\FormatDate{$Date$ %
}}
\TPPstatus{Draft}			%% Mandatory field
\TPPtype{SML Literate Script}
\TPPkeywords{}
%\TPPauthor{G.M.Prout&WIN01}  %% Mandatory field
\TPPauthors{G.M.~Prout&WIN01\\D.J.~King&WIN01 }
\TPPauthorisation{R.B.Jones & Project Manager}
\TPPabstract{This document contains the implementation of the Z primitive constants in the theory ``Z'' of the Z Proof Support Subsystem.}
\TPPdistribution{\parbox[t]{4.0in}{%
	    Library
}}
\begin{document}
\makeTPPfrontpage
\vfill
\begin{centering}
\bf Copyright \copyright\ : International Computers Ltd \number\year
\end{centering}
\pagebreak
\section{DOCUMENT CONTROL}
\subsection{Contents List}
\tableofcontents
\subsection{Document Cross References}
\bibliographystyle{fmu}
\bibliography{fmu}

\subsection{Changes History} 
\begin{description}
\item [Issue 1.1]
First draft version.
\item [Issue 1.2] (\TPPdate{\FormatDate{$Date$
}})
Changes made in step with \cite{DS/FMU/IED/DTD052}.
\item [Issue 1.4] (\TPPdate{\FormatDate{$Date$
}})
Changed to new fonts
\end{description}
%\subsection{Changes Forecast}
\section{GENERAL}
\subsection{Scope}
This document contains an implementation of the 
Z primitive constants in the theory ``Z'' of
the Z Proof Support System (see \cite{DS/FMU/IED/HLD015}).
This is called for in \cite{DS/FMU/IED/HLD017}.
The design is in \cite{DS/FMU/IED/DTD052}.
\subsection{Introduction}
\subsubsection{Purpose and Background}
This document contains an implementation of the 
Z primitive constants in the theory ``Z'' of
the Z Proof Support System.
\subsubsection{Dependencies}
This document takes its signature from \cite{DS/FMU/IED/DTD052},
and also requires the theory ``char'' defined in
\cite{DS/FMU/IED/DTD040}.
\subsubsection{Deficiencies}
\subsection{Design of the Theory ``Z''}
\subsubsection{Possible Enhancements}
\section{THE THEORY  ``Z''}
=SML
structure ÛZLanguageİ : ZLanguage = struct
=TEX
=SML
val _ = open_theory "hol";
val _ = delete_theory"z_language" handle Fail _ => ();
val _ = new_theory "z_language";
=TEX
=SML
=TEX
We need the definition of the tuple types $ÛZ'T[1]İ$  and
 $ÛZ'T[2]İ$ and their constructors $ÛZ'Mk\_T[1]İ$
 and $ÛZ'Mk\_T[2]İ$, and the projection function $ÛZ'T[1]1İ$.

=SML
val _ = labelled_product_spec
	{tykey = "Z'T[1]",
	tyname = "Z'T[1]",
	labels = [("Z'T[1]1",¬:'1®)],
	tyvars = Nil,
	constkeys = ["Z'Mk_T[1]","Z'T[1]1"],
	conname = "Z'Mk_T[1]"};
=TEX
=SML
val _ = labelled_product_spec
	{tykey = "Z'T[2]",
	tyname = "Z'T[2]",
	labels = [("Z'T[2]1",¬:'1®),("Z'T[2]2",¬:'2®)],
	tyvars = Nil,
	constkeys = ["Z'Mk_T[2]","Z'T[2]1","Z'T[2]2"],
	conname = "Z'Mk_T[2]"};
=TEX

=TEX
$ÛZ'decİ$, $ÛZ'decsexpİ$ and $ÛZ'declİ$.
=SML

val _ = simple_new_defn(["Z'decsexp"],"Z'decsexp",¬$®);
=SML
val _ =
¹HOLCONST
Ü	Z'dec : ('a LIST ¸ 'a SET) ­ BOOL
÷üüüüüüüüüüüüüüüüüüüüüüüüüüüüüüü
Ü	µ vs ·
Ü	Z'dec ([], vs)
Ü	± 
Ü	(µ v vl · Z'dec ((Cons v vl), vs)
Ü			¤ v  vs ± Z'dec (vl, vs))
°

=TEX
=SML
val _ =
¹HOLCONST
Ü	Z'decl : BOOL LIST ­ BOOL
÷üüüüüüüüüüüüüüüüüüüüüüüüüüüüüüü
Ü	Z'decl Nil
Ü	±
Ü	µ b bl ·
Ü		Z'decl (Cons b bl) = (b ± (Z'decl bl))
°

=TEX
$ÛZ'Totalityİ$ and $ÛUİ$.
=SML

=SML
val _ =
¹HOLCONST
Ü	z'Totality:'a SET
÷üüüüüüüüüüüüüüüüüüüüüüüüüüüüüüü
Ü	z'Totality = Universe
°

=SML
val _ =
¹HOLCONST
Ü	z'U : ('a)$"Z'T[1]" ­ 'a
÷üüüüüüüüüüüüüüüüüüüüüüüüüüüüüüü
Ü	z'U = $"Z'T[1]1"
°

=TEX
$Ûúİ$ and $Ûî\_to\_úİ$
=SML
val _ = new_type("ú", 0);
val _ = new_const("î_to_ú",¬:î ­ ú®);
=TEX
$ÛZ'ğİ$, $ÛZ'setdİ$, $ÛZ'NumListİ$ and  $ÛZ'§¢İ$. 
=SML
val _ =
¹HOLCONST
Ü	$"Z'ğ":'a SET ­ ('a SET) SET
÷üüüüüüüüüüüüüüüüüüüüüüüüüüüüüüü
Ü	$"Z'ğ" = ğ
°

=TEX
Next one will be called ``Elems''.
=SML
val _ =
¹HOLCONST
Ü	Z'setd:'a LIST ­ 'a SET
÷üüüüüüüüüüüüüüüüüüüüüüüüüüüüüüü
Ü	Z'setd Nil = {}
Ü	±
Ü	µ h t · Z'setd (Cons h t) = (Z'setd t) À {h}
°
=SML
val _ =
¹HOLCONST
Ü	Z'NumList : ('a LIST ¸ î) ­ (((ú, 'a)$"Z'T[2]") SET)
÷üüüüüüüüüüüüüüüüüüüüüüüüüüüüüüü
Ü	µ n : î ·
Ü	Z'NumList ([], n) = {}
Ü	±
Ü	(µ a list · Z'NumList  ((Cons a list), n) = 
Ü		(Z'NumList (list, n + 1)) À
Ü			{$"Z'Mk_T[2]" (î_to_ú (n + 1)) a})
°
=SML
val _ =
¹HOLCONST
Ü	$"Z'§¢" : 'a LIST ­ ((ú, 'a)$"Z'T[2]") SET
÷üüüüüüüüüüüüüüüüüüüüüüüüüüüüüüü
Ü	µ l ·
Ü	$"Z'§¢" l =  Z'NumList (l, 0)
°

$ÛZ'Íİ$ and  $ÛZ'appİ$. 
=SML
val _ =
¹HOLCONST
Ü	$"Z'Í" : ('a ­ BOOL) ­ 'a
÷üüüüüüüüüüüüüüüüüüüüüüüüüüüüüüü
Ü	µ f t ·
Ü	((f = (Ì x · x = t)) ´ ($"Z'Í" f = t))
°

=SML
val _ =
¹HOLCONST
Ü	Z'app : (('a,'b)$"Z'T[2]") SET ­ 'a ­ 'b
÷üüüüüüüüüüüüüüüüüüüüüüüüüüüüüüü
Ü	µ f (x : 'a) ·
Ü	Z'app  f x = 
Ü		$"Z'Í" (Ì y : 'b · ($"Z'Mk_T[2]" x y)  f)
°


=SML
=TEX
$ÛZ'Êİ$ and  $ÛZ'predsexpİ$.
=SML
val _ =
¹HOLCONST
Ü	$"Z'Ê" : 'a ­ 'b ­ 'a
÷üüüüüüüüüüüüüüüüüüüüüüüüüüüüüüü
Ü	µ x y ·
Ü	$"Z'Ê" x y = x
°


=SML
val _ = simple_new_defn(["Z'predsexp"],"Z'predsexp",¬$®);
=TEX
$ÛZ'³\%down\%sİ$
=SML
val _ =
¹HOLCONST
Ü	$"Z'³‰s" : 'a SET ­ 'a SET
÷üüüüüüüüüüüüüüüüüüüüüüüüüüüüüüü
Ü	µ x s ·
Ü	x  $"Z'³‰s" s ¤ ³(x  s)
°

=TEX
The next bit can be moved to the beginning of the document later...
=SML
val _ =
¹Z
	rel _ = _, _  _
°
=TEX
\section{END OF THEORY ``Z''}
=SML
end; (* of structure ZLanguage *)
open ZLanguage;
=TEX
\newpage
\twocolumn[\section{INDEX}]
\small
\printindex
\end{document}


