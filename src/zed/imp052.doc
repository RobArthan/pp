=TEX
\documentstyle[hol1,11pt,TQ]{article}
\ftlinepenalty=9999
\makeindex
\TPPproject{FST PROJECT}  %% Mandatory field
%\TPPvolume{}
%\TPPpart{}
\TPPtitle{Implementation of Z Primitive Constants in the Theory ``Z''}  %% Mandatory field
\def\TPPheadtitle{Implementation of Z Primitive Constants \cr in the Theory ``Z''}
\TPPref{DS/FMU/IED/IMP052}  %% Mandatory field
\def\SCCSversion{$Revision$ %
}
\TPPissue{\SCCSversion}  %% Mandatory field
\TPPdate{\FormatDate{$Date$ %
}}
\TPPstatus{Draft}			%% Mandatory field
\TPPtype{SML Literate Script}
\TPPkeywords{}
\TPPauthor{G.M.Prout&WIN01}  %% Mandatory field
%\TPPauthors{G.T.Scullard&WIN01\\G.M.Prout&WIN01 }
\TPPauthorisation{R.B.Jones & Project Manager}
\TPPabstract{This document contains the implementation of the Z primitive constants in the theory ``Z'' of the Z Proof Support Subsystem.}
\TPPdistribution{\parbox[t]{4.0in}{%
	    Library
}}
\begin{document}
\makeTPPfrontpage
\vfill
\begin{centering}
\bf Copyright \copyright\ : International Computers Ltd \number\year
\end{centering}
\pagebreak
\section{DOCUMENT CONTROL}
\subsection{Contents List}
\tableofcontents
\subsection{Document Cross References}
\bibliographystyle{fmu}
\bibliography{fmu}

\subsection{Changes History} 
\begin{description}
\item [Issue 1.1]
First draft version.
\item [Issue 1.2] (\TPPdate{\FormatDate{$Date$
}})
Changes made in step with \cite{DS/FMU/IED/DTD052}.
\item [Issue 1.4] (\TPPdate{\FormatDate{$Date$
}})
Changed to new fonts
\end{description}
%\subsection{Changes Forecast}
\section{GENERAL}
\subsection{Scope}
This document contains an implementation of the 
Z primitive constants in the theory ``Z'' of
the Z Proof Support System (see \cite{DS/FMU/IED/HLD015}).
This is called for in \cite{DS/FMU/IED/HLD017}.
The design is in \cite{DS/FMU/IED/DTD052}.
\subsection{Introduction}
\subsubsection{Purpose and Background}
This document contains an implementation of the 
Z primitive constants in the theory ``Z'' of
the Z Proof Support System.
\subsubsection{Dependencies}
This document takes its signature from \cite{DS/FMU/IED/DTD052},
and also requires the theory ``char'' defined in
\cite{DS/FMU/IED/DTD040}.
\subsubsection{Deficiencies}
\subsection{Design of the Theory ``Z''}
\subsubsection{Possible Enhancements}
\section{THE THEORY  ``Z''}
=SML
structure ÛZTheoryİ : ZTheory = struct
val _ = open_theory "char";
val _ = new_theory "ÛZİ";
=TEX
We need the definition of the tuple types $ÛZ'T[1]İ$  and
 $ÛZ'T[2]İ$ and their constructors $ÛZ'mk\_T[1]İ$
 and $ÛZ'mk\_T[2]İ$, and the projection function $ÛZ'T[1]1İ$.
=SML
val _ = labelled_product_spec
	{tykey = "Z'T[1]",
	tyname = "Z'T[1]",
	labels = [("Z'T[1]1",¬:'1®)],
	tyvars = Nil,
	constkeys = ["Z'mk_T[1]","Z'T[1]1"],
	conname = "Z'mk_T[1]"};
=TEX
=SML
val _ = labelled_product_spec
	{tykey = "Z'T[2]",
	tyname = "Z'T[2]",
	labels = [("Z'T[2]1",¬:'1®),("Z'T[2]2",¬:'2®)],
	tyvars = Nil,
	constkeys = ["Z'mk_T[2]","Z'T[2]1","Z'T[2]2"],
	conname = "Z'mk_T[2]"};
=TEX
$ÛZ'IsğRepİ$, $Ûğİ$, $ÛZ'absğİ$ and $Ûİ$.
=SML
val _ = new_specification(["Z'IsğRep"],1, (
push_goal([],¬¶ $"Z'IsğRep":('a ­ BOOL) ­ BOOL ·
	$"Z'IsğRep" = Ì P: 'a ­ BOOL· T®);
a(¶_tac ¬Ì x:'a ­ BOOL· T® THEN rewrite_tac[]);
pop_thm()));
=TEX
=SML
val _ = new_type_defn("ğ","ğ",["'a"],(
push_goal([],¬¶ x: 'a ­ BOOL · $"Z'IsğRep" x®);
a(rewrite_tac[get_specification"Z'IsğRep"]);
pop_thm()));
=TEX
=SML
val _ = declare_infix (230,"");

val _ = new_specification(["Z'absğ",""],2,(
push_goal([],¬¶ ($"Z'absğ":('a ­ BOOL) ­ 'a ğ)
	($ : 'a ­ 'a ğ ­ BOOL) ·
	µ (x : 'a) (p:'a ­ BOOL)(S1: 'a ğ) (S2 : 'a ğ) ·
	(x  ($"Z'absğ" p) ¤ p x) ±
	(S1 = S2 ¤ (µ x:'a· x  S1 ¤ x  S2))®);
a (strip_asm_tac (rewrite_rule [get_specification"Z'IsğRep"]
	(simple_´_match_mp_rule type_lemmas_thm (get_defn "Z" "ğ"))));
a(MAP_EVERY ¶_tac
	[¬Ì x · abs x®,
	¬Ì x S · (rep S) x®]);
a(asm_rewrite_tac[]);
a(rewrite_tac[all_µ_intro(eq_sym_rule(all_simple_µ_elim ext_thm))]);
a(REPEAT simple_µ_tac THEN ¤_tac);
(* *** Goal "1" *** *)
a(asm_rewrite_tac[]);
(* *** Goal "2" *** *)
a(POP_ASM_T (ante_tac o ap_fun_rule ¬abs®));
a(asm_rewrite_tac[]);
pop_thm()));
=TEX
$ÛZ'šİ$, $ÛZ'Àİ$ and $ÛZ'SingletonSetİ$
=SML
val _= new_specification(["Z'š"],1,(
push_goal([],¬¶ $"Z'š":'a ğ · µ x:'a · ³(x  $"Z'š")®);
a(¶_tac ¬$"Z'absğ"(ÌX·F)® THEN rewrite_tac[get_specification"Z'absğ"]);
pop_thm()));
=TEX
=SML
val _ = new_specification(["Z'À"],1,(
push_goal([],¬¶ $"Z'À": 'a ğ ­ 'a ğ ­ 'a ğ ·
	µ (x:'a) (S1 : 'a ğ) (S2 : 'a ğ) · 
	(x  ($"Z'À" S1 S2)) ¤ ((x  S1) ² (x  S2))®);
a(¶_tac ¬Ì S1 S2 · $"Z'absğ"(Ìx·x  S1 ² x  S2)®
	THEN rewrite_tac[get_specification"Z'absğ"]);
pop_thm()));
=TEX
=SML
val _ = new_specification(["Z'SingletonSet"],1,(
push_goal([],¬¶ Z'SingletonSet: 'a ­ 'a ğ ·
	µx y·y  Z'SingletonSet x ¤ (y = x)®);
a(¶_tac ¬Ìy·$"Z'absğ"(Ìx·x = y)®
	THEN rewrite_tac[get_specification"Z'absğ"]);
pop_thm()));
=TEX
$Ûtrueİ$, $Ûfalseİ$ and $Ûboolİ$.
=SML
val _ = simple_new_defn("true","true",¬T®);
val _ = simple_new_defn("false","false",¬F®);
val _ = new_specification(["bool"],1,(
push_goal([],¬¶ bool:BOOL ğ ·
	µx:BOOL·(x  bool)  ¤ (x = true) ² (x = false)®);
a(¶_tac ¬$"Z'absğ"(Ìx · (x = true) ² (x = false))®
	THEN rewrite_tac[get_specification"Z'absğ"]);
pop_thm()));
=TEX
$ÛZ'decİ$, $ÛZ'decsexpİ$ and $ÛZ'declİ$.
=SML
val _ = new_specification(["Z'dec"],1,(
push_goal([],¬¶ Z'dec:('a LIST ¸ 'a ğ )­ BOOL ·
	µ vs · Z'dec ([], vs) ± (µ v vl · Z'dec ((Cons v vl), vs) ¤ v  vs ± Z'dec (vl, vs))®);
a(strip_asm_tac (list_µ_elim
	[¬Ì vs:'a ğ · T®,¬(Ì (v:'a) b (vl:'a LIST)(vs:'a ğ)·  (v  vs) ± (b vs))®]
	(inst_type_rule[(¬:'a ğ ­ BOOL®,¬:'b®)] list_prim_rec_thm)));
a(¶_tac ¬Uncurry f®  THEN asm_rewrite_tac[pair_clauses]);
pop_thm()));
=TEX
=SML
val _ = simple_new_defn("Z'decsexp","Z'decsexp",¬$®);
=TEX
=SML
val _ = new_specification(["Z'decl"],1,(
push_goal([],¬¶ Z'decl:BOOL LIST ­ BOOL ·
	Z'decl Nil
	± µ b bl · Z'decl (Cons  b bl) = (b ± (Z'decl bl))®);
a(strip_asm_tac (list_µ_elim
	[¬T®,¬(Ì (b:BOOL) a (c: BOOL LIST) ·  b ± a)®]
	(inst_type_rule[(¬:BOOL®,¬:'a®),(¬:BOOL®,¬:'b®)] list_prim_rec_thm)));
a(¶_tac ¬f®  THEN asm_rewrite_tac[]);
pop_thm()));
=TEX
$ÛZ'totalityİ$ and $ÛUİ$.
=SML
val _ = new_specification(["Z'totality"],1,(
push_goal([],¬¶ Z'totality:'a ğ · µx:'a·x  Z'totality®);
a(¶_tac ¬$"Z'absğ"(Ìx·T)®  THEN rewrite_tac[get_specification"Z'absğ"]);
pop_thm()));
=TEX
=SML
val _ = new_specification(["U"],1,(
push_goal([],¬¶ U:('1)$"Z'T[1]" ­ '1 ·
	U = $"Z'T[1]1"®);
a(¶_tac ¬$"Z'T[1]1"® THEN rewrite_tac[]) ;
pop_thm()));
=TEX
$Ûúİ$ and $Ûî\_to\_úİ$
=SML
val _ = new_type("ú", 0);
val _ = new_const("î_to_ú",¬:î ­ ú®);
=TEX
$ÛZ'ğİ$, $ÛZ'setdİ$, $ÛZ'NumListİ$ and  $ÛZ'§¢İ$. 
=SML
val _ = new_specification(["Z'ğ"],1,(
push_goal([],¬¶ $"Z'ğ":'a ğ ­ ('a ğ) ğ ·
	µ (X : 'a ğ) (S: 'a ğ) · 
	X  $"Z'ğ" S ¤ (µx·x  X ´ x  S)®);
a(¶_tac ¬Ì S ·$"Z'absğ"(ÌX·µx·x  X ´ x  S)®
	THEN rewrite_tac[get_specification "Z'absğ"]);
pop_thm()));
=TEX
=SML
val _ = new_specification(["Z'setd"],1,(
push_goal([],¬¶ Z'setd:'a LIST ­ 'a ğ ·
	Z'setd Nil = $"Z'š"
	± µ h t · Z'setd (Cons  h t) = $"Z'À" (Z'setd t) (Z'SingletonSet h)®);
a(strip_asm_tac (list_µ_elim
	[¬$"Z'š"®,¬(Ì (h:'a) b (c: 'a LIST) ·$"Z'À" b (Z'SingletonSet h))®
]
	(inst_type_rule[(¬:'a ğ®,¬:'b®)] list_prim_rec_thm)));
a(¶_tac ¬f®  THEN asm_rewrite_tac[]);
pop_thm()));
=TEX

=SML
val _ = new_specification(["Z'NumList"],1,(
push_goal([],¬¶ Z'NumList:('a LIST ¸ î ) ­ (((ú, 'a)$"Z'T[2]") ğ)·
	µn:î·Z'NumList ([],n) = $"Z'š"
	± (µ a list · Z'NumList  ((Cons  a list),n) = 
		$"Z'À" (Z'NumList (list,n + 1)) 
			(Z'SingletonSet	($"Z'mk_T[2]" (î_to_ú(n + 1))a)))®);
a(strip_asm_tac (list_µ_elim
	[¬Ìn:î·$"Z'š":((ú, 'a)$"Z'T[2]") ğ®,
	¬Ì (a:'a) (b:î  ­ (((ú, 'a)$"Z'T[2]") ğ)) (c: 'a LIST)(n:î)·$"Z'À"  (b (n + 1))
	(Z'SingletonSet	($"Z'mk_T[2]" (î_to_ú(n + 1))a))®]
	(inst_type_rule[(¬:î  ­ (((ú, 'a)$"Z'T[2]") ğ)®,¬:'b®)] list_prim_rec_thm)));
a(¶_tac ¬Uncurry f®  THEN asm_rewrite_tac[pair_clauses]);
pop_thm()));
=TEX
=SML
val _ = new_specification(["Z'§¢"],1,(
push_goal([],¬¶ $"Z'§¢":'a LIST ­ ((ú, 'a)$"Z'T[2]")ğ ·
	µl·$"Z'§¢" l =  Z'NumList (l,0)®);
a(¶_tac ¬Ìl·Z'NumList (l,0)®  THEN rewrite_tac[]);
pop_thm()));
=TEX
$ÛZ'Íİ$ and  $ÛZ'appİ$. 

=SML
val _ = new_specification(["Z'Í"],1,(
push_goal([],¬¶ $"Z'Í":('a ­ BOOL) ­ 'a ·
	µ f t · ((f = (Ìx·x = t)) ´ ($"Z'Í" f = t))®);
a(¶_tac ¬Ìf:('a ­ BOOL)·Íx:'a· f x®  THEN rewrite_tac[]);
a(REPEAT strip_tac THEN asm_rewrite_tac[]);
a(LEMMA_T¬¶x·x=t®(strip_asm_tac o  ¶_Í_rule));
a(¶_tac ¬t® THEN rewrite_tac[]);
pop_thm()));
=TEX
=SML
val _ = new_specification(["Z'app"],1,(
push_goal([],¬¶ $"Z'app":(('a,'b)$"Z'T[2]")ğ ­ 'a ­ 'b ·
	µf (x:'a) · Z'app  f x = 
	$"Z'Í"(Ìy:'b·($"Z'mk_T[2]" x y)  f)®);
a(¶_tac ¬Ì(f:(('a,'b)$"Z'T[2]")ğ)(x:'a)· $"Z'Í" (Ì y:'b· $"Z'mk_T[2]" x y  f)®  
	THEN rewrite_tac[]);
pop_thm()));
=TEX
$ÛZ'Êİ$ and  $ÛZ'predsexpİ$. 

=SML
val _ = new_specification(["Z'Ê"],1,(
push_goal([],¬¶ $"Z'Ê":'a ­ 'b ­ 'a ·	µ x y · $"Z'Ê" x y = x®);
a(¶_tac ¬Ì(x:'a)(y:'b)·x®  THEN rewrite_tac[]);
pop_thm()));
=TEX
=SML
val _ = simple_new_defn("Z'predsexp","Z'predsexp",¬$®);
=TEX
$ÛZ'³\%down\%sİ$
=SML
val _ = new_specification(["Z'³%down%s"],1,(
push_goal([],¬¶ $"Z'³%down%s":'a ğ ­ 'a ğ ·
	µ x s ·  x  $"Z'³%down%s" s ¤ ³(x  s)®);
a(¶_tac ¬Ìs:'a ğ·$"Z'absğ"(Ìx:'a·³(x  s))®  THEN rewrite_tac[get_specification"Z'absğ"]);
pop_thm()));
=TEX
\section{END OF THEORY ``Z''}
=SML
end; (* of structure ZTheory *)
open ZTheory;
=TEX
\newpage
\twocolumn[\section{INDEX}]
\small
\printindex
\end{document}


