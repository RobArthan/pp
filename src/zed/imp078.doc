% imp078.doc   %Z% $Date$ $Revision$ $RCSfile$
=TEX
% TQtemplate.tex
\documentstyle[hol1,11pt,TQ]{article}
\ftlinepenalty=9999
\def\Hide#1{}
\def\Bool{``$\it{:}bool\,$''}
\makeindex
\TPPproject{FST PROJECT}  %% Mandatory field
%\TPPvolume{}
%\TPPpart{}
\TPPtitle{Implementation of the Z Mathematical Toolkit}  %% Mandatory field
\TPPref{DS/FMU/IED/IMP078}  %% Mandatory field
\def\SCCSversion{$Revision$%
}
\TPPissue{\SCCSversion}  %% Mandatory field
\TPPdate{\FormatDate{$Date$%
}}
\TPPstatus{Draft}			%% Mandatory field
\TPPtype{Specification}
\TPPkeywords{HOL}
\TPPauthor{D.J.~King & WIN01}  %% Mandatory field
%\TPPauthors{Name 1&location 1\\Name 2&location 2\\Name 3&location 3}
\TPPauthorisation{R.D.~Arthan & FST Team Leader}
\TPPabstract{This document contains the implementation of
the mathematical toolkit for HOL/Z.}
%\TPPabstractB{}
%\TPPabstractC{}
%\TPPabstractD{}
%\TPPabstractE{}
%\TPPabstractF{}
\TPPdistribution{\parbox[t]{4.0in}{%
      Library}}

%\TPPclass{CLASSIFICATION}
%\def\TPPheadlhs{}
%\def\TPPheadcentre{}
%def\TPPheadrhs{}
%\def\TPPfootlhs{}
%\def\TPPfootcentre{}
%\def\TPPfootrhs{}

\begin{document}
\TPPsetsizes
\makeTPPfrontpage

\vfill
\begin{centering}

\bf Copyright \copyright\ : International Computers Ltd \number\year

\end{centering}

\newpage
\section{DOCUMENT CONTROL}
\subsection{Contents List}
\tableofcontents
\subsection{Document Cross References}
\bibliographystyle{fmu}
\bibliography{fmu}

\subsection{Changes History}  % to get section number `0.3'
\begin{description}

\item[Issue 1.1, \FormatDate{92/03/19} ] Initial Draft.


\end{description}
\subsection{Changes Forecast}
None.
\section{GENERAL}
\subsection{Scope}
This document contains the implementation
of the mathematical toolkit for HOL/Z meeting the detailed design
given in \cite{DS/FMU/IED/DTD078}.
\subsection{Introduction}
\subsection{Purpose and Background}
See \cite{DS/FMU/IED/DTD078}.
\subsection{Dependencies}
The mathematical toolkit is introduced within the structure
$ZLibrary$ which is constrained by the signature of the same name, specified
in \cite{DS/FMU/IED/DTD078}.

\subsection{Interface}
The interface for the structure is defined by the signature $ZLibrary$
(see\cite{DS/FMU/IED/DTD078}).

\subsection{Possible Enhancements}
The names of some of the global variables will change once an mechanism for
introducing Z names which do not clash with existing HOL constant
names into the theory database.
For the time being, names common to the toolkit and to HOL have here been
subscripted with $L$ (for library).

\subsection{Deficiencies}
None known.

=SML
open_theory"basic_z";
delete_theory"z_toolkit" handle Fail _ => ();
new_theory"z_toolkit";
=TEX
\section {DEFINITION OF FIXITY}

The following fixity information has been taken from \cite{Spivey89}.

¹Z
fun 1 _ í _
°

¹Z
fun 2 _ .. _
°

¹Z
fun 3 _ + _, _ - _, _ À _, _ \\ _, _ ë _, _ ‚ _
°

¹Z
fun 4 _ * _, _ div _, _ mod _, _ ¡ _, _ ù‰L _, _ »‰L _, _ o _
°
¹Z
fun 5 _ « _
°

¹Z
fun 6 _ ò _, _ ’ _, _ á _, _  _
°

¹Z
fun 7 _ ç~ê, _ ç*ê, _ ç+ê
°

¹Z
fun 7 _ ¨ _ ©
°

¹Z
rel _ ½ _, _  _, _ € _, _   _, _ < _, _ ¼ _, _ ¾ _, _ > _
°

Definition iof $in$ clashes with the $in$ keyword in HOL.
Here, it is subscripted.

¹Z
rel _ in‰L _, _ partition _, disjoint _
°

¹Z
gen 5 _ ª _, _ ß _, _ ­ _, _ ş _, _ à _, _ Ï _, _ ï _
°

¹Z
gen 5 _  _, _ Ÿ _, _  _
°

¹Z
gen 7 ğ‰1 _, id _, æ _, æ‰1 _, seq _, seq‰1 _, iseq _, bag _
°

\section{FUNCTION AND RELATION}

¹Z
X Ûªİ Y ¦ ğ (X ¸ Y)
°


¹Z
X Û­İ Y ¦ {f : X ª Y | µ x : X · ¶‰1 y : Y · (x, y)  f}
°

\section{SETS}

\subsection{Inequality and Non-membership}

[X]œœœœœœœœœœœœœœœœ
Ü _ Û½İ _ : X ª X;
Ü _ Ûİ _ : X ª ğ X
÷üüüüüüüüüüüüüüüüüü
Ü(µ x, y : X · x ½ y ¤ ³ (x = y))
Ü±
Ü(µ x : X; S : ğ X · x  S ¤ ³ (x  S))
ˆüüüüüüüüüüüüüüüüüüüü

\subsection{Empty Set}

¹Z
Ûšİ [X] ¦ {x : X | false}
°

\subsection{Subset Relation and Proper Subset Relation}

[X]œœœœœœœœœœœœœœœœ
Ü _ Û€İ _, _ Û İ _ : ğ X ª ğ X
÷üüüüüüüüüüüüüüüüüü
Üµ S, T : ğ X ·
Ü	(S € T ¤ (µ x : X · x  S ´ x  T)) ±
Ü	(S   T ¤ S € T ± S ½ T)
ˆüüüüüüüüüüüüüüüüüüüü

\subsection{Non-Empty Subsets}

¹Z
Ûğ‰1İ X ¦ {S : ğ X | S ½ š }
°

\subsection{Set Union, Intersection and Difference}

[X]œœœœœœœœœœœœœœœœ
Ü _ ÛÀİ _, _ Û¡İ _, _ Û\\İ _ : ğ X ¸ ğ X ­ ğ X
÷üüüüüüüüüüüüüüüüüü
Üµ S, T : ğ X ·
Ü	S À T = {x : X | x  S ² x  T} ±
Ü	S ¡ T = {x : X | x  S ± x  T} ±
Ü	S \\ T = {x : X | x  S ± x  T}
ˆüüüüüüüüüüüüüüüüüüüü

\subsection{Generalized Union and Intersection}


[X]œœœœœœœœœœœœœœœœ
Ü ÛŞ‰Lİ, Û¥‰Lİ  : ğ (ğ X) ­ ğ X
÷üüüüüüüüüüüüüüüüüü
Üµ A : ğ (ğ X) ·
Ü	Ş‰L A = {x : X | (¶ S : A · x  S)} ±
Ü	¥‰L A = {x : X | (µ S : A · x  S)}
ˆüüüüüüüüüüüüüüüüüüüü

\subsection{First and Second of Ordered Pairs}


[X, Y]œœœœœœœœœœœœœœœœ
Ü Ûfirstİ : X ¸ Y ­ X;
Ü Ûsecondİ : X ¸ Y ­ Y
÷üüüüüüüüüüüüüüüüüü
Ü µ x : X; y : Y ·
Ü	first (x, y) = x ±
Ü	second (x, y) = y
ˆüüüüüüüüüüüüüüüüüüüü

\section{RELATIONS}

\subsection{Maplet}

[X, Y]œœœœœœœœœœœœœœœœ
Ü _ Ûíİ _ : X ¸ Y ­ X ¸ Y
÷üüüüüüüüüüüüüüüüüü
Ü µ x : X; y : Y ·
Ü	x í y = (x, y)
ˆüüüüüüüüüüüüüüüüüüüü

\subsection{Domain and Range}

[X, Y]œœœœœœœœœœœœœœœœ
Ü Ûdomİ : (X ª Y) ­ ğ X;
Ü Ûranİ : (X ª Y) ­ ğ Y
÷üüüüüüüüüüüüüüüüüü
Ü µ R : X ª Y ·
Ü	dom R = {x : X; y : Y | (x í y)  R · x} ±
Ü	ran R = {x : X; y : Y | (x í y)  R · y}
ˆüüüüüüüüüüüüüüüüüüüü

\subsection{Identity}

¹Z
Ûidİ X ¦ {x : X · x í x}
°

\subsection{Relational and Backward Relational Composition}

[X, Y, Z]œœœœœœœœœœœœœœœœ
Ü _ Û»‰Lİ _ : (X ª Y) ¸ (Y ª Z) ­ (X ª Z);
Ü _ Ûoİ _ : (Y ª Z) ¸ (X ª Y) ­ (X ª Z)
÷üüüüüüüüüüüüüüüüüü
Ü µ R : X ª Y; S : Y ª Z ·
Ü	R »‰L S = S o R ±
Ü	S o R = {x : X; y : Y; z : Z |
Ü		(x í y)  R ± (y í z)  S · x í z}
ˆüüüüüüüüüüüüüüüüüüüü


\subsection{Domain and Range Restriction}

[X, Y]œœœœœœœœœœœœœœœœ
Ü _ Ûòİ _ : ğ X ¸ (X ª Y) ­ (X ª Y);
Ü _ Û’İ _ : (X ª Y) ¸ ğ Y ­ (X ª Y)
÷üüüüüüüüüüüüüüüüüü
Ü (µ S : ğ X; R : X ª Y ·
Ü	S ò R = {x : X; y : Y | x  S ± (x í y)  R · x í y}) ±
Ü(µ R : X ª Y; T' : ğ Y ·
Ü	R ’ T' = {x : X; y : Y | (x í y)  R ± y  T' · x í y})
ˆüüüüüüüüüüüüüüüüüüüü

\subsection{Domain and Range Anti-restriction}


[X, Y]œœœœœœœœœœœœœœœœ
Ü _ Ûáİ _ : ğ X ¸ (X ª Y) ­ (X ª Y);
Ü _ Ûİ _ : (X ª Y) ¸ ğ Y ­ (X ª Y)
÷üüüüüüüüüüüüüüüüüü
Ü (µ S : ğ X; R : X ª Y ·
Ü	S á R = {x : X; y : Y | x  S ± (x í y)  R · x í y}) ±
Ü(µ R : X ª Y; T' : ğ Y ·
Ü	R  T' = {x : X; y : Y | (x í y)  R ± y  T' · x í y})
ˆüüüüüüüüüüüüüüüüüüüü

\subsection{Relational Inversion}


[X, Y]œœœœœœœœœœœœœœœœ
Ü _ Ûç~êİ : (X ª Y) ­ (Y ª X)
÷üüüüüüüüüüüüüüüüüü
Ü µ R : X ª Y ·
Ü	R ç~ê = {x : X; y : Y | (x í y)  R · y í x}
ˆüüüüüüüüüüüüüüüüüüüü

\subsection{Relational Image}

[X, Y]œœœœœœœœœœœœœœœœ
Ü _ Û¨İ _ Û©İ : (X ª Y) ¸ ğ X ­ ğ Y
÷üüüüüüüüüüüüüüüüüü
Ü µ R : X ª Y; S : ğ X ·
Ü	R¨S© = {x : X; y : Y | x  S ± (x í y)  R · y}
ˆüüüüüüüüüüüüüüüüüüüü

\subsection{Transitive and Reflexive-Transitive Closure}

[X]œœœœœœœœœœœœœœœœ
Ü _ Ûç+êİ, _ Ûç*êİ : (X ª X) ­ (X ª X)
÷üüüüüüüüüüüüüüüüüü
Ü µ R : X ª X ·
Ü	R ç+ê = ¥‰L {Q : X ª X | R € Q ± Q »‰L Q € Q} ± 
Ü	R ç*ê = ¥‰L {Q : X ª X | id X € Q ± R € Q ± Q »‰L Q € Q}
ˆüüüüüüüüüüüüüüüüüüüü

\section{FUNCTIONS}

\subsection{Partial Functions}

¹Z
X Ûßİ Y ¦ {f : X ª Y |
	(µ x : X; y‰1, y‰2 : Y · (x í y‰1)  f ± (x í y‰2)  f ´ (y‰1 = y‰2))}
°

\subsection{Injections}

¹Z
X Ûşİ Y ¦ {f : X ß Y | (µ x‰1, x‰2 : dom f · f (x‰1) = f (x‰2) ´ x‰1 = x‰2)}
°

¹Z
X Ûàİ Y ¦ (X ş Y) ¡ (X ­ Y)
°

\subsection{Surjections}

¹Z
X ÛÏİ Y ¦ {f : X ß Y | ran f = Y}
°

¹Z
X Ûïİ Y ¦ (X Ï Y) ¡ (X ­ Y)
°

\subsection{Bijection}

¹Z
X Ûİ Y ¦ (X ï Y) ¡ (X à Y)
°

\subsection{Functional Overriding}

[X,Y]œœœœœœœœœœœœœœœœ
Ü _ Û«İ _ : (X ª Y) ¸ (X ª Y) ­ (X ª Y)
÷üüüüüüüüüüüüüüüüüü
Ü µ f, g : X ª Y ·
Ü	f « g = ((dom g) á f) À g
ˆüüüüüüüüüüüüüüüüüüüü

\section{NUMBERS AND FINITENESS}

\subsection{Natural Numbers, Integers and Basic Operators}
¹Z
[ú]
°

¹ZAX
Ü Ûîİ : ğ ú;
Ü _ Û+İ _, _ Û-İ _, _ Û*İ _ : ú ¸ ú ­ ú;
Ü _ Ûdivİ _, _ Ûmodİ _ : ú ¸ (ú \\ {0}) ­ ú;
Ü Û-‰Lİ : ú ­ ú;
Ü _ Û<İ _, _ Û¼İ _, _ Û¾İ _, _ Û>İ _ : ú ª ú
÷üüüüüüüüüüüüüüüüüü
Ü true
°

\subsection{Strictly Positive Integers and the Successor Function}

¹Z
Ûî‰1İ ¦ î \\ {0}
°

¹ZAX
Ü Ûsuccİ : î ­ î
÷üüüüüüüüüüüüüüüüüü
Ü µ n : î · succ (n) = n + 1
°

\subsection{Iteration}

[X]œœœœœœœœœœœœœœœœ
Ü Ûiterİ : ú ­ (X ª X) ­ (X ª X)
÷üüüüüüüüüüüüüüüüüü
Ü µ R : X ª X · 
Ü	iter 0 R = id X ±
Ü	(µ k : î · iter (k + 1) R = R »‰L (iter k R)) ±
Ü	(µ k : î · iter (-‰L k) R = iter k (R ç~ê))
ˆüüüüüüüüüüüüüüüüüüüü

\subsection{Number Range}

¹ZAX
Ü _ Û..İ _ : ú ¸ ú ­ ğ ú
÷üüüüüüüüüüüüüüüüüü
Ü µ a, b : ú ·
Ü	a .. b = {k : ú | a ¼ k ± k ¼ b}
°

\subsection{Finite Sets}


¹Z
æ X ¦ {S : ğ X | (¶ n:  î · ¶ f :1 .. n ­ S · ran f = S)}
°

¹Z
Ûæ‰1İ X ¦ (æ X) \\ { š }
°

[X]œœœœœœœœœœœœœœœœ
Ü Û#İ : æ X ­ î
÷üüüüüüüüüüüüüüüüüü
Ü µ S : æ X ·
Ü	# S = (Í n : î | (¶ f : 1 .. n à S · ran f = S) · n)
ˆüüüüüüüüüüüüüüüüüüüü

\subsection{Finite Partial Functions}

¹Z
X ÛŸİ Y ¦ {f : X ß Y | dom f  æ X}
°

¹Z
X Ûİ Y ¦ (X Ÿ Y) ¡ (X ş Y)
°

\subsection{Minimum and Maximum of a Set of Numbers}

¹ZAX
Ü Ûminİ : ğ‰1 ú ß ú
÷üüüüüüüüüüüüüüüüüü
Ü min = {S : ğ‰1 ú; m : ú | m  S ± (µ n : S · m ¼ n) · S í m}
° 

¹ZAX
Ü Ûmaxİ : ğ‰1 ú ß ú
÷üüüüüüüüüüüüüüüüüü
Ü max = {S : ğ‰1 ú; m : ú | m  S ± (µ n : S · m ¾ n) · S í m}
°

\section{SEQUENCES}

¹Z
Ûseqİ X ¦ {f:î Ÿ X | dom f = 1  .. # f}
°

¹Z
Ûseq‰1İ X ¦ {f:seq X | # f > 0}
°

¹Z
Ûiseqİ X ¦ (seq X) ¡ (î ş X)
°

\subsection{Concatenation}

[X]œœœœœœœœœœœœœœœœ
Ü _ Ûëİ _ : (seq X) ¸ (seq X) ­ seq X
÷üüüüüüüüüüüüüüüüüü
Ü µ s, t : seq X · s ë t = s À {n : dom t | true · n + # s í t(n)}
ˆüüüüüüüüüüüüüüüüüüüü

\subsection{Sequence Decomposition}

[X]œœœœœœœœœœœœœœœœ
Ü Ûheadİ : seq‰1 X ­ X
÷üüüüüüüüüüüüüüüüüü
Ü µ s : seq‰1 X · head s = s (1)
ˆüüüüüüüüüüüüüüüüüüüü

[X]œœœœœœœœœœœœœœœœ
Ü Ûlastİ : seq‰1 X ­ X
÷üüüüüüüüüüüüüüüüüü
Ü µ s : seq‰1 X · last s = s (# s)
ˆüüüüüüüüüüüüüüüüüüüü

[X]œœœœœœœœœœœœœœœœ
Ü Ûtailİ : seq‰1 X ­ seq X
÷üüüüüüüüüüüüüüüüüü
Ü µ s : seq‰1 X ·
Ü	tail s = (Ìn:1  .. (# s - 1) · s(n + 1))
ˆüüüüüüüüüüüüüüüüüüüü

[X]œœœœœœœœœœœœœœœœ
Ü Ûfrontİ:seq‰1 X ­ seq X
÷üüüüüüüüüüüüüüüüüü
Üµ s : seq‰1 X ·
Ü	front s = (1  .. (# s - 1)) ò s
ˆüüüüüüüüüüüüüüüüüüüü

\subsection{Reverse}

[X]œœœœœœœœœœœœœœœœ
Ü Ûrevİ : seq X ­ seq X
÷üüüüüüüüüüüüüüüüüü
Ü µ s : seq X ·
Ü	rev s = (Ìn:dom s · s(# s - n + 1))
ˆüüüüüüüüüüüüüüüüüüüü

\subsection{Filtering}

[X]œœœœœœœœœœœœœœœœ
Ü _ Ûù‰Lİ _ : (seq X) ¸ ğ X ­ seq X
÷üüüüüüüüüüüüüüüüüü
Ü µ V : ğ X ·
Ü	§ ¢ ù‰L V = § ¢ ±
Ü	(µx:X ·	(x  V ´ §x¢ ù‰L V = §x¢) ±
Ü		(x  V ´ §x¢ ù‰L V = § ¢)) ±
Ü	(µs,t:seq X ·
Ü		(s ë t) ù‰L V = (s ù‰L V) ë (t ù‰L V))
ˆüüüüüüüüüüüüüüüüüüüü

\subsection{Distributed Concatenation}

[X]œœœœœœœœœœœœœœœœ
Ü Û‹İ : seq (seq X) ­ seq X
÷üüüüüüüüüüüüüüüüüü
Ü	‹ § ¢ = § ¢ ±
Ü	(µs:seq X · ‹ §s¢ = s) ±
Ü	(µq,r:seq(seq X) ·
Ü		‹(q ë r) = (‹ q) ë (‹ r))
ˆüüüüüüüüüüüüüüüüüüüü

\subsection{Disjointness and Partitions}

[I,X]œœœœœœœœœœœœœœœœ
Ü Ûdisjointİ _ : ğ (I ß ğ X)
÷üüüüüüüüüüüüüüüüüü
Ü µ S : I ß ğ X ·
Ü	(disjoint S ¤
Ü		(µ i , j : dom S | i ½ j · S(i) ¡ S(j) = š))
ˆüüüüüüüüüüüüüüüüüüüü

[I,X]œœœœœœœœœœœœœœœœ
Ü _ Ûpartitionİ _ : (I ß ğ X) ª ğ X
÷üüüüüüüüüüüüüüüüüü
Ü µ S : I ß ğ X; T' : ğ X ·
Ü	(S partition T' ¤
Ü		disjoint S ± Ş‰L {i : dom S | true · S(i)} = T')
ˆüüüüüüüüüüüüüüüüüüüü

\section{BAGS}

\subsection{Bags, Multiplicity and Membership}

¹Z
Ûbagİ X ¦ X ß î‰1
°

[X]œœœœœœœœœœœœœœœœ
Ü Ûcountİ : bag X  (X ­ î)
÷üüüüüüüüüüüüüüüüüü
Üµ x : X; B : bag X ·
Ü	count B = (Ìx:X · 0) « B
ˆüüüüüüüüüüüüüüüüüüüü

[X]œœœœœœœœœœœœœœœœ
Ü _ Ûin‰Lİ _ : X ª bag X
÷üüüüüüüüüüüüüüüüüü
Ü µ x : X;B : bag X ·
Ü	x in‰L B ¤ x  dom B
ˆüüüüüüüüüüüüüüüüüüüü

\subsection{Bag Union}

[X]œœœœœœœœœœœœœœœœ
Ü _ Û‚İ _ : (bag X) ¸ bag X ­ bag X
÷üüüüüüüüüüüüüüüüüü
Ü µ B, C : bag X; x : X ·
Ü	count (B ‚ C) x = count B x + count C x
ˆüüüüüüüüüüüüüüüüüüüü

\subsection{Bag of Elements of a Sequence}

[X]œœœœœœœœœœœœœœœœ
Ü Ûitemsİ : seq X ­ bag X
÷üüüüüüüüüüüüüüüüüü
Ü µ s : seq X; x : X ·
Ü	count (items s) x = # {i : dom s | s (i) = x}
ˆüüüüüüüüüüüüüüüüüüüü


=IGN
\section{THEORY LISTING}
{\catcode`\_=\active
\gdef\underscoreoff{% make _ a normal char
	\catcode`\_=\active \let_=\_}}
\underscoreoff
\def\Xref#1#2{\hbox to \hsize{$#1$\leaders\hbox to1em{\hss.\hss}\hfill $#2$}}
\input{\jobname.thp}
=TEX
\twocolumn[\section{INDEX}]
\makeatletter
\printindex
\makeatother
\end{document}



