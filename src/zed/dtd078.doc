%  dtd078.doc  %Z% $Date$ $Revision$ $RCSfile$
=TEX
% TQtemplate.tex
\documentstyle[hol1,11pt,TQ]{article}
\ftlinepenalty=9999
\def\Hide#1{}
\def\Bool{``$\it{:}bool\,$''}
\makeindex
\TPPproject{FST PROJECT}  %% Mandatory field
%\TPPvolume{}
%\TPPpart{}
\TPPtitle{Detailed Design of the Z Library Set Theory}  %% Mandatory field
\TPPref{DS/FMU/IED/DTD078}  %% Mandatory field
\def\SCCSversion{$Revision$%
}
\TPPissue{\SCCSversion}  %% Mandatory field
\TPPdate{\FormatDate{$Date$%
}}
%\TPPstatus{Approved}
\TPPstatus{Draft}
\TPPtype{Specification}
\TPPkeywords{HOL}
% \TPPauthor{D.J.~King & WIN01}  %% Mandatory field
\TPPauthors{D.J.~King & WIN01&WIN01\\K.~Blackburn & WIN01}
\TPPauthorisation{R.D.~Arthan & FST Team Leader}
\TPPabstract{This document contains the detailed design of
the Z Library Set Theory and its proof support.}
%\TPPabstractB{}
%\TPPabstractC{}
%\TPPabstractD{}
%\TPPabstractE{}
%\TPPabstractF{}
\TPPdistribution{\parbox[t]{4.0in}{%
      Library}}

%\TPPclass{CLASSIFICATION}
%\def\TPPheadlhs{}
%\def\TPPheadcentre{}
%def\TPPheadrhs{}
%\def\TPPfootlhs{}
%\def\TPPfootcentre{}
%\def\TPPfootrhs{}

\begin{document}
\TPPsetsizes
\makeTPPfrontpage

\vfill
\begin{centering}

\bf Copyright \copyright\ : International Computers Ltd \number\year

\end{centering}

\newpage
\section{DOCUMENT CONTROL}
\subsection{Contents List}
\tableofcontents
\subsection{Document Cross References}
\bibliographystyle{fmu}
\bibliography{fmu}

\subsection{Changes History}  % to get section number `0.3'
\begin{description}

\item[Issue 1.4, (27th July 1992) ] Load the library in axiomatic proof mode.
\item [Issue 1.7 (12th October 1992)]
Moved $€$ definition to \cite{DS/FMU/IED/DTD052}.
\item [Issue 1.8 (19th October 1992)]
Changed parent theory.
\item [Issue 1.9 (22nd October 1992)]
Change of name and nature to Z Library Set Theory.
\end{description}
\subsection{Changes Forecast}
None.
\pagebreak
\section{GENERAL}
\subsection{Scope}
This document contains the detailed design
of the set theory material of the Z Library.
The high level design for this material is given in \cite{DS/FMU/IED/HLD017}.
\subsection{Introduction}
This document contains the detailed design
of the set theory material of the Z Library.

By default all relavent functions in this document should
be assumed to remain within the Z language and to check this fact, unless otherwise stated.
\subsection{Purpose and Background}
See \cite{DS/FMU/IED/HLD017}.
\subsection{Dependencies}

\subsection{Possible Enhancements}
None.
\subsection{Deficiencies}
None known.
\section {DEFINTIONS}
=SML
open_theory"z_language_ps";
push_pc "z_predicates";
delete_theory"z_sets" handle Fail _ => ();
val icl'was_tco_flag = get_flag "z_type_check_only";
val icl'was_ax_flag = get_flag "z_use_axioms";
set_flag ("z_type_check_only", false);
set_flag ("z_use_axioms", true);
new_theory"z_sets";
=TEX
\section {DEFINITION OF FIXITY}

The following fixity information has been taken from \cite{Spivey89}.
¹Z
fun 3 _ À _, _ \ _, _ ë _
°

¹Z
fun 4 _ ¡ _
°

¹Z
fun 7 _ º _
°

¹Z
rel _ ½ _, _  _, _   _
°
¹Z
gen 5 _ ª _, _ ­ _
°

¹Z
gen 7 ğ‰1 _
°

\section{FUNCTION AND RELATION}
These are introduced in this document to allow us to define
the types of the rest of the Z library:
by category they belong to the Z relations and functions documents
respectively.
¹Z
X Ûªİ Y ¦ ğ (X ¸ Y)
°


¹Z
X Û­İ Y ¦ {f : X ª Y | µ x : X · ¶‰1 y : Y · (x, y)  f}
°


\section{SETS}
Note that $€$ has been defined in \cite{DS/FMU/IED/DTD052}
as, though strictly part of the Z Library, it is needed to implement the representation of Z Language declarations
in that document.
\subsection{Inequality and Non-membership}

[X]œœœœœœœœœœœœœœœœ
Ü _ Û½İ _ : X ª X;
Ü _ Ûİ _ : X ª ğ X
÷üüüüüüüüüüüüüüüüüü
Ü(µ x, y : X · x ½ y ¤ ³ (x = y))
Ü±
Ü(µ x : X; S : ğ X · x  S ¤ ³ (x  S))
ˆüüüüüüüüüüüüüüüüüüüü

\subsection{Empty Set}

¹Z
Ûšİ [X] ¦ {x : X | false}
°

\subsection{Subset Relation and Proper Subset Relation}

[X]œœœœœœœœœœœœœœœœ
Ü _ Û İ _ : ğ X ª ğ X
÷üüüüüüüüüüüüüüüüüü
Üµ S, T : ğ X ·
Ü	(S   T ¤ S € T ± S ½ T)
ˆüüüüüüüüüüüüüüüüüüüü

\subsection{Non-Empty Subsets}

¹Z
Ûğ‰1İ X ¦ {S : ğ X | S ½ š }
°

\subsection{Set Union, Intersection and Difference}

[X]œœœœœœœœœœœœœœœœ
Ü _ ÛÀİ _, _ Û¡İ _, _ Û\İ _ : ğ X ¸ ğ X ­ ğ X
÷üüüüüüüüüüüüüüüüüü
Üµ S, T : ğ X ·
Ü	S À T = {x : X | x  S ² x  T} ±
Ü	S ¡ T = {x : X | x  S ± x  T} ±
Ü	S \ T = {x : X | x  S ± x  T}
ˆüüüüüüüüüüüüüüüüüüüü

\subsection{Generalized Union and Intersection}


[X]œœœœœœœœœœœœœœœœ
Ü ÛŞİ, Û¥İ  : ğ (ğ X) ­ ğ X
÷üüüüüüüüüüüüüüüüüü
Üµ A : ğ (ğ X) ·
Ü	Ş A = {x : X | (¶ S : A · x  S)} ±
Ü	¥ A = {x : X | (µ S : A · x  S)}
ˆüüüüüüüüüüüüüüüüüüüü

\subsection{First and Second of Ordered Pairs}


[X, Y]œœœœœœœœœœœœœœœœ
Ü Ûfirstİ : X ¸ Y ­ X;
Ü Ûsecondİ : X ¸ Y ­ Y
÷üüüüüüüüüüüüüüüüüü
Ü µ x : X; y : Y ·
Ü	first (x, y) = x ±
Ü	second (x, y) = y
ˆüüüüüüüüüüüüüüüüüüüü
\subsection{Type Constraints}
This is not part of the Standard Z Library
(though it is obviously definable in Z), but is introduced
to allow a concise way of introducing a Z type contraint.

[X]œœœœœœœœœœœœœœœœ
Ü Û_ º _İ : X ¸ ğ X ­ X
÷üüüüüüüüüüüüüüüüüü
Ü	(_ º _) = first
ˆüüüüüüüüüüüüüüüüüüüü

\section{START OF STRUCTURE}
=DOC
signature ÛZSetsİ = sig
=DESCRIBE
This provides the Z library sets material.
It creates the theory $z\_sets$.
=ENDDOC
=THDOC
req_name Û"z_sets"İ (Value "z_language_ps");
req_language "Z";
set_flag("tc_thms_only",true);
=DESCRIBE
The theory $z\_sets$ contains various ``defining theorems'' of Z library constants, derived from the definitions of
those constants, and consistency theorems for those
constants where necessary.
It is created in structure $ZRelations$.
=ENDDOC


\subsection{Tuple Theorems}
The following theorems are mostly just definitions
instantiated to $ñU®$ where appropriate,
perhaps with the addition of set extensionality.
=THDOC
req_thm(Û"z_first_thm"İ, ([],ñµ x: U ·
	first x = x.1®));
req_thm(Û"z_second_thm"İ, ([],ñµ x: U ·
	second x = x.2®));
=DESCRIBE
Projections from pairs.
=SEEALSO
$z\_\_first\_thm$, $z\_\_second\_thm$.
=ENDDOC
The following theorems are mostly just definitions
instantiated to $ñU®$ where appropriate,
perhaps with the addition of set extensionality.
=THDOC
req_thm(Û"z_½_thm"İ, ([],ñµ x:U; y: U· (x ½ y) ¤ ³(x = y)®));
req_thm(Û"z__thm"İ, ([],ñµ x: U; S: U·
	x  S ¤ ³(x  S)®));
=DESCRIBE
Inequality and ``non-membership''.
=ENDDOC
Spivey Ed 1. page 89.
=THDOC
req_thm(Û"z_€_thm1"İ,([],¬µ X:'a SET·
	ñ((_ € _)[X])  (_ ª _)[ğ X, ğ X] ±
	(µ S, T : ğ X
            · ((S, T)  (_ € _)[X] ¤ (µ x : X · x  S ´ x  T)))®®));
=DESCRIBE
This is the form that a definition of $€$ would have taken if
it had been introduced in the Z library.
=ENDDOC
	
=THDOC
req_thm(Û"z_š_thm"İ, ([],ñµ x‰1: U· ³(x‰1  š)®));
req_thm(Û"z_€_thm"İ, ([],ñµ s:U; t: U·
	(s € t) ¤ (µ x: U·x  s ´ x  t)®));
req_thm(Û"z__ğ_thm"İ, ([],ñµ s:U; t: U·
	(s  ğ t) ¤ (s € t)®));
req_thm(Û"z_ _thm"İ, ([],ñµ s:U; t: U·
	(s   t) ¤ (s € t) ± s ½ t®));
req_thm(Û"z_ğ‰1_thm"İ, ([],ñ(ğ‰1 _) = {S : U | S ½ š· S}®));
=DESCRIBE
Empty set, subset, proper subset and non-empty power set.
=ENDDOC
Spivey Ed 1. page 90.
=THDOC
req_thm(Û"z_À_thm"İ, ([],ñµ z: U; s:U; t: U ·
	z  (s À t) ¤ z  s ² z  t®));
req_thm(Û"z_¡_thm"İ, ([],ñµ z: U; s:U; t: U·
	z  (s ¡ t) ¤ z  s ± z  t®));
req_thm(Û"z_set_dif_thm"İ, ([],ñµ z: U; s:U; t: U·
	z  (s \ t) ¤ z  s ± (z  t)®));
=DESCRIBE
Set union, intersection and difference.
=ENDDOC
Spivey Ed 1. page 91.

=THDOC
req_thm(Û"z_Ş_thm"İ, ([],ñµ z: U; a: U·
	z  Ş a ¤ (¶ S : U · S  a ± z  S)®));
req_thm(Û"z_¥_thm"İ, ([],ñµ z: U; a: U·
	z  ¥ a ¤ (µ S : U · S  a ´ z  S)®));
=DESCRIBE
Generalised set union and intersection.
=ENDDOC
Spivey Ed 1. page 92.
=DOC
val Ûz_€_convİ : CONV;
=DESCRIBE
Use $z\_€\_thm$ in combination with
knowledge about tuples.
Given as input an equality of the form $v\ €\ w$ then:

If $w$ is of type $ty$ $SET$ where $ty$ is not a tuple type:
=FRULE 1 Conversion
z_€_conv
ñv € w®
÷
÷
ô (v € w) ¤ 
	(µ x‰n : U · x‰n  v ´ x‰n  w)
=TEX
where $x‰n$ is the first variable in the list $x‰1$, $x‰2$,...
that doesn't appear in $v$ or $w$ (free or bound).

If $w$ is of type $ty$ $SET$ where $ty$ is an n-tuple type:
=FRULE 1 Conversion
z_€_conv
ñv € w®
÷
÷
ô (v = w) ¤ (µ x‰p : U; µ x‰q : U; ... ·
	(x‰p, x‰q, ...)  v ´ 
	(x‰p, x‰q, ...)  w)
=TEX
where the $x‰i$ are the first $n$ variable names in the list
$x‰1$, $x‰2$,...
that do not appear in $v$ or $w$ (free or bound).
=SEEALSO
$z\_€\_thm$
=FAILURE
83001	?0 is not of the form ñv € w®
=ENDDOC

\section{Theorems in the Signature}
=DOC
val z_½_thm: THM;
val z__thm: THM;
val z_š_thm: THM;
val z_€_thm: THM;
val z_ _thm: THM;
val z__ğ_thm: THM;
val z_ğ‰1_thm: THM;
val z_À_thm: THM;
val z_¡_thm: THM;
val z_set_dif_thm: THM;
val z_Ş_thm: THM;
val z_¥_thm: THM;
val z_first_thm: THM;
val z_second_thm: THM;
=DESCRIBE
The ML bindings of the theorems (other than consistency ones)
in theory $z\-\_sets$.
=ENDDOC

=DOC
val Ûz'½_defİ : THM;	val Ûz'_defİ : THM;
val Ûz'š_defİ : THM;
val Ûz' _defİ : THM;	val Ûz'ğ‰1_defİ : THM;
val Ûz'À_defİ : THM;	val Ûz'¡_defİ : THM;
val Ûz'setdif_defİ : THM;	val Ûz'Ş_defİ : THM;
val Ûz'¥_defİ : THM;	val Ûz'first_defİ : THM;
val Ûz'second_defİ : THM;	val Ûz'º_defİ : THM;
val Ûz'ª_defİ : THM;	val Ûz'­_defİ : THM;
=DESCRIBE
These are the definitions of the theory $z\_sets$.
=ENDDOC
\section{PROOF CONTEXTS}
We provide the following proof contexts to reason about the above:

\begin{tabular}{l p{4in}}
$'z\_\_set\_lib$ & Simple algebraic reasoning about set theory of the Z library, especially $$. (e.g. $À$) \\
$'z\_sets\_ext\_lib$ & Extensional reasoning about set theory (e.g. $¡$) \\
\end{tabular}
=DOC
(* Proof Context: Û'z__set_libİ *)
=DESCRIBE
A component proof context for handling the membership of expressions created by Z set operations of the Z library.
\paragraph{Contents}\ 

Rewriting:
=GFT
z__ğ_thm
=TEX

Stripping theorems:
=GFT
z__ğ_thm
=TEX

Stripping conclusions:
=GFT
z__ğ_thm
=TEX
All three of the above have theorems concerning the membership of terms generated by the following operators:
=GFT
¥, Ş, ¡, À, \, ğ‰1, š
=TEX
and
=GFT
z__thm, z_½_thm
=TEX
Stripping also contains the above in negated forms.

Rewriting canonicalisation:
=GFT
=TEX

Automatic proof procedures are respectively $z\-\_basic\-\_prove\-\_tac$,
$z\-\_basic\-\_prove\-\_conv$,
and
no existence prover.
\paragraph{Usage Notes}
It requires theory $z\-\_set\-\_theory$.
It is intended to be used with proof context ``$'$z$\_$set$\_$lang''.
It is not intended to be mixed with HOL proof contexts.
=SEEALSO
$'z\_sets\_ext$
=ENDDOC
Strictly $z\_½\_thm$ is a Z library predicate operator,
rather than a set operator.

$z\_\_ğ\_thm$ is included as this seems the best non-extensional rule for $ğ$, given $€$ is available.
=DOC
(* Proof Context: Û'z_sets_ext_libİ *)
=DESCRIBE
An aggressive component proof context for handling the manipulation of Z sets by breaking them into predicate calculus, within the Z library.
\paragraph{Contents}\ 

Rewriting:
=GFT
z_€_conv, z_ _thm, z_setd_€_conv
=TEX

Stripping theorems:
=GFT
z_€_conv, z_ _thm, z_setd_€_conv,
plus these all pushed in through ³
=TEX

Stripping conclusions:
=GFT
z_€_conv, z_ _thm, z_setd_€_conv,
plus these all pushed in through ³
=TEX

Rewriting canonicalisation:
=GFT
=TEX

Automatic proof procedures are respectively $z\-\_basic\-\_prove\-\_tac$,
$z\-\_basic\-\_prove\-\_conv$,
and
no existence prover.
\paragraph{Usage Notes}
It requires theory $z\-\_set\-\_theory$.
It is intended to always be used in conjunction with ``$'$z$\_$set$\_$lib'' and ``$'$z$\_$set$\_$ext$\_$lang''.

It is not intended to be mixed with HOL proof contexts.
=SEEALSO
$'z\_\_set$
=ENDDOC


\section{EPILOGUE}
=SML
end (* end of signature ZSets *);
=TEX
=SML
set_flag ("z_type_check_only", icl'was_tco_flag);
set_flag ("z_use_axioms", icl'was_ax_flag);
=TEX

\section{TEST POLICY}
The module tests for this module are to follow the guidelines
laid down in the quality plan~\cite{DS/FMU/IED/PLN008}.

\twocolumn[\section{INDEX}]
\small
\printindex

\end{document}
